
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://prasadkothapally.github.io/wiki/print_page/">
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>Print Site - AllFunds Wiki</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6f8fc17f.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/print-site-enum-headings1.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings2.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings3.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings4.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings5.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings6.css">
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
    <script>__md_scope=new URL("/wiki/",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  
        <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function () {
            remove_material_navigation();remove_mkdocs_theme_navigation();generate_toc();
        })
        </script>
        </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="AllFunds Wiki" class="md-header__button md-logo" aria-label="AllFunds Wiki" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AllFunds Wiki
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Print Site
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/prasadkothapally/wiki.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="AllFunds Wiki" class="md-nav__button md-logo" aria-label="AllFunds Wiki" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    AllFunds Wiki
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/prasadkothapally/wiki.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Build
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Build
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Build/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Architecture
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Build/Architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Build/Architecture/Deployment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deployment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Build/Architecture/Messaging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Messaging
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Build/Architecture/Observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Observability
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Build/Architecture/Persistence/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Persistence
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Build/Architecture/Reliability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reliability
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Build/Architecture/Scalability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scalability
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Build/Architecture/Security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Build/Architecture/TechStack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stack
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Design
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Design
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Build/Design/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_2" >
        
          
          <label class="md-nav__link" for="__nav_2_3_2" id="__nav_2_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Accounting
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_2">
            <span class="md-nav__icon md-icon"></span>
            Accounting
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_3_2_1" id="__nav_2_3_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Components
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_3_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_2_1">
            <span class="md-nav__icon md-icon"></span>
            Components
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Build/Design/Accounting/Components/acc-analytics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Acc analytics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Build/Design/Accounting/Components/acc-api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Acc api
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Build/Design/Accounting/Components/acc-bo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Acc bo
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_3_2_2" id="__nav_2_3_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Dictionary
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_3_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_2_2">
            <span class="md-nav__icon md-icon"></span>
            Dictionary
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Build/Design/Accounting/Dictionary/dataFlow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Flow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Build/Design/Accounting/Dictionary/erd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Entity-Relationship Diagram
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Build/Design/Accounting/Dictionary/procedures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Procedures
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Build/Design/Accounting/Dictionary/tables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tables
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3_3" id="__nav_2_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    AllFunds
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_3">
            <span class="md-nav__icon md-icon"></span>
            AllFunds
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_3_1" >
        
          
          <label class="md-nav__link" for="__nav_2_3_3_1" id="__nav_2_3_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Components
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_3_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_3_1">
            <span class="md-nav__icon md-icon"></span>
            Components
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Build/Design/AllFunds/Components/af-eventpublisher/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Event Publisher
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Build/Design/AllFunds/Components/af-funds/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Funds Microservice
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Build/Design/AllFunds/Components/af-notifications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Notifications Microservice
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Build/Design/AllFunds/Components/af-portfolio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Portfolio Microservice
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Build/Design/AllFunds/Components/af-profile/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Profile Microservice
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Build/Design/AllFunds/Components/af-scheduler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Af scheduler
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Build/Design/AllFunds/Components/dlq-processor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DLQ Processor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Build/Design/AllFunds/Components/statemachines/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    StateMachines
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_3_2" >
        
          
          <label class="md-nav__link" for="__nav_2_3_3_2" id="__nav_2_3_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Dictionary
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_3_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_3_2">
            <span class="md-nav__icon md-icon"></span>
            Dictionary
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Build/Design/AllFunds/Dictionary/collections/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Collections
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Build/Design/AllFunds/Dictionary/tables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tables
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_4" >
        
          
          <label class="md-nav__link" for="__nav_2_3_4" id="__nav_2_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Utilities
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_4">
            <span class="md-nav__icon md-icon"></span>
            Utilities
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Build/Design/Utilities/kestra/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kestra
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Engineering
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Engineering
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Build/Engineering/Principles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Principles and Practices
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Run
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Run
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Run/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Run/Security%20%26%20Authentication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Security &amp; Authentication
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Run/build-server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Build Server
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Environments
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Environments
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4_1" >
        
          
          <label class="md-nav__link" for="__nav_3_4_1" id="__nav_3_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Development
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4_1">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Run/Environments/Development/Overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Run/Environments/Development/setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setup
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4_2" >
        
          
          <label class="md-nav__link" for="__nav_3_4_2" id="__nav_3_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Staging
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4_2">
            <span class="md-nav__icon md-icon"></span>
            Staging
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Run/Environments/Staging/Overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Run/Environments/Staging/SecretsManager%20Implementation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AWS Secrets Manager Implementation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Run/Environments/Staging/SecretsManager/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AWS Secrets Manager
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Run/Environments/Staging/setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setup
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Playground
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Playground
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../playground/Staging%20Database/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metabase
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../playground/howto-diagrams/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Playground to try out various diagrams
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#" class="md-nav__link">
    <span class="md-ellipsis">
      1. About
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-build" class="md-nav__link">
    <span class="md-ellipsis">
      I. Build
    </span>
  </a>
  
    <nav class="md-nav" aria-label="I. Build">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#build" class="md-nav__link">
    <span class="md-ellipsis">
      2. Home
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-run" class="md-nav__link">
    <span class="md-ellipsis">
      II. Run
    </span>
  </a>
  
    <nav class="md-nav" aria-label="II. Run">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#run" class="md-nav__link">
    <span class="md-ellipsis">
      3. About
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-security%20%26%20authentication" class="md-nav__link">
    <span class="md-ellipsis">
      4. Security &amp; Authentication
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-build-server" class="md-nav__link">
    <span class="md-ellipsis">
      5. Build Server
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-playground" class="md-nav__link">
    <span class="md-ellipsis">
      III. Playground
    </span>
  </a>
  
    <nav class="md-nav" aria-label="III. Playground">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playground-staging%20database" class="md-nav__link">
    <span class="md-ellipsis">
      6. Metabase
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#playground-howto-diagrams" class="md-nav__link">
    <span class="md-ellipsis">
      7. Playground to try out various diagrams
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<div id="print-site-page" class="print-site-enumerate-headings print-site-enumerate-figures">
        <section class="print-page">
            <div id="print-page-toc" data-toc-depth="3">
                <nav role='navigation' class='print-page-toc-nav'>
                <h1 class='print-page-toc-title'>Table of Contents</h1>
                </nav>
            </div>
        </section>
        <section class="print-page" id="index"><h1 id="index-about">About<a class="headerlink" href="#index-about" title="Permanent link">#</a></h1>
<p>Welcome to AllFunds technical documentation.</p></section>
                        <h1 class='nav-section-title' id='section-build'>
                            Build <a class='headerlink' href='#section-build' title='Permanent link'>â†µ</a>
                        </h1>
                        <section class="print-page" id="build"><h1 id="build-home">Home<a class="headerlink" href="#build-home" title="Permanent link">#</a></h1>
<p>Welcome to AllFunds technical documentation on topics related to Application build.</p></section>
                        <h2 class='nav-section-title' id='section-architecture'>
                            Architecture <a class='headerlink' href='#section-architecture' title='Permanent link'>â†µ</a>
                        </h2>
                        <section class="print-page" id="build-architecture"><h1 id="build-architecture-home">Home<a class="headerlink" href="#build-architecture-home" title="Permanent link">#</a></h1>
<p>The AllFunds architecture embodies the following principles.</p>
<ul>
<li>Single Responsibility Principle</li>
<li>Event Driven</li>
<li>Container first <a href="https://www.docker.com/blog/5-benefits-of-a-container-first-approach-to-software-development/">Approach</a></li>
<li>Simple and out of the box scaling. No single point of failure.</li>
<li>Simplified and predictable deployments</li>
<li>Promote Microservice adoption</li>
<li>Utilise 12-factor principles in building the application components</li>
</ul>
<p>The below diagram shows a conceptual overview of the entire application.</p>
<p><img alt="Component Architecture" src="../Build/Architecture/fintrust-allfunds-diagrams-component-arch.jpg" /></p></section><section class="print-page" id="build-architecture-deployment"><h1 id="build-architecture-deployment-deployment">Deployment<a class="headerlink" href="#build-architecture-deployment-deployment" title="Permanent link">#</a></h1>
<p>This page describes various aspects of the deployment architecture for Fintrust apps.</p>
<h2 id="build-architecture-deployment-namespaces">Namespaces<a class="headerlink" href="#build-architecture-deployment-namespaces" title="Permanent link">#</a></h2>
<p>The following namespaces are used in Kubernetes.</p>
<p><img alt="Kroki" src="https://kroki.io/plantuml/png/eNpzKC5JLCopzc3hKkhMzk5MT1VwzMlxK81LKVaoVuBSUIiGc53zcwvy81LzShT09BQMY3HLGeGR84vlquVCWJWcnF-aV5KZlw6zDCGAzTocskZ4ZVGt9E4tLilKhFoH5QQnZ6SmlOakFoFUOqTmpYCCAwCW9Vt_?"></p>
<table>
<thead>
<tr>
<th>namespace</th>
<th>purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>AllFunds</td>
<td>Used for deployment of all application components related to AllFunds</td>
</tr>
<tr>
<td>Accounting</td>
<td>Used for deployment of all application components related to Accounting</td>
</tr>
<tr>
<td>Kestra</td>
<td>Used for deployment of the Kestra scheduler components</td>
</tr>
<tr>
<td>Fintrust-Data</td>
<td>Only used on lower environments (such as local, auto, stage etc. ) Supports deployment of stateful components such as Postgres, Mongo and RabbitMQ</td>
</tr>
</tbody>
</table>
<h2 id="build-architecture-deployment-components">Components<a class="headerlink" href="#build-architecture-deployment-components" title="Permanent link">#</a></h2>
<p>The application comprises of the following components</p>
<p><img alt="Kroki" src="https://kroki.io/plantuml/png/eNptUDsOwjAM3XuKXKB3KAsLIydIXYdacu2QOEio6t1pCwJRZbPex-_ZXTafrEzcNCH5Cd2J-VxkyG52jXOgU1RBMedDG5MGYpxXfDlyYfNUmajJgjJplRU1CgTeSKXux8c6xNIz5RFTVTLwfe0GmLN-BMv3HAAtYiQ3N__bAFofqbJvJXqt4148P40gH1IumC35LeGnf2NXGHEovBffDR3KsL37BRgNgDE=?"></p>
<h2 id="build-architecture-deployment-interactions">Interactions<a class="headerlink" href="#build-architecture-deployment-interactions" title="Permanent link">#</a></h2>
<p><img alt="Kroki" src="https://kroki.io/plantuml/png/eNqdU8tqwzAQvOsr9AM91B8QkjaE0mCctO4p5CDJW9dUllw9CqXk37t-yjFJDAWDzezs7Gg9WlrHjPOlJOTdsBLo1nMwChxY-ktIxcQny4GupNx4lSFGCaVPabq7p3f0sFI_ofSoy0orUO6IlHg_Q0jeUmTcoJxG04XQXrlC5eipHR8N6qE2MTBLQQtRsHCRNDKxBesMqw2Ivt5hr-IDMi_BNO5auWfNccSpFgj0jfT4WiMNYXwy5hhnFuhOW5ebZuXYz4IVi9Ilq80eUKbUakDG7bFWuV4_dN04XWgpQbhCq4b45cEDfWGcFy7eB1qDH889JhWohFsw39D6pDf2g9tbXPM70zQ5Dr0ahH_Rp0voAtmXuoN3KZmCbTQXw-8aonIG9Z-16GhpZBSAptZclotoRMgSVFZfvj-D1iQZ?"></p></section><section class="print-page" id="build-architecture-messaging"><h1 id="build-architecture-messaging-messaging">Messaging<a class="headerlink" href="#build-architecture-messaging-messaging" title="Permanent link">#</a></h1>
<p>This page describes various aspects of the messaging architecture for Fintrust apps.</p>
<h2 id="build-architecture-messaging-retries-and-dead-letter-processing">Retries and Dead letter processing<a class="headerlink" href="#build-architecture-messaging-retries-and-dead-letter-processing" title="Permanent link">#</a></h2>
<p><img alt="Kroki" src="https://kroki.io/plantuml/png/eNp1kk0OgjAQhfecohdgQdfGsNCdC9ATQJ0ICbTan0RjvLutAjNtYNPF-2bmvU5bGtto68YhyxgTarwrCdKyyrVDbzrQBXt78NmgfI1eXGuE7tuNZsSr3YdTXWklwBilkT8cOGDHp-gaeYMiBXU4i61yvlq-qIt8BqtfP5Y2-FAokd3k-R5DeYQBA_mn8vIUL2hkOQTsiXdkwSMLTiw4WvB5Ek8sAiCX2uVzPVp7jW4cJ6XAk-hpgpMXsthiUklbVoK8hv_1BbBnu_Y=?"></p>
<ul>
<li>Publisher puts a message on an Exchange</li>
<li>Exchange routes the message to a destination queue based on bindings and routing keys</li>
<li>Subscriber listens on the queue and picks up the message for processing</li>
<li>When subcriber finishes processing the message successfully, manually ACK's so that the message is removed from the queue</li>
<li>When subscriber fails processing the message, message is not ACK'ed and after a fixed number of retries, message is moved to the retry-queue.</li>
<li>The DLQ processor listens on the RetryQueue and moves the message back to the source Queue for a Retry.</li>
<li>If the message cannot be retried after a configured number of retries, the message is moved to the DeadLetterQueue. No processing is attempted after this.</li>
</ul>
<p>This flow presented above is simplified for a high level understanding. For a deeper understanding on this topic, please see the DLQProcessor component.</p></section><section class="print-page" id="build-architecture-observability"><h1 id="build-architecture-observability-observability"><strong>Observability</strong><a class="headerlink" href="#build-architecture-observability-observability" title="Permanent link">#</a></h1>
<h2 id="build-architecture-observability-openobserve"><strong>Openobserve</strong><a class="headerlink" href="#build-architecture-observability-openobserve" title="Permanent link">#</a></h2>
<p>OpenObserve is a cloud native observability platform (Logs, Metrics, Traces) for real life log data, significantly lower operational cost and ease of use. 
It can scale to petabytes of data, is highly performant and allows you to sleep better at night ðŸ˜€. 
Check the more information at https://openobserve.ai/docs/</p>
<p>Binaries can be downloaded from releases page for appropriate platform. (https://github.com/openobserve/openobserve/releases)</p>
<h3 id="build-architecture-observability-access-the-openobserve-at-the-below-address"><strong>Access the Openobserve at the below address</strong><a class="headerlink" href="#build-architecture-observability-access-the-openobserve-at-the-below-address" title="Permanent link">#</a></h3>
<p><strong>URL</strong>: http://172.16.22.22:5080/</p>
<p><strong>User</strong>: root@example.com</p>
<p><strong>Password</strong>: Complexpass#123</p>
<h3 id="build-architecture-observability-steps-to-fetch-the-logs"><strong>Steps to fetch the logs</strong><a class="headerlink" href="#build-architecture-observability-steps-to-fetch-the-logs" title="Permanent link">#</a></h3>
<ol>
<li>Go to search and select logs in the menu</li>
<li>Select the component type ( allfunds/accounting )</li>
<li>Type  and select 'kubernetes_container_name'  in "search for a field" field</li>
<li>Select the component ( profile/portfolio/funds etc.,)</li>
<li>Select the duration for logs ( 5 mintes - n no of days )</li>
<li>Finally click the "Run Query" option and check the logs</li>
</ol></section><section class="print-page" id="build-architecture-reliability"><h1 id="build-architecture-reliability-reliability">Reliability<a class="headerlink" href="#build-architecture-reliability-reliability" title="Permanent link">#</a></h1>
<p>Almost all of the business and technical components are deployed over kubernetes.
Some of the architectural benefits we derive from using Kubernetes are</p>
<ul>
<li>Simplified scaling<ul>
<li>Scale components vertically by increasing/decreasing available Memory and CPU</li>
<li>Scale components up and down automaticaly based on load using the Horizontal Pod Autoscaler (HPA).</li>
<li>Scale compute nodes automatically using the AWS node auto-scaler using node compute thresholds. This in turn allows the HPA to make use of additional compute available</li>
</ul>
</li>
<li>Simplified deployment<ul>
<li>Automated deployments and upgrades using Helm</li>
<li>Component configuration via ConfigMaps and Secrets</li>
</ul>
</li>
<li>Simplified Reliability<ul>
<li>Automatic Recovery when components fail</li>
<li>Health-checks to prevent unhealthy components from serving requests and automatic recycling of the same.</li>
<li>Built-in load balancing and fail-over</li>
</ul>
</li>
</ul></section><section class="print-page" id="build-architecture-techstack"><h1 id="build-architecture-techstack-stack">Stack<a class="headerlink" href="#build-architecture-techstack-stack" title="Permanent link">#</a></h1>
<p>This page describes all the tools and technologies utilized for buiding the AllFunds application.</p>
<h2 id="build-architecture-techstack-engineering-stack">Engineering Stack<a class="headerlink" href="#build-architecture-techstack-engineering-stack" title="Permanent link">#</a></h2>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Technology</th>
</tr>
</thead>
<tbody>
<tr>
<td>Version Control</td>
<td>GitLab (powered by techwave's gitlab instance)</td>
</tr>
<tr>
<td>Backend CI/CD</td>
<td>GitLab</td>
</tr>
<tr>
<td>Build</td>
<td>Maven</td>
</tr>
<tr>
<td>Code Coverage</td>
<td>SonarQube</td>
</tr>
<tr>
<td>API Automation</td>
<td>Karate</td>
</tr>
<tr>
<td>Perf. Automation</td>
<td>K6</td>
</tr>
<tr>
<td>Documentation</td>
<td>MkDocs</td>
</tr>
<tr>
<td>Diagrams as code</td>
<td>Kroki, Mermaid, PlantUML</td>
</tr>
<tr>
<td>Diagrams</td>
<td>Draw.io</td>
</tr>
<tr>
<td>Docker</td>
<td>Docker Desktop (windows), Docker Engine (linux)</td>
</tr>
<tr>
<td>Kubernetes</td>
<td>Docker Desktop (windows), Minikube (linux), EKS (aws cloud)</td>
</tr>
<tr>
<td>Kubernetes tools</td>
<td>kubectl, helm, helm-dashboard</td>
</tr>
<tr>
<td>Java Artifact store</td>
<td>Reposilite</td>
</tr>
<tr>
<td>Container Registry</td>
<td>GitLab CR</td>
</tr>
<tr>
<td>Helm Package Registry</td>
<td>GitLab Package Registry</td>
</tr>
<tr>
<td>API Docs</td>
<td>Open API 3.0</td>
</tr>
</tbody>
</table>
<h2 id="build-architecture-techstack-mobile-app-engineering-stack">Mobile App Engineering Stack<a class="headerlink" href="#build-architecture-techstack-mobile-app-engineering-stack" title="Permanent link">#</a></h2>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Technology</th>
</tr>
</thead>
<tbody>
<tr>
<td>App CI/CD</td>
<td>Fastlane</td>
</tr>
<tr>
<td>App BetaStore</td>
<td>Firebase AppTester</td>
</tr>
<tr>
<td>Build</td>
<td>Gradle</td>
</tr>
</tbody>
</table>
<h2 id="build-architecture-techstack-application-backend-stack">Application Backend Stack<a class="headerlink" href="#build-architecture-techstack-application-backend-stack" title="Permanent link">#</a></h2>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Technology</th>
</tr>
</thead>
<tbody>
<tr>
<td>Deployment</td>
<td>AWS (for higher environments such as staging, perf, prod)</td>
</tr>
<tr>
<td>Deployment</td>
<td>Minikube for DEV environment (1 node - 16 core, 32 GB RAM running on Techwave servers)</td>
</tr>
<tr>
<td>Deployment</td>
<td>Docker Desktop for Local environment (4 core, 16 GB RAM running on developer machines)</td>
</tr>
<tr>
<td>Preferred Language</td>
<td>Java</td>
</tr>
<tr>
<td>Alternate Language</td>
<td>Python to support analytics use cases and Golang for performance for niche components</td>
</tr>
<tr>
<td>Document Store</td>
<td>MongoDB for Scalable read / write data store for all end user facing use cases</td>
</tr>
<tr>
<td>Relational Store</td>
<td>Postgres for OLTP data store for all transactional data and batch processing needs such as Accounting</td>
</tr>
<tr>
<td>Java frameworks</td>
<td>Quarkus + SpringBoot</td>
</tr>
<tr>
<td>Native builds</td>
<td>Quarkus + Mandrel for low resource footprint and quick startup</td>
</tr>
<tr>
<td>Authentication</td>
<td>Custom built 2FA (email/phone+password + mpin)</td>
</tr>
<tr>
<td>Authorization</td>
<td>Standard webframework supported RBAC (Quarkus / SpringBoot)</td>
</tr>
<tr>
<td>Message Broker</td>
<td>RabbitMQ</td>
</tr>
<tr>
<td>Events</td>
<td>Transactional Outbox using Mongo CDC for capturing and relaying application events</td>
</tr>
<tr>
<td>Observability</td>
<td>FluentBit + OpenObserve + AWS ContainerInsights (future)</td>
</tr>
<tr>
<td>Push Notifications</td>
<td>Google FCM</td>
</tr>
<tr>
<td>SMS Gateway</td>
<td>TextLocal</td>
</tr>
<tr>
<td>Email Gateway</td>
<td>No email gateway for now. Plain simple SMTP relay.</td>
</tr>
<tr>
<td>Secrets and Keys</td>
<td>AWS SSPM (to be implemented)</td>
</tr>
<tr>
<td>Blob store</td>
<td>AWS S3</td>
</tr>
<tr>
<td>Job Scheduling</td>
<td>Kestra (community edition)</td>
</tr>
<tr>
<td>Search</td>
<td>Embedded Lucene (since we have only 1 search use case)</td>
</tr>
<tr>
<td>API Style</td>
<td>Restful</td>
</tr>
<tr>
<td>Caching</td>
<td>In-memory and MongoDB based caching for select use cases</td>
</tr>
<tr>
<td>Sensitive(PI/PII) data</td>
<td>Currently no data is considered sensitive (for example PAN), but this needs to be relooked at.</td>
</tr>
</tbody>
</table>
<h2 id="build-architecture-techstack-mobile-application-stack">Mobile Application Stack<a class="headerlink" href="#build-architecture-techstack-mobile-application-stack" title="Permanent link">#</a></h2>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Technology</th>
</tr>
</thead>
<tbody>
<tr>
<td>Language/Framework</td>
<td>React Native</td>
</tr>
</tbody>
</table>
<h2 id="build-architecture-techstack-web-application-stack">Web Application Stack<a class="headerlink" href="#build-architecture-techstack-web-application-stack" title="Permanent link">#</a></h2>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Technology</th>
</tr>
</thead>
<tbody>
<tr>
<td>Language/Framework</td>
<td>ReactJS</td>
</tr>
</tbody>
</table>
<h2 id="build-architecture-techstack-cloud-specifics">Cloud specifics<a class="headerlink" href="#build-architecture-techstack-cloud-specifics" title="Permanent link">#</a></h2>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Technology</th>
</tr>
</thead>
<tbody>
<tr>
<td>Network security</td>
<td>Everything in private subnets + SSH Access from Bastion + Bastion whitelisting to Techwave IPs + Individual SSH crdentials</td>
</tr>
<tr>
<td>Infrastructure as Code</td>
<td>OpenTofu (Terraform fork)</td>
</tr>
<tr>
<td>AWS console access</td>
<td>Restricted to authorized personnel</td>
</tr>
</tbody>
</table>
<h2 id="build-architecture-techstack-web-site-stack">Web Site Stack<a class="headerlink" href="#build-architecture-techstack-web-site-stack" title="Permanent link">#</a></h2>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Technology</th>
</tr>
</thead>
<tbody>
<tr>
<td>Headless CMS</td>
<td>Strapi</td>
</tr>
<tr>
<td>Site</td>
<td>Gatsby generated static site (because site contains only a handful of pages)</td>
</tr>
</tbody>
</table></section><h1 class='nav-section-title-end'>Ended: Architecture</h1>
                        <h2 class='nav-section-title' id='section-design'>
                            Design <a class='headerlink' href='#section-design' title='Permanent link'>â†µ</a>
                        </h2>
                        <section class="print-page" id="build-design"><h1 id="build-design-home">Home<a class="headerlink" href="#build-design-home" title="Permanent link">#</a></h1>
<p>This is the root of the page-tree for all design documentation related to Fintrust</p>
<h2 id="build-design-available-components">Available components<a class="headerlink" href="#build-design-available-components" title="Permanent link">#</a></h2>
<p><img alt="Kroki" src="https://kroki.io/plantuml/png/eNpFkEtuwzAMRPc-hZapTxGnbYKiH7tocwBapmsiEilItIHevrIUoDuSM5iH4TEpRPXEk4fQpBtxgAjeeGGxSxSPRuOKTWsexQdhZE1N25rOufPK0z63Zogyk8M6S9RZHEnZ_j0fojSTBSXhknBxMoIr2vv5ar4wpSztWRtNGAvEWllZiX-KrRtezAECPZTtBPbWzzkSzWGUeusY3K-SLYBvtAtnYmU8vX3u2TZjJJbL85bLmGEdHaWlAq9KjpTwXutyyniL1d4H5H5MGLda9BWTRmiOmF93f98fBANpNQ==?"></p>
<h3 id="build-design-purpose">Purpose<a class="headerlink" href="#build-design-purpose" title="Permanent link">#</a></h3>
<p>The purpose of the components is as follows</p>
<table>
<thead>
<tr>
<th>Component</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>Profile</td>
<td>Handles all aspects of a user in the AllFunds system</td>
</tr>
<tr>
<td>Portfolio</td>
<td>Handles all aspects of a user's financial investments in the AllFunds system</td>
</tr>
<tr>
<td>Funds</td>
<td>Handles all aspects of a Fund, it's proerties and performance</td>
</tr>
<tr>
<td>Notifications</td>
<td>Handles all aspects of communication with the end users across various channels.</td>
</tr>
<tr>
<td>MFU Session Provider</td>
<td>A lightweight service for initialiazing and sharing a MFU session with various other components.</td>
</tr>
<tr>
<td>Accounting API</td>
<td>Accounting system interface</td>
</tr>
<tr>
<td>Accounting BackOffice</td>
<td>Accounting system backoffice that heavy-lifts all the backoffie processing for data loads, fund analytics, reconciliations, investor analytics etc.</td>
</tr>
<tr>
<td>Accounting Analytics</td>
<td>Recolytics layer. Yet to be built.</td>
</tr>
<tr>
<td>DLQ Processor</td>
<td>Handles message retries using backoffs across the system.</td>
</tr>
<tr>
<td>Event Publisher</td>
<td>Traps the Mongo CDC streams and publishes the changes as Business events</td>
</tr>
<tr>
<td>PGBouncer</td>
<td>A postgres connection pooler</td>
</tr>
<tr>
<td>OpenObserve</td>
<td>Log aggregations and visualizations</td>
</tr>
<tr>
<td>Kestra</td>
<td>A task scheduler.</td>
</tr>
</tbody>
</table>
<h2 id="build-design-api-reference">API Reference<a class="headerlink" href="#build-design-api-reference" title="Permanent link">#</a></h2>
<p>Please see this <a href="https://fintrust-dev.techwave.net/swagger-ui">The API documentation</a> for all exposed REST APIs</p>
<h2 id="build-design-principles">Principles<a class="headerlink" href="#build-design-principles" title="Permanent link">#</a></h2>
<h3 id="build-design-scm">SCM<a class="headerlink" href="#build-design-scm" title="Permanent link">#</a></h3>
<ol>
<li>Every component has its own git project. Using a single git project and nested folders to manage resources of various kind is discouraged.</li>
<li>Every git project results in an artifact. It maybe an executable, or a docker container or a Java archive or a Helm chart.</li>
<li>Main is the default branch and is left unprotected for all devs to be able to commit.</li>
<li>Trunk based development is followed. Main is the only branch. Devs can use other branches to build their features but this is not mandatory. Only the main branch is connected to the pipelines. This approach may change post go-live.</li>
</ol>
<h3 id="build-design-ci">CI<a class="headerlink" href="#build-design-ci" title="Permanent link">#</a></h3>
<ol>
<li>Every git project has a build pipeline connected to it. </li>
<li>The build pipeline is setup using gitlab CI.</li>
<li>Docker artifacts are stored in GitLab Container Registry</li>
<li>Helm artifacts are stored in GitLab Package Registry</li>
<li>Java artifacts (jars) are stored in Reposilite</li>
</ol>
<h3 id="build-design-versioning">Versioning<a class="headerlink" href="#build-design-versioning" title="Permanent link">#</a></h3>
<ol>
<li>All components are versioned as 0.{SprintNumber}.{FixNumber} at the start of the sprint. These changes are made in the individual build and pipeline manifests (pom.xml and .gitlab-ci.yaml for example).</li>
<li>The Helm chart's app version is adjusted to 0.{SprintNumber}.{FixNumber}</li>
<li>The images referenced in the Helm chart are modified to use the 0.{SprintNumber}.{FixNumber} of each component.</li>
</ol></section>
                        <h3 class='nav-section-title' id='section-accounting'>
                            Accounting <a class='headerlink' href='#section-accounting' title='Permanent link'>â†µ</a>
                        </h3>
                        
                        <h4 class='nav-section-title' id='section-components'>
                            Components <a class='headerlink' href='#section-components' title='Permanent link'>â†µ</a>
                        </h4>
                        <h1 class='nav-section-title-end'>Ended: Components</h1>
                        <h4 class='nav-section-title' id='section-dictionary'>
                            Dictionary <a class='headerlink' href='#section-dictionary' title='Permanent link'>â†µ</a>
                        </h4>
                        <section class="print-page" id="build-design-accounting-dictionary-dataflow"><h1 id="build-design-accounting-dictionary-dataflow-data-flow">Data Flow<a class="headerlink" href="#build-design-accounting-dictionary-dataflow-data-flow" title="Permanent link">#</a></h1>
<h4 id="build-design-accounting-dictionary-dataflow-1-data-setup-from-amfiindia">1. Data setup from Amfiindia:<a class="headerlink" href="#build-design-accounting-dictionary-dataflow-1-data-setup-from-amfiindia" title="Permanent link">#</a></h4>
<p><div class="highlight"><pre><span></span><code>NAV data of the funds gets loaded from amfiindia website into below tables.
a. net_asset_value (row-wise)
b. scheme_navs (columnar)
</code></pre></div>
[<img alt="Amfiindia Data setup" src="../Build/Design/Accounting/Dictionary/Images/amfiindiaData.png" />]</p>
<h4 id="build-design-accounting-dictionary-dataflow-2-data-setup-from-morningstar">2. Data setup from Morningstar<a class="headerlink" href="#build-design-accounting-dictionary-dataflow-2-data-setup-from-morningstar" title="Permanent link">#</a></h4>
<p><div class="highlight"><pre><span></span><code>Below data gets loaded from Morningstar through FTP site.
a. schemes data
b. benchmark Nav data
c. Daily returns of funds, benchmarks and categories
d. Monthly returns of funds, benchmarks and categories
</code></pre></div>
<img alt="Morningstar Data flow" src="../Build/Design/Accounting/Dictionary/Images/MorningstarData.png" /></p>
<h4 id="build-design-accounting-dictionary-dataflow-3-data-setup-from-rta-source">3. Data setup from RTA source<a class="headerlink" href="#build-design-accounting-dictionary-dataflow-3-data-setup-from-rta-source" title="Permanent link">#</a></h4>
<p><div class="highlight"><pre><span></span><code>Loads below data from RTA source (Cams and Karvy)
a. schemes data 
b. User Transactions data 
</code></pre></div>
<img alt="RTA Data flow" src="../Build/Design/Accounting/Dictionary/Images/RTAData.png" /></p>
<h4 id="build-design-accounting-dictionary-dataflow-4-accounting-data-flow-on-rta-transactions">4. Accounting data flow on RTA transactions<a class="headerlink" href="#build-design-accounting-dictionary-dataflow-4-accounting-data-flow-on-rta-transactions" title="Permanent link">#</a></h4>
<p><div class="highlight"><pre><span></span><code>Performs accounting on top of the user transactions everyday and loads below data
a. Accounting
b. Performance Metrics 
</code></pre></div>
<img alt="Accounting Data flow" src="../Build/Design/Accounting/Dictionary/Images/AccountingData.png" title="Accounting Data flow" /></p>
<h4 id="build-design-accounting-dictionary-dataflow-5-internal-analytics">5. Internal Analytics<a class="headerlink" href="#build-design-accounting-dictionary-dataflow-5-internal-analytics" title="Permanent link">#</a></h4>
<p><div class="highlight"><pre><span></span><code>Below data is being calculated at recolytics end
a. p2p, CY and SIP returns of funds, benchmarks and categories
b. Month end Nav returns of funds, benchmarks and categories
c.Various returns of the funds, benchmarks and categories (python code)
</code></pre></div>
<img alt="Analytics" src="../Build/Design/Accounting/Dictionary/Images/InternalAnalytics.png" /></p>
<h4 id="build-design-accounting-dictionary-dataflow-6-data-consolidation-flow">6. Data consolidation flow<a class="headerlink" href="#build-design-accounting-dictionary-dataflow-6-data-consolidation-flow" title="Permanent link">#</a></h4>
<p><div class="highlight"><pre><span></span><code>Generates below consolidated data from the available returns data
a. fund, categorya and benchmark facts: consolidated data of all the returns
b. fund attributes: consolidated view of the fund details
</code></pre></div>
<img alt="Data consolidation" src="../Build/Design/Accounting/Dictionary/Images/DataConsolidation.png" /></p>
<h4 id="build-design-accounting-dictionary-dataflow-7-overall-recolytics-data-flow">7. Overall Recolytics Data flow<a class="headerlink" href="#build-design-accounting-dictionary-dataflow-7-overall-recolytics-data-flow" title="Permanent link">#</a></h4>
<p><div class="highlight"><pre><span></span><code>This flow descibes the overall data flow in the recolytics layer
</code></pre></div>
<img alt="Recolytics Data flow" src="../Build/Design/Accounting/Dictionary/Images/RecolyticsDataFlow.png" /></p></section><section class="print-page" id="build-design-accounting-dictionary-erd"><h1 id="build-design-accounting-dictionary-erd-entity-relationship-diagram">Entity-Relationship Diagram<a class="headerlink" href="#build-design-accounting-dictionary-erd-entity-relationship-diagram" title="Permanent link">#</a></h1>
<p><img alt="Kroki" src="https://kroki.io/erd/png/eNq1VsGO2yAQvfsrRsmlTWLJ2-Pe99pDr1FlYTN2UDFYQBJ5V_vvC9hbY8eJkbpNLmF4vHm8gSGGGY7wxkmB_Bk2ouK0gBdhmOnSX8iJYVLoE2uBMlIr0sC3UgqKQiP9vjmAZq9ol_3INu9JsoWfrEQoJZdKQ6VkAy_qyl6f7YxCCtuqRPu1o4KfEbZuULlhrRAFbGmGGc3suEPO5dXii6qghQ1IRUTtViBmJHOZvESGOkmOLScdqt_wVtQ-tdUzUFlRALt-Pmd03OaFqPJE1AGENCDOnHtkZX_kgjS4BPwEGbQmrBC1UjNn3IgbNNiJGVQbYs76BtiHJ9jk6FLf36abjdhkaSu7hrnnQSimtpipmL6cvZhaMz0R4-CM3m5emdywMNvZlC4wQ14R_wQY3RDOmTBzPiRairxDoqLBpmuD7EOwPRE9l1AxwfQJgz0VUnIkYoY7yQbzmFPigbqUCtfFkivpokg9MIo0OVLFLg9quI8r4s7TTHB3Lff1rhjyAOyHw814dDBc8nzhaKCgMZQOFkdo1-WRt3zG6CItKibpYXTZ3eh_N3kf77JveFHIr_WjI4raJPi4DlReg74YCAtpbEKZ1_IBrvc1X-r9_9vefbS_PTTq7Vk3ODk2aMh0q_2D6gkuqPTkyVmwNqblRffS9dY86N5C-EfCvti9KeA_uzR98ptPXGEAZtGR2HVLy7aCcu3Ponw15yifFxajwzkKopNET2m6A895G3Yrl6MDaTJRM65ZjP5dE2pdnv108Gb2A6Q5POw=?"></p></section><section class="print-page" id="build-design-accounting-dictionary-procedures"><h1 id="build-design-accounting-dictionary-procedures-procedures">Procedures<a class="headerlink" href="#build-design-accounting-dictionary-procedures-procedures" title="Permanent link">#</a></h1>
<h2 id="build-design-accounting-dictionary-procedures-list">list<a class="headerlink" href="#build-design-accounting-dictionary-procedures-list" title="Permanent link">#</a></h2>
<table>
<thead>
<tr>
<th>Procedure Name</th>
</tr>
</thead>
<tbody>
<tr>
<td>calculate_crisil_navs_from_returns</td>
</tr>
<tr>
<td>calculate_sip_returns</td>
</tr>
<tr>
<td>load_benchmark_cy_returns</td>
</tr>
<tr>
<td>load_benchmark_month_end_nav</td>
</tr>
<tr>
<td>load_benchmark_p2p_returns</td>
</tr>
<tr>
<td>load_cams_schemes</td>
</tr>
<tr>
<td>load_cams_transactions</td>
</tr>
<tr>
<td>load_category_avg_cy_returns</td>
</tr>
<tr>
<td>load_category_avg_daily_navs</td>
</tr>
<tr>
<td>load_category_avg_p2p_returns</td>
</tr>
<tr>
<td>load_fake_mfu_transactions</td>
</tr>
<tr>
<td>load_fund_cy_returns</td>
</tr>
<tr>
<td>load_fund_p2p_returns</td>
</tr>
<tr>
<td>load_karvy_schemes</td>
</tr>
<tr>
<td>load_karvy_transactions</td>
</tr>
<tr>
<td>load_month_end_ctg_avg</td>
</tr>
<tr>
<td>load_month_end_navs_returns</td>
</tr>
<tr>
<td>load_monthly_returns</td>
</tr>
<tr>
<td>load_scheme_month_end_nav</td>
</tr>
<tr>
<td>merge_cams_karvy_schemes</td>
</tr>
<tr>
<td>merge_cams_karvy_transactions</td>
</tr>
<tr>
<td>nav_calculation</td>
</tr>
<tr>
<td>perform_accounting</td>
</tr>
<tr>
<td>update_isin_in_funds_category</td>
</tr>
<tr>
<td>update_scheme_lt_with_priority</td>
</tr>
<tr>
<td>update_scheme_name_in_category</td>
</tr>
</tbody>
</table></section><section class="print-page" id="build-design-accounting-dictionary-tables"><h1 id="build-design-accounting-dictionary-tables-tables">Tables<a class="headerlink" href="#build-design-accounting-dictionary-tables-tables" title="Permanent link">#</a></h1>
<h2 id="build-design-accounting-dictionary-tables-list">list<a class="headerlink" href="#build-design-accounting-dictionary-tables-list" title="Permanent link">#</a></h2>
<table>
<thead>
<tr>
<th>Table Name</th>
<th>Source</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>scheme_lt</td>
<td>Morningstar</td>
<td>Lookup table for the isins/funds. Contains benchmark, category and fund details of the funds.</td>
</tr>
<tr>
<td>stg_cams_schemes</td>
<td>RTA</td>
<td>Direct data dump of Cams schemes without validations</td>
</tr>
<tr>
<td>stg_karvy_schemes</td>
<td>RTA</td>
<td>Direct data dump of Karvy schemes without validations</td>
</tr>
<tr>
<td>stg_cams_transactions</td>
<td>RTA</td>
<td>Direct data dump of Cams transactions without validations</td>
</tr>
<tr>
<td>stg_karvy_transactions</td>
<td>RTA</td>
<td>Direct data dump of Karvy transactions without validations</td>
</tr>
<tr>
<td>cams_schemes</td>
<td>RTA</td>
<td>Validated Cams schemes</td>
</tr>
<tr>
<td>karvy_schemes</td>
<td>RTA</td>
<td>Validated Karvy schemes</td>
</tr>
<tr>
<td>cams_transactions</td>
<td>RTA</td>
<td>Validated Cams transactions</td>
</tr>
<tr>
<td>karvy_transactions</td>
<td>RTA</td>
<td>Validated Karvy transactions</td>
</tr>
<tr>
<td>schemes</td>
<td>RTA</td>
<td>Combined data of Cams and Karvy schemes</td>
</tr>
<tr>
<td>transactions</td>
<td>RTA</td>
<td>Combined data of Cams and Karvy transactions</td>
</tr>
<tr>
<td>import_errors</td>
<td>Internal</td>
<td>To track any errors in the data</td>
</tr>
<tr>
<td>accounting</td>
<td>Internal</td>
<td>Accounting data performed on top of RTA transactions</td>
</tr>
<tr>
<td>scheme_lt_amfi</td>
<td>Amfiindia</td>
<td>Lookup table for the funds from amfiindia</td>
</tr>
<tr>
<td>scheme_navs</td>
<td>Amfiindia</td>
<td>Scheme Navs data in columnar format</td>
</tr>
<tr>
<td>net_asset_value</td>
<td>Amfiindia</td>
<td>Scheme Navs data in row format</td>
</tr>
<tr>
<td>benchmark_lt</td>
<td>Morningstar</td>
<td>Lookup table for benchmark data</td>
</tr>
<tr>
<td>benchmark_nav</td>
<td>Morningstar</td>
<td>Benchmark Navs data</td>
</tr>
<tr>
<td>performance_metrics</td>
<td>Internal</td>
<td>Contains returns calculated on top of accouting data for pan-folio-isin level</td>
</tr>
<tr>
<td>benchmark_analytics</td>
<td>Prashanta Das (Python Code)</td>
<td>Monthly analytics of benchmark</td>
</tr>
<tr>
<td>category_analytics</td>
<td>Prashanta Das (Python Code)</td>
<td>Monthly anlytics of category</td>
</tr>
<tr>
<td>fund_analytics</td>
<td>Prashanta Das (Python Code)</td>
<td>Monthly analytics of fund</td>
</tr>
<tr>
<td>fund_facts_daily_return</td>
<td>Morningstar</td>
<td>Daily returns of funds</td>
</tr>
<tr>
<td>fund_facts_monthly_return</td>
<td>Morningstar</td>
<td>Monthly returns of funds</td>
</tr>
<tr>
<td>category_average_daily_return</td>
<td>Morningstar</td>
<td>Daily returns of category averages</td>
</tr>
<tr>
<td>category_average_monthly_return</td>
<td>Morningstar</td>
<td>Monthly returns of category averages</td>
</tr>
<tr>
<td>benchmark_daily_return</td>
<td>Morningstar</td>
<td>Daily returns of benchmark data</td>
</tr>
<tr>
<td>benchmark_monthly_return</td>
<td>Morningstar</td>
<td>Monthly returns of benchmark data</td>
</tr>
<tr>
<td>benchmark_facts</td>
<td>Morningstar</td>
<td>Combined data of daily and monthyly returns of benchmark</td>
</tr>
<tr>
<td>category_facts</td>
<td>Morningstar</td>
<td>Combined data of daily and monthly returns of category averages</td>
</tr>
<tr>
<td>fund_facts</td>
<td>Morningstar</td>
<td>Combined data of daily and monthly returns of funds</td>
</tr>
<tr>
<td>benchmark_p2p_returns</td>
<td>Internal</td>
<td>p2p returns of benchmark</td>
</tr>
<tr>
<td>benchmark_cy_returns</td>
<td>Internal</td>
<td>cy returns of benchmark</td>
</tr>
<tr>
<td>benchmark_sip_returns</td>
<td>Internal</td>
<td>SIP returns of benchmark</td>
</tr>
<tr>
<td>category_avg_p2p_returns</td>
<td>Internal</td>
<td>p2p returns of category averages</td>
</tr>
<tr>
<td>category_avg_cy_returns</td>
<td>Internal</td>
<td>cy returns of category averages</td>
</tr>
<tr>
<td>category_avg_sip_returns</td>
<td>Internal</td>
<td>SIP returns of category averages</td>
</tr>
<tr>
<td>fund_p2p_returns</td>
<td>Internal</td>
<td>p2p returns of funds</td>
</tr>
<tr>
<td>fund_cy_returns</td>
<td>Internal</td>
<td>cy returns of funds</td>
</tr>
<tr>
<td>fund_sip_returns</td>
<td>Internal</td>
<td>SIP returns of funds</td>
</tr>
<tr>
<td>fund_attributes</td>
<td>RTA and Morningstar</td>
<td>Fund level details required for UI team</td>
</tr>
<tr>
<td>category_avg_daily_navs</td>
<td>Internal</td>
<td>Category averages daily wise</td>
</tr>
<tr>
<td>category_avg_month_end_navs</td>
<td>Internal</td>
<td>Category averages monthly wise</td>
</tr>
<tr>
<td>benchmark_month_end_nav</td>
<td>Internal</td>
<td>Benchmark month end navs - loaded once in month</td>
</tr>
<tr>
<td>category_avg_month_end_navs_returns</td>
<td>Internal</td>
<td></td>
</tr>
<tr>
<td>benchmark_monthly_returns</td>
<td>Internal</td>
<td></td>
</tr>
<tr>
<td>scheme_month_end_nav</td>
<td>Internal</td>
<td></td>
</tr>
<tr>
<td>scheme_monthly_returns</td>
<td>Internal</td>
<td></td>
</tr>
<tr>
<td>category_lt</td>
<td>Morningstar</td>
<td>Lookup table for categories</td>
</tr>
</tbody>
</table>
<p>Click <a href="https://techwaveinc.sharepoint.com/:x:/r/sites/TW-VPLCoE-CoreTeam/_layouts/15/Doc.aspx?sourcedoc=%7B0876879C-959B-4C74-BB1D-36B29EFCBFB9%7D&amp;file=TablesList.xlsx&amp;action=default&amp;mobileredirect=true">here</a> for the description of the tables.</p></section><h1 class='nav-section-title-end'>Ended: Dictionary</h1><h1 class='nav-section-title-end'>Ended: Accounting</h1>
                        <h3 class='nav-section-title' id='section-allfunds'>
                            AllFunds <a class='headerlink' href='#section-allfunds' title='Permanent link'>â†µ</a>
                        </h3>
                        
                        <h4 class='nav-section-title' id='section-components'>
                            Components <a class='headerlink' href='#section-components' title='Permanent link'>â†µ</a>
                        </h4>
                        <section class="print-page" id="build-design-allfunds-components-af-eventpublisher"><h1 id="build-design-allfunds-components-af-eventpublisher-event-publisher">Event Publisher<a class="headerlink" href="#build-design-allfunds-components-af-eventpublisher-event-publisher" title="Permanent link">#</a></h1>
<p><span dir="">An af-event-publisher component will monitor the verification collection in the af-profile service. If there is any data inserted in that verification collection, AF-Event-Publisher will consume the data and publish the message to RabbitMQ based on the routing key by adding a resume token in the payload.
  </span></p>
<h1 id="build-design-allfunds-components-af-eventpublisher-interface">Interface<a class="headerlink" href="#build-design-allfunds-components-af-eventpublisher-interface" title="Permanent link">#</a></h1>
<h2 id="build-design-allfunds-components-af-eventpublisher-messaging">Messaging<a class="headerlink" href="#build-design-allfunds-components-af-eventpublisher-messaging" title="Permanent link">#</a></h2>
<h3 id="build-design-allfunds-components-af-eventpublisher-exchanges">Exchanges<a class="headerlink" href="#build-design-allfunds-components-af-eventpublisher-exchanges" title="Permanent link">#</a></h3>
<h4 id="build-design-allfunds-components-af-eventpublisher-notification-exchanges">Notification Exchanges<a class="headerlink" href="#build-design-allfunds-components-af-eventpublisher-notification-exchanges" title="Permanent link">#</a></h4>
<table>
<thead>
<tr>
<th>Exchange</th>
<th>Routing Key</th>
<th>Headers</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>notification-exchange</td>
<td>rk.email.otp</td>
<td>content_type=application/json</td>
<td></td>
</tr>
<tr>
<td>notification-exchange</td>
<td>rk.mobile.otp</td>
<td>content_type=application/json</td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="build-design-allfunds-components-af-eventpublisher-diagrams">Diagrams<a class="headerlink" href="#build-design-allfunds-components-af-eventpublisher-diagrams" title="Permanent link">#</a></h1>
<p>Data flow diagram</p>
<h2 id="build-design-allfunds-components-af-eventpublisher-example-diagram">Example diagram<a class="headerlink" href="#build-design-allfunds-components-af-eventpublisher-example-diagram" title="Permanent link">#</a></h2>
<div class="highlight"><pre><span></span><code>flowchart TD
</code></pre></div>
<h3 id="build-design-allfunds-components-af-eventpublisher-dictionary">Dictionary<a class="headerlink" href="#build-design-allfunds-components-af-eventpublisher-dictionary" title="Permanent link">#</a></h3>
<h4 id="build-design-allfunds-components-af-eventpublisher-tables">Tables<a class="headerlink" href="#build-design-allfunds-components-af-eventpublisher-tables" title="Permanent link">#</a></h4>
<h1 id="build-design-allfunds-components-af-eventpublisher-build">Build<a class="headerlink" href="#build-design-allfunds-components-af-eventpublisher-build" title="Permanent link">#</a></h1>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Artifacts</td>
<td></td>
</tr>
<tr>
<td>Location</td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="build-design-allfunds-components-af-eventpublisher-deployment">Deployment<a class="headerlink" href="#build-design-allfunds-components-af-eventpublisher-deployment" title="Permanent link">#</a></h1>
<h1 id="build-design-allfunds-components-af-eventpublisher-security">Security<a class="headerlink" href="#build-design-allfunds-components-af-eventpublisher-security" title="Permanent link">#</a></h1>
<h1 id="build-design-allfunds-components-af-eventpublisher-scalability">Scalability<a class="headerlink" href="#build-design-allfunds-components-af-eventpublisher-scalability" title="Permanent link">#</a></h1>
<h1 id="build-design-allfunds-components-af-eventpublisher-resilience">Resilience<a class="headerlink" href="#build-design-allfunds-components-af-eventpublisher-resilience" title="Permanent link">#</a></h1></section><section class="print-page" id="build-design-allfunds-components-af-funds"><h1 id="build-design-allfunds-components-af-funds-funds-microservice">Funds Microservice<a class="headerlink" href="#build-design-allfunds-components-af-funds-funds-microservice" title="Permanent link">#</a></h1>
<p><span dir="">Funds component is responsible to upload funds details. Once funds will be uploaded and will be validated. Then these funds will be stored into Database once validation will be done.</span>\
We can search funds by passing either fully match or partial match of text. \
\
<strong>Upload:</strong> This api can be used to upload excel containing funds details.\
\
<strong>Search:</strong> This api is used to search fund name by passing partial text or exact match fund name.\
\
<strong>Filter:</strong> This api is used to filter funds by passing Asset class type and Consistency factory.\
\
<strong>Facts by ISIN:</strong> This api is used to filter facts by isin.</p>
<h1 id="build-design-allfunds-components-af-funds-interface-upload">Interface upload<a class="headerlink" href="#build-design-allfunds-components-af-funds-interface-upload" title="Permanent link">#</a></h1>
<h2 id="build-design-allfunds-components-af-funds-api-apirestfundsupload">api : /api/rest/funds/upload<a class="headerlink" href="#build-design-allfunds-components-af-funds-api-apirestfundsupload" title="Permanent link">#</a></h2>
<h2 id="build-design-allfunds-components-af-funds-request-and-response-of-upload-funds">Request and Response of Upload funds<a class="headerlink" href="#build-design-allfunds-components-af-funds-request-and-response-of-upload-funds" title="Permanent link">#</a></h2>
<h3 id="build-design-allfunds-components-af-funds-request">Request<a class="headerlink" href="#build-design-allfunds-components-af-funds-request" title="Permanent link">#</a></h3>
<h4 id="build-design-allfunds-components-af-funds-request-body">Request Body<a class="headerlink" href="#build-design-allfunds-components-af-funds-request-body" title="Permanent link">#</a></h4>
<p><span dir="">We can upload excel file as funds details</span>.</p>
<table>
<thead>
<tr>
<th>Content Type</th>
<th>Body</th>
<th>key</th>
<th>value</th>
</tr>
</thead>
<tbody>
<tr>
<td>multipart/form-data</td>
<td>Excel file</td>
<td>file</td>
<td>excel file</td>
</tr>
</tbody>
</table>
<h3 id="build-design-allfunds-components-af-funds-response">Response<a class="headerlink" href="#build-design-allfunds-components-af-funds-response" title="Permanent link">#</a></h3>
<h4 id="build-design-allfunds-components-af-funds-response-body">Response Body<a class="headerlink" href="#build-design-allfunds-components-af-funds-response-body" title="Permanent link">#</a></h4>
<table>
<thead>
<tr>
<th>body</th>
<th>Headers</th>
</tr>
</thead>
<tbody>
<tr>
<td>JSON</td>
<td>accept=application/json</td>
</tr>
</tbody>
</table>
<h1 id="build-design-allfunds-components-af-funds-interface-search">Interface search<a class="headerlink" href="#build-design-allfunds-components-af-funds-interface-search" title="Permanent link">#</a></h1>
<h2 id="build-design-allfunds-components-af-funds-api-apifundssearch">api : /api/funds/search<a class="headerlink" href="#build-design-allfunds-components-af-funds-api-apifundssearch" title="Permanent link">#</a></h2>
<h2 id="build-design-allfunds-components-af-funds-request-and-response-of-search">Request and Response of search<a class="headerlink" href="#build-design-allfunds-components-af-funds-request-and-response-of-search" title="Permanent link">#</a></h2>
<h3 id="build-design-allfunds-components-af-funds-request_1">Request<a class="headerlink" href="#build-design-allfunds-components-af-funds-request_1" title="Permanent link">#</a></h3>
<h4 id="build-design-allfunds-components-af-funds-request-body_1">Request Body<a class="headerlink" href="#build-design-allfunds-components-af-funds-request-body_1" title="Permanent link">#</a></h4>
<p><span dir="">We can search fund by request param</span></p>
<table>
<thead>
<tr>
<th>request param</th>
</tr>
</thead>
<tbody>
<tr>
<td>phrase</td>
</tr>
</tbody>
</table>
<h3 id="build-design-allfunds-components-af-funds-response_1">Response<a class="headerlink" href="#build-design-allfunds-components-af-funds-response_1" title="Permanent link">#</a></h3>
<h4 id="build-design-allfunds-components-af-funds-response-body_1">Response Body<a class="headerlink" href="#build-design-allfunds-components-af-funds-response-body_1" title="Permanent link">#</a></h4>
<table>
<thead>
<tr>
<th>body</th>
<th>Headers</th>
</tr>
</thead>
<tbody>
<tr>
<td>JSON</td>
<td>accept=application/json</td>
</tr>
</tbody>
</table>
<h1 id="build-design-allfunds-components-af-funds-interface-filter">Interface filter<a class="headerlink" href="#build-design-allfunds-components-af-funds-interface-filter" title="Permanent link">#</a></h1>
<h2 id="build-design-allfunds-components-af-funds-api-apifundsfilter">api : /api/funds/filter<a class="headerlink" href="#build-design-allfunds-components-af-funds-api-apifundsfilter" title="Permanent link">#</a></h2>
<h2 id="build-design-allfunds-components-af-funds-request-and-response-of-filter">Request and Response of filter<a class="headerlink" href="#build-design-allfunds-components-af-funds-request-and-response-of-filter" title="Permanent link">#</a></h2>
<h3 id="build-design-allfunds-components-af-funds-request_2">Request<a class="headerlink" href="#build-design-allfunds-components-af-funds-request_2" title="Permanent link">#</a></h3>
<h4 id="build-design-allfunds-components-af-funds-request-body_2">Request Body<a class="headerlink" href="#build-design-allfunds-components-af-funds-request-body_2" title="Permanent link">#</a></h4>
<p><span dir="">We can filter funds by passing asset class type and consistency factor as FilterRequest</span></p>
<table>
<thead>
<tr>
<th>Request name</th>
<th>body</th>
<th>Headers</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>FilterRequest</td>
<td>JSON</td>
<td>accept=application/json</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="build-design-allfunds-components-af-funds-response_2">Response<a class="headerlink" href="#build-design-allfunds-components-af-funds-response_2" title="Permanent link">#</a></h3>
<h4 id="build-design-allfunds-components-af-funds-response_3">Response<a class="headerlink" href="#build-design-allfunds-components-af-funds-response_3" title="Permanent link">#</a></h4>
<table>
<thead>
<tr>
<th>Headers</th>
</tr>
</thead>
<tbody>
<tr>
<td>contentType=text/csv</td>
</tr>
</tbody>
</table>
<h1 id="build-design-allfunds-components-af-funds-interface-facts">Interface facts<a class="headerlink" href="#build-design-allfunds-components-af-funds-interface-facts" title="Permanent link">#</a></h1>
<h2 id="build-design-allfunds-components-af-funds-api-apifundsisinfacts">api : /api/funds/{isin}/facts<a class="headerlink" href="#build-design-allfunds-components-af-funds-api-apifundsisinfacts" title="Permanent link">#</a></h2>
<h2 id="build-design-allfunds-components-af-funds-request-and-response-of-facts">Request and Response of facts<a class="headerlink" href="#build-design-allfunds-components-af-funds-request-and-response-of-facts" title="Permanent link">#</a></h2>
<h3 id="build-design-allfunds-components-af-funds-request_3">Request<a class="headerlink" href="#build-design-allfunds-components-af-funds-request_3" title="Permanent link">#</a></h3>
<h4 id="build-design-allfunds-components-af-funds-request-body_3">Request Body<a class="headerlink" href="#build-design-allfunds-components-af-funds-request-body_3" title="Permanent link">#</a></h4>
<p><span dir="">We can fetch fatcs by isin</span>.</p>
<table>
<thead>
<tr>
<th>request-param</th>
</tr>
</thead>
<tbody>
<tr>
<td>isin</td>
</tr>
</tbody>
</table>
<h3 id="build-design-allfunds-components-af-funds-response_4">Response<a class="headerlink" href="#build-design-allfunds-components-af-funds-response_4" title="Permanent link">#</a></h3>
<h4 id="build-design-allfunds-components-af-funds-response-body_2">Response Body<a class="headerlink" href="#build-design-allfunds-components-af-funds-response-body_2" title="Permanent link">#</a></h4>
<table>
<thead>
<tr>
<th>Headers</th>
</tr>
</thead>
<tbody>
<tr>
<td>contentType=text/csv</td>
</tr>
</tbody>
</table>
<h1 id="build-design-allfunds-components-af-funds-interface-attributes">Interface attributes<a class="headerlink" href="#build-design-allfunds-components-af-funds-interface-attributes" title="Permanent link">#</a></h1>
<h2 id="build-design-allfunds-components-af-funds-api-apifundsisinattributes">api : /api/funds/{isin}/attributes<a class="headerlink" href="#build-design-allfunds-components-af-funds-api-apifundsisinattributes" title="Permanent link">#</a></h2>
<h2 id="build-design-allfunds-components-af-funds-request-and-response-of-attributes">Request and Response of attributes<a class="headerlink" href="#build-design-allfunds-components-af-funds-request-and-response-of-attributes" title="Permanent link">#</a></h2>
<h3 id="build-design-allfunds-components-af-funds-request_4">Request<a class="headerlink" href="#build-design-allfunds-components-af-funds-request_4" title="Permanent link">#</a></h3>
<h4 id="build-design-allfunds-components-af-funds-request-body_4">Request Body<a class="headerlink" href="#build-design-allfunds-components-af-funds-request-body_4" title="Permanent link">#</a></h4>
<p><span dir="">We can fetch attributes by isin</span>.</p>
<table>
<thead>
<tr>
<th>request-param</th>
</tr>
</thead>
<tbody>
<tr>
<td>fund-name</td>
</tr>
</tbody>
</table>
<h3 id="build-design-allfunds-components-af-funds-response_5">Response<a class="headerlink" href="#build-design-allfunds-components-af-funds-response_5" title="Permanent link">#</a></h3>
<h4 id="build-design-allfunds-components-af-funds-response-body_3">Response Body<a class="headerlink" href="#build-design-allfunds-components-af-funds-response-body_3" title="Permanent link">#</a></h4>
<table>
<thead>
<tr>
<th>Headers</th>
</tr>
</thead>
<tbody>
<tr>
<td>contentType=text/csv</td>
</tr>
</tbody>
</table>
<h1 id="build-design-allfunds-components-af-funds-interface-recommendation">Interface recommendation<a class="headerlink" href="#build-design-allfunds-components-af-funds-interface-recommendation" title="Permanent link">#</a></h1>
<h2 id="build-design-allfunds-components-af-funds-api-apirestrecommendation">api : /api/rest/recommendation<a class="headerlink" href="#build-design-allfunds-components-af-funds-api-apirestrecommendation" title="Permanent link">#</a></h2>
<h2 id="build-design-allfunds-components-af-funds-request-and-response">Request and Response<a class="headerlink" href="#build-design-allfunds-components-af-funds-request-and-response" title="Permanent link">#</a></h2>
<h3 id="build-design-allfunds-components-af-funds-request_5">Request<a class="headerlink" href="#build-design-allfunds-components-af-funds-request_5" title="Permanent link">#</a></h3>
<h4 id="build-design-allfunds-components-af-funds-request-body_5">Request Body<a class="headerlink" href="#build-design-allfunds-components-af-funds-request-body_5" title="Permanent link">#</a></h4>
<p><span dir="">We can get recommendations</span></p>
<table>
<thead>
<tr>
<th>Request name</th>
<th>body</th>
<th>Headers</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>PortfolioRecommendationRequest</td>
<td>JSON</td>
<td>accept=application/json</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="build-design-allfunds-components-af-funds-response_6">Response<a class="headerlink" href="#build-design-allfunds-components-af-funds-response_6" title="Permanent link">#</a></h3>
<h4 id="build-design-allfunds-components-af-funds-response-body_4">Response Body<a class="headerlink" href="#build-design-allfunds-components-af-funds-response-body_4" title="Permanent link">#</a></h4>
<table>
<thead>
<tr>
<th>Request name</th>
<th>body</th>
<th>Headers</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>PortfolioRecommendationResponse</td>
<td>JSON</td>
<td>accept=application/json</td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="build-design-allfunds-components-af-funds-diagrams">Diagrams<a class="headerlink" href="#build-design-allfunds-components-af-funds-diagrams" title="Permanent link">#</a></h1>
<p>Data flow diagram</p>
<h2 id="build-design-allfunds-components-af-funds-example-diagram">Example diagram<a class="headerlink" href="#build-design-allfunds-components-af-funds-example-diagram" title="Permanent link">#</a></h2>
<div class="highlight"><pre><span></span><code>flowchart TD
    A[Client] --&gt;|uploading excel file\n of fund details|B(Fund upload API)
    B --&gt;|uploading excel file| C[File Upload Service]
    C --&gt; B
    B --&gt; |parsing catalog|D[Catalog Excel Parser Service]
    D --&gt; B
    B --&gt; |calling fund service to \nstore funds in Database|E[Fund Service]
    E ==&gt; |store funds| F[(Funds Database)]
    E ==&gt; |store funds returns| F
    E ==&gt; |validate funds \n stored procedure will be callded| F
</code></pre></div>
<h1 id="build-design-allfunds-components-af-funds-persistence">Persistence<a class="headerlink" href="#build-design-allfunds-components-af-funds-persistence" title="Permanent link">#</a></h1>
<h2 id="build-design-allfunds-components-af-funds-postgres">Postgres<a class="headerlink" href="#build-design-allfunds-components-af-funds-postgres" title="Permanent link">#</a></h2>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Database Engine</td>
<td>postgresql</td>
</tr>
<tr>
<td>Schema</td>
<td></td>
</tr>
<tr>
<td>Migrations</td>
<td>Yes / No</td>
</tr>
<tr>
<td>Charset</td>
<td>UTF-8</td>
</tr>
</tbody>
</table>
<h3 id="build-design-allfunds-components-af-funds-dictionary">Dictionary<a class="headerlink" href="#build-design-allfunds-components-af-funds-dictionary" title="Permanent link">#</a></h3>
<h4 id="build-design-allfunds-components-af-funds-tables">Tables<a class="headerlink" href="#build-design-allfunds-components-af-funds-tables" title="Permanent link">#</a></h4>
<table>
<thead>
<tr>
<th>Table</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>templates</td>
<td>Maintain all templates</td>
</tr>
<tr>
<td>notifications_audit</td>
<td>Maintain notification data</td>
</tr>
</tbody>
</table>
<h4 id="build-design-allfunds-components-af-funds-fields">Fields<a class="headerlink" href="#build-design-allfunds-components-af-funds-fields" title="Permanent link">#</a></h4>
<table>
<thead>
<tr>
<th>Table</th>
<th>Field</th>
<th>Purpose</th>
<th>Type</th>
<th>Size</th>
<th>Nullable</th>
<th>Keys</th>
</tr>
</thead>
<tbody>
<tr>
<td>notifications_audit</td>
<td>id</td>
<td>Identifier</td>
<td>int</td>
<td></td>
<td>No</td>
<td>PK</td>
</tr>
<tr>
<td>notifications_audit</td>
<td>sender</td>
<td>notification sender</td>
<td>text</td>
<td>255</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td>notifications_audit</td>
<td>receiver</td>
<td>notification receiver</td>
<td>text</td>
<td>255</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td>notifications_audit</td>
<td>message</td>
<td>message</td>
<td>text</td>
<td>255</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td>notifications_audit</td>
<td>createdDate</td>
<td>notification created date</td>
<td>date</td>
<td>20</td>
<td>Yes</td>
<td></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Table</th>
<th>Field</th>
<th>Purpose</th>
<th>Type</th>
<th>Size</th>
<th>Nullable</th>
<th>Keys</th>
</tr>
</thead>
<tbody>
<tr>
<td>templates</td>
<td>key</td>
<td>Identifier</td>
<td>text</td>
<td></td>
<td>No</td>
<td>PK</td>
</tr>
<tr>
<td>templates</td>
<td>description</td>
<td>template description</td>
<td>text</td>
<td>255</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td>templates</td>
<td>type</td>
<td>notification type</td>
<td>text</td>
<td>255</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td>templates</td>
<td>subject</td>
<td>email subject</td>
<td>text</td>
<td>255</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td>templates</td>
<td>body</td>
<td>email body</td>
<td>text</td>
<td>255</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td>templates</td>
<td>status</td>
<td>template status</td>
<td>text</td>
<td>1</td>
<td>Yes</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="build-design-allfunds-components-af-funds-mongo">Mongo<a class="headerlink" href="#build-design-allfunds-components-af-funds-mongo" title="Permanent link">#</a></h2>
<h3 id="build-design-allfunds-components-af-funds-collections">Collections<a class="headerlink" href="#build-design-allfunds-components-af-funds-collections" title="Permanent link">#</a></h3>
<h4 id="build-design-allfunds-components-af-funds-example">Example<a class="headerlink" href="#build-design-allfunds-components-af-funds-example" title="Permanent link">#</a></h4>
<div class="highlight"><pre><span></span><code>
</code></pre></div>
<h1 id="build-design-allfunds-components-af-funds-build">Build<a class="headerlink" href="#build-design-allfunds-components-af-funds-build" title="Permanent link">#</a></h1>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Artifacts</td>
<td></td>
</tr>
<tr>
<td>Location</td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="build-design-allfunds-components-af-funds-deployment">Deployment<a class="headerlink" href="#build-design-allfunds-components-af-funds-deployment" title="Permanent link">#</a></h1>
<p>To be filled</p>
<h1 id="build-design-allfunds-components-af-funds-security">Security<a class="headerlink" href="#build-design-allfunds-components-af-funds-security" title="Permanent link">#</a></h1>
<p>To be filled</p>
<h1 id="build-design-allfunds-components-af-funds-scalability">Scalability<a class="headerlink" href="#build-design-allfunds-components-af-funds-scalability" title="Permanent link">#</a></h1>
<p>To be filled</p>
<h1 id="build-design-allfunds-components-af-funds-resilience">Resilience<a class="headerlink" href="#build-design-allfunds-components-af-funds-resilience" title="Permanent link">#</a></h1>
<p>To be filled</p></section><section class="print-page" id="build-design-allfunds-components-af-notifications"><h1 id="build-design-allfunds-components-af-notifications-notifications-microservice">Notifications Microservice<a class="headerlink" href="#build-design-allfunds-components-af-notifications-notifications-microservice" title="Permanent link">#</a></h1>
<p><span dir="">An af-notification is designed to send notifications to end users in the form of emails, and text messages.To send email notifications to customer af-notification integrated with Sendinblue API and using pub/sub model. </span></p>
<h1 id="build-design-allfunds-components-af-notifications-interface">Interface<a class="headerlink" href="#build-design-allfunds-components-af-notifications-interface" title="Permanent link">#</a></h1>
<h2 id="build-design-allfunds-components-af-notifications-messaging">Messaging<a class="headerlink" href="#build-design-allfunds-components-af-notifications-messaging" title="Permanent link">#</a></h2>
<h3 id="build-design-allfunds-components-af-notifications-commands">Commands<a class="headerlink" href="#build-design-allfunds-components-af-notifications-commands" title="Permanent link">#</a></h3>
<h4 id="build-design-allfunds-components-af-notifications-sendemailcommand">SendEmailCommand<a class="headerlink" href="#build-design-allfunds-components-af-notifications-sendemailcommand" title="Permanent link">#</a></h4>
<p><span dir="">The SendEmailCommand payload consumed from different module via RabbitMQ message broker to notify user with email format.</span></p>
<table>
<thead>
<tr>
<th>Queue</th>
<th>Routing Key</th>
<th>Headers</th>
<th>Retriable</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>email-queue</td>
<td></td>
<td>content_type=application/json</td>
<td>Yes</td>
<td></td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code>@startjson
{
  &quot;$schema&quot;: &quot;http://json-schema.org/draft-04/schema#&quot;,
  &quot;type&quot;: &quot;object&quot;,
  &quot;properties&quot;: {
    &quot;from&quot;: {
      &quot;type&quot;: &quot;string&quot;
    },
    &quot;to&quot;: {
      &quot;type&quot;: &quot;string&quot;
    },
    &quot;templateKey&quot;: {
      &quot;type&quot;: &quot;string&quot;
    },
    &quot;parameters&quot;: {
      &quot;type&quot;: &quot;object&quot;,
      &quot;properties&quot;: {
        &quot;orderNo&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;address&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;bodyParam&quot;: {
          &quot;type&quot;: &quot;string&quot;
        }
      },
      &quot;required&quot;: [
        &quot;orderNo&quot;,
        &quot;address&quot;,
        &quot;bodyParam&quot;
      ]
    }
  },
  &quot;required&quot;: [
    &quot;from&quot;,
    &quot;to&quot;,
    &quot;templateKey&quot;,
    &quot;parameters&quot;
  ]
}
@endjson
</code></pre></div>
<h3 id="build-design-allfunds-components-af-notifications-events">Events<a class="headerlink" href="#build-design-allfunds-components-af-notifications-events" title="Permanent link">#</a></h3>
<h4 id="build-design-allfunds-components-af-notifications-exampleevent">ExampleEvent<a class="headerlink" href="#build-design-allfunds-components-af-notifications-exampleevent" title="Permanent link">#</a></h4>
<table>
<thead>
<tr>
<th>Exchange</th>
<th>Routing Key</th>
<th>Headers</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>email-exchange</td>
<td></td>
<td>content_type=application/json</td>
<td></td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><span class="err">jso</span><span class="kc">n</span><span class="w"> </span><span class="err">schema</span><span class="w"> </span><span class="err">o</span><span class="kc">f</span><span class="w"> </span><span class="kc">t</span><span class="err">he</span><span class="w"> </span><span class="err">payload</span>
</code></pre></div>
<h3 id="build-design-allfunds-components-af-notifications-bindings">Bindings<a class="headerlink" href="#build-design-allfunds-components-af-notifications-bindings" title="Permanent link">#</a></h3>
<table>
<thead>
<tr>
<th>Exchange</th>
<th>Type</th>
<th>Queue</th>
<th>Routing Key</th>
</tr>
</thead>
<tbody>
<tr>
<td>email-exchange</td>
<td>topic</td>
<td>email-queue</td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="build-design-allfunds-components-af-notifications-diagrams">Diagrams<a class="headerlink" href="#build-design-allfunds-components-af-notifications-diagrams" title="Permanent link">#</a></h1>
<p>Data flow diagram</p>
<h2 id="build-design-allfunds-components-af-notifications-example-diagram">Example diagram<a class="headerlink" href="#build-design-allfunds-components-af-notifications-example-diagram" title="Permanent link">#</a></h2>
<div class="highlight"><pre><span></span><code>flowchart TD
    G[publisher1]
    H[publisher2]
    I[publisher3]
    G --&gt;|publish| J[email-message queue]
    H --&gt;|publish| J[email-message queue]
    I --&gt;|publish| J[email-message queue]
    J --&gt;|subscribe| K[af-notification]
    K --&gt;|success| L[send-notification]
    K --&gt;|failure| M[retry-queue]
</code></pre></div>
<h1 id="build-design-allfunds-components-af-notifications-persistence">Persistence<a class="headerlink" href="#build-design-allfunds-components-af-notifications-persistence" title="Permanent link">#</a></h1>
<h2 id="build-design-allfunds-components-af-notifications-postgres">Postgres<a class="headerlink" href="#build-design-allfunds-components-af-notifications-postgres" title="Permanent link">#</a></h2>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Database Engine</td>
<td>postgresql</td>
</tr>
<tr>
<td>Schema</td>
<td></td>
</tr>
<tr>
<td>Migrations</td>
<td>Yes / No</td>
</tr>
<tr>
<td>Charset</td>
<td>UTF-8</td>
</tr>
</tbody>
</table>
<h3 id="build-design-allfunds-components-af-notifications-dictionary">Dictionary<a class="headerlink" href="#build-design-allfunds-components-af-notifications-dictionary" title="Permanent link">#</a></h3>
<h4 id="build-design-allfunds-components-af-notifications-tables">Tables<a class="headerlink" href="#build-design-allfunds-components-af-notifications-tables" title="Permanent link">#</a></h4>
<table>
<thead>
<tr>
<th>Table</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>templates</td>
<td>Maintain all templates</td>
</tr>
<tr>
<td>notifications_audit</td>
<td>Maintain notification data</td>
</tr>
</tbody>
</table>
<h4 id="build-design-allfunds-components-af-notifications-fields">Fields<a class="headerlink" href="#build-design-allfunds-components-af-notifications-fields" title="Permanent link">#</a></h4>
<table>
<thead>
<tr>
<th>Table</th>
<th>Field</th>
<th>Purpose</th>
<th>Type</th>
<th>Size</th>
<th>Nullable</th>
<th>Keys</th>
</tr>
</thead>
<tbody>
<tr>
<td>notifications_audit</td>
<td>id</td>
<td>Identifier</td>
<td>int</td>
<td></td>
<td>No</td>
<td>PK</td>
</tr>
<tr>
<td>notifications_audit</td>
<td>sender</td>
<td>notification sender</td>
<td>text</td>
<td>255</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td>notifications_audit</td>
<td>receiver</td>
<td>notification receiver</td>
<td>text</td>
<td>255</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td>notifications_audit</td>
<td>message</td>
<td>message</td>
<td>text</td>
<td>255</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td>notifications_audit</td>
<td>createdDate</td>
<td>notification created date</td>
<td>date</td>
<td>20</td>
<td>Yes</td>
<td></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Table</th>
<th>Field</th>
<th>Purpose</th>
<th>Type</th>
<th>Size</th>
<th>Nullable</th>
<th>Keys</th>
</tr>
</thead>
<tbody>
<tr>
<td>templates</td>
<td>key</td>
<td>Identifier</td>
<td>text</td>
<td></td>
<td>No</td>
<td>PK</td>
</tr>
<tr>
<td>templates</td>
<td>description</td>
<td>template description</td>
<td>text</td>
<td>255</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td>templates</td>
<td>type</td>
<td>notification type</td>
<td>text</td>
<td>255</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td>templates</td>
<td>subject</td>
<td>email subject</td>
<td>text</td>
<td>255</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td>templates</td>
<td>body</td>
<td>email body</td>
<td>text</td>
<td>255</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td>templates</td>
<td>status</td>
<td>template status</td>
<td>text</td>
<td>1</td>
<td>Yes</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="build-design-allfunds-components-af-notifications-mongo">Mongo<a class="headerlink" href="#build-design-allfunds-components-af-notifications-mongo" title="Permanent link">#</a></h2>
<h3 id="build-design-allfunds-components-af-notifications-collections">Collections<a class="headerlink" href="#build-design-allfunds-components-af-notifications-collections" title="Permanent link">#</a></h3>
<h4 id="build-design-allfunds-components-af-notifications-example">Example<a class="headerlink" href="#build-design-allfunds-components-af-notifications-example" title="Permanent link">#</a></h4>
<div class="highlight"><pre><span></span><code>
</code></pre></div>
<h1 id="build-design-allfunds-components-af-notifications-build">Build<a class="headerlink" href="#build-design-allfunds-components-af-notifications-build" title="Permanent link">#</a></h1>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Artifacts</td>
<td></td>
</tr>
<tr>
<td>Location</td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="build-design-allfunds-components-af-notifications-deployment">Deployment<a class="headerlink" href="#build-design-allfunds-components-af-notifications-deployment" title="Permanent link">#</a></h1>
<p>To be filled</p>
<h1 id="build-design-allfunds-components-af-notifications-security">Security<a class="headerlink" href="#build-design-allfunds-components-af-notifications-security" title="Permanent link">#</a></h1>
<p>To be filled</p>
<h1 id="build-design-allfunds-components-af-notifications-scalability">Scalability<a class="headerlink" href="#build-design-allfunds-components-af-notifications-scalability" title="Permanent link">#</a></h1>
<p>To be filled</p>
<h1 id="build-design-allfunds-components-af-notifications-resilience">Resilience<a class="headerlink" href="#build-design-allfunds-components-af-notifications-resilience" title="Permanent link">#</a></h1>
<p>To be filled</p></section><section class="print-page" id="build-design-allfunds-components-af-portfolio"><h1 id="build-design-allfunds-components-af-portfolio-portfolio-microservice">Portfolio Microservice<a class="headerlink" href="#build-design-allfunds-components-af-portfolio-portfolio-microservice" title="Permanent link">#</a></h1>
<p><span dir="">Portfolio is a collection of a wide range of asset classes like Equity, Debt, and Gold, spread across different asset strategies like Mutual Funds, etc. 
The right portfolio depends on usersâ€™ investment style, goals, risk tolerance, and time horizon (Short term / Long term). 
A good degree of diversification is recommended regardless of the portfolio type to avoid putting all your eggs in one basket.</span></p>
<h1 id="build-design-allfunds-components-af-portfolio-interface">Interface<a class="headerlink" href="#build-design-allfunds-components-af-portfolio-interface" title="Permanent link">#</a></h1>
<h2 id="build-design-allfunds-components-af-portfolio-messaging">Messaging<a class="headerlink" href="#build-design-allfunds-components-af-portfolio-messaging" title="Permanent link">#</a></h2>
<h3 id="build-design-allfunds-components-af-portfolio-commands">Commands<a class="headerlink" href="#build-design-allfunds-components-af-portfolio-commands" title="Permanent link">#</a></h3>
<h4 id="build-design-allfunds-components-af-portfolio-sendemailcommand">SendEmailCommand<a class="headerlink" href="#build-design-allfunds-components-af-portfolio-sendemailcommand" title="Permanent link">#</a></h4>
<p><span dir="">The SendEmailCommand payload consumed from different module via RabbitMQ message broker to notify user with email format.</span></p>
<table>
<thead>
<tr>
<th>Queue</th>
<th>Routing Key</th>
<th>Headers</th>
<th>Retriable</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>email-queue</td>
<td></td>
<td>content_type=application/json</td>
<td>Yes</td>
<td></td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;$schema&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;http://json-schema.org/draft-04/schema#&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;from&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;to&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;templateKey&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;parameters&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;orderNo&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;bodyParam&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;required&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s2">&quot;orderNo&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;address&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;bodyParam&quot;</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;required&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;from&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;to&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;templateKey&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;parameters&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="build-design-allfunds-components-af-portfolio-events">Events<a class="headerlink" href="#build-design-allfunds-components-af-portfolio-events" title="Permanent link">#</a></h3>
<h4 id="build-design-allfunds-components-af-portfolio-exampleevent">ExampleEvent<a class="headerlink" href="#build-design-allfunds-components-af-portfolio-exampleevent" title="Permanent link">#</a></h4>
<table>
<thead>
<tr>
<th>Exchange</th>
<th>Routing Key</th>
<th>Headers</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>email-exchange</td>
<td></td>
<td>content_type=application/json</td>
<td></td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><span class="err">jso</span><span class="kc">n</span><span class="w"> </span><span class="err">schema</span><span class="w"> </span><span class="err">o</span><span class="kc">f</span><span class="w"> </span><span class="kc">t</span><span class="err">he</span><span class="w"> </span><span class="err">payload</span>
</code></pre></div>
<h3 id="build-design-allfunds-components-af-portfolio-bindings">Bindings<a class="headerlink" href="#build-design-allfunds-components-af-portfolio-bindings" title="Permanent link">#</a></h3>
<table>
<thead>
<tr>
<th>Exchange</th>
<th>Type</th>
<th>Queue</th>
<th>Routing Key</th>
</tr>
</thead>
<tbody>
<tr>
<td>email-exchange</td>
<td>topic</td>
<td>email-queue</td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="build-design-allfunds-components-af-portfolio-diagrams">Diagrams<a class="headerlink" href="#build-design-allfunds-components-af-portfolio-diagrams" title="Permanent link">#</a></h1>
<p>Data flow diagram</p>
<h2 id="build-design-allfunds-components-af-portfolio-example-diagram">Example diagram<a class="headerlink" href="#build-design-allfunds-components-af-portfolio-example-diagram" title="Permanent link">#</a></h2>
<div class="highlight"><pre><span></span><code>flowchart TD
    G[publisher1]
    H[publisher2]
    I[publisher3]
    G --&gt;|publish| J[email-message queue]
    H --&gt;|publish| J[email-message queue]
    I --&gt;|publish| J[email-message queue]
    J --&gt;|subscribe| K[af-notification]
    K --&gt;|success| L[send-notification]
    K --&gt;|failure| M[retry-queue]
</code></pre></div>
<h1 id="build-design-allfunds-components-af-portfolio-persistence">Persistence<a class="headerlink" href="#build-design-allfunds-components-af-portfolio-persistence" title="Permanent link">#</a></h1>
<h2 id="build-design-allfunds-components-af-portfolio-postgres">Postgres<a class="headerlink" href="#build-design-allfunds-components-af-portfolio-postgres" title="Permanent link">#</a></h2>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Database Engine</td>
<td>postgresql</td>
</tr>
<tr>
<td>Schema</td>
<td></td>
</tr>
<tr>
<td>Migrations</td>
<td>Yes / No</td>
</tr>
<tr>
<td>Charset</td>
<td>UTF-8</td>
</tr>
</tbody>
</table>
<h3 id="build-design-allfunds-components-af-portfolio-dictionary">Dictionary<a class="headerlink" href="#build-design-allfunds-components-af-portfolio-dictionary" title="Permanent link">#</a></h3>
<h4 id="build-design-allfunds-components-af-portfolio-tables">Tables<a class="headerlink" href="#build-design-allfunds-components-af-portfolio-tables" title="Permanent link">#</a></h4>
<table>
<thead>
<tr>
<th>Table</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>templates</td>
<td>Maintain all templates</td>
</tr>
<tr>
<td>notifications_audit</td>
<td>Maintain notification data</td>
</tr>
</tbody>
</table>
<h4 id="build-design-allfunds-components-af-portfolio-fields">Fields<a class="headerlink" href="#build-design-allfunds-components-af-portfolio-fields" title="Permanent link">#</a></h4>
<table>
<thead>
<tr>
<th>Table</th>
<th>Field</th>
<th>Purpose</th>
<th>Type</th>
<th>Size</th>
<th>Nullable</th>
<th>Keys</th>
</tr>
</thead>
<tbody>
<tr>
<td>notifications_audit</td>
<td>id</td>
<td>Identifier</td>
<td>int</td>
<td></td>
<td>No</td>
<td>PK</td>
</tr>
<tr>
<td>notifications_audit</td>
<td>sender</td>
<td>notification sender</td>
<td>text</td>
<td>255</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td>notifications_audit</td>
<td>receiver</td>
<td>notification receiver</td>
<td>text</td>
<td>255</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td>notifications_audit</td>
<td>message</td>
<td>message</td>
<td>text</td>
<td>255</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td>notifications_audit</td>
<td>createdDate</td>
<td>notification created date</td>
<td>date</td>
<td>20</td>
<td>Yes</td>
<td></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Table</th>
<th>Field</th>
<th>Purpose</th>
<th>Type</th>
<th>Size</th>
<th>Nullable</th>
<th>Keys</th>
</tr>
</thead>
<tbody>
<tr>
<td>templates</td>
<td>key</td>
<td>Identifier</td>
<td>text</td>
<td></td>
<td>No</td>
<td>PK</td>
</tr>
<tr>
<td>templates</td>
<td>description</td>
<td>template description</td>
<td>text</td>
<td>255</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td>templates</td>
<td>type</td>
<td>notification type</td>
<td>text</td>
<td>255</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td>templates</td>
<td>subject</td>
<td>email subject</td>
<td>text</td>
<td>255</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td>templates</td>
<td>body</td>
<td>email body</td>
<td>text</td>
<td>255</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td>templates</td>
<td>status</td>
<td>template status</td>
<td>text</td>
<td>1</td>
<td>Yes</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="build-design-allfunds-components-af-portfolio-mongo">Mongo<a class="headerlink" href="#build-design-allfunds-components-af-portfolio-mongo" title="Permanent link">#</a></h2>
<h3 id="build-design-allfunds-components-af-portfolio-collections">Collections<a class="headerlink" href="#build-design-allfunds-components-af-portfolio-collections" title="Permanent link">#</a></h3>
<h4 id="build-design-allfunds-components-af-portfolio-example">Example<a class="headerlink" href="#build-design-allfunds-components-af-portfolio-example" title="Permanent link">#</a></h4>
<div class="highlight"><pre><span></span><code>
</code></pre></div>
<h1 id="build-design-allfunds-components-af-portfolio-build">Build<a class="headerlink" href="#build-design-allfunds-components-af-portfolio-build" title="Permanent link">#</a></h1>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Artifacts</td>
<td></td>
</tr>
<tr>
<td>Location</td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="build-design-allfunds-components-af-portfolio-deployment">Deployment<a class="headerlink" href="#build-design-allfunds-components-af-portfolio-deployment" title="Permanent link">#</a></h1>
<h1 id="build-design-allfunds-components-af-portfolio-security">Security<a class="headerlink" href="#build-design-allfunds-components-af-portfolio-security" title="Permanent link">#</a></h1>
<h1 id="build-design-allfunds-components-af-portfolio-scalability">Scalability<a class="headerlink" href="#build-design-allfunds-components-af-portfolio-scalability" title="Permanent link">#</a></h1>
<h1 id="build-design-allfunds-components-af-portfolio-resilience">Resilience<a class="headerlink" href="#build-design-allfunds-components-af-portfolio-resilience" title="Permanent link">#</a></h1></section><section class="print-page" id="build-design-allfunds-components-af-profile"><h1 id="build-design-allfunds-components-af-profile-profile-microservice">Profile Microservice<a class="headerlink" href="#build-design-allfunds-components-af-profile-profile-microservice" title="Permanent link">#</a></h1>
<p><span dir="">User profile data, including financial goals, risk tolerance, and investment preferences, forms the core of effective wealth management, ensuring personalized strategies that align with clients' unique objectives.</span></p>
<h1 id="build-design-allfunds-components-af-profile-interface">Interface<a class="headerlink" href="#build-design-allfunds-components-af-profile-interface" title="Permanent link">#</a></h1>
<h2 id="build-design-allfunds-components-af-profile-messaging">Messaging<a class="headerlink" href="#build-design-allfunds-components-af-profile-messaging" title="Permanent link">#</a></h2>
<h3 id="build-design-allfunds-components-af-profile-commands">Commands<a class="headerlink" href="#build-design-allfunds-components-af-profile-commands" title="Permanent link">#</a></h3>
<h4 id="build-design-allfunds-components-af-profile-sendemailcommand">SendEmailCommand<a class="headerlink" href="#build-design-allfunds-components-af-profile-sendemailcommand" title="Permanent link">#</a></h4>
<p><span dir="">The SendEmailCommand payload consumed from different module via RabbitMQ message broker to notify user with email format.</span></p>
<table>
<thead>
<tr>
<th>Queue</th>
<th>Routing Key</th>
<th>Headers</th>
<th>Retriable</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>email-queue</td>
<td></td>
<td>content_type=application/json</td>
<td>Yes</td>
<td></td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;$schema&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;http://json-schema.org/draft-04/schema#&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;from&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;to&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;templateKey&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;parameters&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;orderNo&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;bodyParam&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;required&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s2">&quot;orderNo&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;address&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;bodyParam&quot;</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;required&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;from&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;to&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;templateKey&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;parameters&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="build-design-allfunds-components-af-profile-events">Events<a class="headerlink" href="#build-design-allfunds-components-af-profile-events" title="Permanent link">#</a></h3>
<h4 id="build-design-allfunds-components-af-profile-exampleevent">ExampleEvent<a class="headerlink" href="#build-design-allfunds-components-af-profile-exampleevent" title="Permanent link">#</a></h4>
<table>
<thead>
<tr>
<th>Exchange</th>
<th>Routing Key</th>
<th>Headers</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>email-exchange</td>
<td></td>
<td>content_type=application/json</td>
<td></td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><span class="err">jso</span><span class="kc">n</span><span class="w"> </span><span class="err">schema</span><span class="w"> </span><span class="err">o</span><span class="kc">f</span><span class="w"> </span><span class="kc">t</span><span class="err">he</span><span class="w"> </span><span class="err">payload</span>
</code></pre></div>
<h3 id="build-design-allfunds-components-af-profile-bindings">Bindings<a class="headerlink" href="#build-design-allfunds-components-af-profile-bindings" title="Permanent link">#</a></h3>
<table>
<thead>
<tr>
<th>Exchange</th>
<th>Type</th>
<th>Queue</th>
<th>Routing Key</th>
</tr>
</thead>
<tbody>
<tr>
<td>email-exchange</td>
<td>topic</td>
<td>email-queue</td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="build-design-allfunds-components-af-profile-diagrams">Diagrams<a class="headerlink" href="#build-design-allfunds-components-af-profile-diagrams" title="Permanent link">#</a></h1>
<p>Data flow diagram</p>
<h2 id="build-design-allfunds-components-af-profile-example-diagram">Example diagram<a class="headerlink" href="#build-design-allfunds-components-af-profile-example-diagram" title="Permanent link">#</a></h2>
<div class="highlight"><pre><span></span><code>flowchart TD
    G[publisher1]
    H[publisher2]
    I[publisher3]
    G --&gt;|publish| J[email-message queue]
    H --&gt;|publish| J[email-message queue]
    I --&gt;|publish| J[email-message queue]
    J --&gt;|subscribe| K[af-notification]
    K --&gt;|success| L[send-notification]
    K --&gt;|failure| M[retry-queue]
</code></pre></div>
<h1 id="build-design-allfunds-components-af-profile-persistence">Persistence<a class="headerlink" href="#build-design-allfunds-components-af-profile-persistence" title="Permanent link">#</a></h1>
<h2 id="build-design-allfunds-components-af-profile-mongo">Mongo<a class="headerlink" href="#build-design-allfunds-components-af-profile-mongo" title="Permanent link">#</a></h2>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Database Engine</td>
<td>mongo</td>
</tr>
<tr>
<td>Schema</td>
<td>profile-db</td>
</tr>
<tr>
<td>Migrations</td>
<td>Yes / No</td>
</tr>
<tr>
<td>Charset</td>
<td>UTF-8</td>
</tr>
</tbody>
</table>
<h3 id="build-design-allfunds-components-af-profile-dictionary">Dictionary<a class="headerlink" href="#build-design-allfunds-components-af-profile-dictionary" title="Permanent link">#</a></h3>
<h4 id="build-design-allfunds-components-af-profile-collections">Collections<a class="headerlink" href="#build-design-allfunds-components-af-profile-collections" title="Permanent link">#</a></h4>
<table>
<thead>
<tr>
<th>Collections</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>verification</td>
<td>Otps sent for Mobile and email verification stored</td>
</tr>
<tr>
<td>users</td>
<td>user data is stored</td>
</tr>
<tr>
<td>sfa_token</td>
<td>to save long living tokens</td>
</tr>
</tbody>
</table>
<h4 id="build-design-allfunds-components-af-profile-json-schema">Json Schema<a class="headerlink" href="#build-design-allfunds-components-af-profile-json-schema" title="Permanent link">#</a></h4>
<p>user
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;$schema&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;http://json-schema.org/draft-04/schema#&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;code&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;userDetails&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nt">&quot;userId&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nt">&quot;iamId&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nt">&quot;schemaver&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;integer&quot;</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nt">&quot;traits&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;email&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="nt">&quot;phoneNumber&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="nt">&quot;firstName&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="nt">&quot;lastName&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="nt">&quot;isEmailVerified&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;boolean&quot;</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="nt">&quot;isMobileVerified&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;boolean&quot;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">              </span><span class="p">},</span>
<span class="w">              </span><span class="nt">&quot;required&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="s2">&quot;email&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s2">&quot;phoneNumber&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s2">&quot;firstName&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s2">&quot;lastName&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s2">&quot;isEmailVerified&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s2">&quot;isMobileVerified&quot;</span>
<span class="w">              </span><span class="p">]</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="nt">&quot;city&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="nt">&quot;pinCode&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="nt">&quot;state&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="nt">&quot;country&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">              </span><span class="p">},</span>
<span class="w">              </span><span class="nt">&quot;required&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="s2">&quot;address&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s2">&quot;city&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s2">&quot;pinCode&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s2">&quot;state&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s2">&quot;country&quot;</span>
<span class="w">              </span><span class="p">]</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nt">&quot;pan&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nt">&quot;can&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nt">&quot;membershipPlan&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nt">&quot;UCC&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">          </span><span class="p">},</span>
<span class="w">          </span><span class="nt">&quot;required&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="s2">&quot;_id&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;userId&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;iamId&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;schemaver&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;traits&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;address&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;pan&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;can&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;membershipPlan&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;UCC&quot;</span>
<span class="w">          </span><span class="p">]</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;required&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s2">&quot;userDetails&quot;</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;required&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;code&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;data&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div></p>
<h2 id="build-design-allfunds-components-af-profile-mongo_1">Mongo<a class="headerlink" href="#build-design-allfunds-components-af-profile-mongo_1" title="Permanent link">#</a></h2>
<h3 id="build-design-allfunds-components-af-profile-collections_1">Collections<a class="headerlink" href="#build-design-allfunds-components-af-profile-collections_1" title="Permanent link">#</a></h3>
<p>Here we are using some collections like</p>
<div class="highlight"><pre><span></span><code>verification - used to store the otps for the email and phone verifications.
</code></pre></div>
<p>users - used to save the users data</p>
<p>sfa_token - used to save the long lived sfa tokens</p>
<h4 id="build-design-allfunds-components-af-profile-example">Example<a class="headerlink" href="#build-design-allfunds-components-af-profile-example" title="Permanent link">#</a></h4>
<div class="highlight"><pre><span></span><code>
</code></pre></div>
<h1 id="build-design-allfunds-components-af-profile-build">Build<a class="headerlink" href="#build-design-allfunds-components-af-profile-build" title="Permanent link">#</a></h1>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Artifacts</td>
<td></td>
</tr>
<tr>
<td>Location</td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="build-design-allfunds-components-af-profile-deployment">Deployment<a class="headerlink" href="#build-design-allfunds-components-af-profile-deployment" title="Permanent link">#</a></h1>
<h1 id="build-design-allfunds-components-af-profile-security">Security<a class="headerlink" href="#build-design-allfunds-components-af-profile-security" title="Permanent link">#</a></h1>
<h1 id="build-design-allfunds-components-af-profile-scalability">Scalability<a class="headerlink" href="#build-design-allfunds-components-af-profile-scalability" title="Permanent link">#</a></h1>
<h1 id="build-design-allfunds-components-af-profile-resilience">Resilience<a class="headerlink" href="#build-design-allfunds-components-af-profile-resilience" title="Permanent link">#</a></h1></section><section class="print-page" id="build-design-allfunds-components-af-scheduler"><blockquote>
<p>This component is deprecated and is replaced by Kestra. It is documented here only for historical purposes.</p>
</blockquote>
<h1 id="build-design-allfunds-components-af-scheduler-scheduler-microservice">Scheduler Microservice<a class="headerlink" href="#build-design-allfunds-components-af-scheduler-scheduler-microservice" title="Permanent link">#</a></h1>
<p>af-scheduler: af-scheduler component is scheduler service of all-funds. This component manages jobs as scheduled tasks. Tasks related configurations are stored in database table. Jobs are triggered in regular interval of time as defined by cron expression. Once scheduler service starts, it fetches job related configuration from database and schedules the jobs with fetched configuration. It fetches configuration in every 5 minutes and checks if any configuration change happens. Old configuration of jobs will be deleted, and new configuration will be added to scheduler once change detected in configuration.\
\
Jobs: 1-Purge notification: Purge notification Job is triggered every midnight 12 am. Purge notification command is published to Rabbit MQ. From there, Notification service will consume the command and start deleting older notifications.</p>
<h1 id="build-design-allfunds-components-af-scheduler-interface">Interface<a class="headerlink" href="#build-design-allfunds-components-af-scheduler-interface" title="Permanent link">#</a></h1>
<h2 id="build-design-allfunds-components-af-scheduler-messaging">Messaging<a class="headerlink" href="#build-design-allfunds-components-af-scheduler-messaging" title="Permanent link">#</a></h2>
<h3 id="build-design-allfunds-components-af-scheduler-commands">Commands<a class="headerlink" href="#build-design-allfunds-components-af-scheduler-commands" title="Permanent link">#</a></h3>
<h4 id="build-design-allfunds-components-af-scheduler-executejobcommand">ExecuteJobCommand<a class="headerlink" href="#build-design-allfunds-components-af-scheduler-executejobcommand" title="Permanent link">#</a></h4>
<p><span dir="">The ExecuteJobCommand payload consumed from af-notification module via RabbitMQ message broker to notify notification component to purge older notifications.</span></p>
<table>
<thead>
<tr>
<th>Queue</th>
<th>Routing Key</th>
<th>Headers</th>
<th>Retriable</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>purge-notification</td>
<td></td>
<td>content_type=application/json</td>
<td>Yes</td>
<td></td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;$schema&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;http://json-schema.org/draft-04/schema#&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;from&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;to&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;templateKey&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;parameters&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;orderNo&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;bodyParam&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;required&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s2">&quot;orderNo&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;address&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;bodyParam&quot;</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;required&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;from&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;to&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;templateKey&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;parameters&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="build-design-allfunds-components-af-scheduler-events">Events<a class="headerlink" href="#build-design-allfunds-components-af-scheduler-events" title="Permanent link">#</a></h3>
<h4 id="build-design-allfunds-components-af-scheduler-exampleevent">ExampleEvent<a class="headerlink" href="#build-design-allfunds-components-af-scheduler-exampleevent" title="Permanent link">#</a></h4>
<table>
<thead>
<tr>
<th>Exchange</th>
<th>Routing Key</th>
<th>Headers</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>purge-notification</td>
<td></td>
<td>content_type=application/json</td>
<td></td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><span class="err">jso</span><span class="kc">n</span><span class="w"> </span><span class="err">schema</span><span class="w"> </span><span class="err">o</span><span class="kc">f</span><span class="w"> </span><span class="kc">t</span><span class="err">he</span><span class="w"> </span><span class="err">payload</span>
</code></pre></div>
<h3 id="build-design-allfunds-components-af-scheduler-bindings">Bindings<a class="headerlink" href="#build-design-allfunds-components-af-scheduler-bindings" title="Permanent link">#</a></h3>
<table>
<thead>
<tr>
<th>Exchange</th>
<th>Type</th>
<th>Queue</th>
<th>Routing Key</th>
</tr>
</thead>
<tbody>
<tr>
<td>purge-notification</td>
<td>topic</td>
<td>email-queue</td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="build-design-allfunds-components-af-scheduler-diagrams">Diagrams<a class="headerlink" href="#build-design-allfunds-components-af-scheduler-diagrams" title="Permanent link">#</a></h1>
<p>Data flow diagram</p>
<h2 id="build-design-allfunds-components-af-scheduler-example-diagram">Example diagram<a class="headerlink" href="#build-design-allfunds-components-af-scheduler-example-diagram" title="Permanent link">#</a></h2>
<div class="highlight"><pre><span></span><code>flowchart TD
    A[Start App] --&gt;|starts scheduler|B[Scheduler]
    B --&gt; |fetching scheduler related \nconfiguration in every 5 minute| C((database with \nscheduler configuration))
    C--&gt; |returned scheduler \nrelated configuration|B
    B--&gt; E{check if configuration change}
    E--&gt; |YES| F[Drop old configuration and \nAssign new configuration]
    F--&gt; B
    E--&gt; |NO|B
    B--&gt; |calling purge notification job| D[Purge Notification Job]
    D--&gt; |purge notification command \n 12 am every night|G[queue]
</code></pre></div>
<h1 id="build-design-allfunds-components-af-scheduler-persistence">Persistence<a class="headerlink" href="#build-design-allfunds-components-af-scheduler-persistence" title="Permanent link">#</a></h1>
<h2 id="build-design-allfunds-components-af-scheduler-postgres">Postgres<a class="headerlink" href="#build-design-allfunds-components-af-scheduler-postgres" title="Permanent link">#</a></h2>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Database Engine</td>
<td>postgresql</td>
</tr>
<tr>
<td>Schema</td>
<td></td>
</tr>
<tr>
<td>Migrations</td>
<td>Yes / No</td>
</tr>
<tr>
<td>Charset</td>
<td>UTF-8</td>
</tr>
</tbody>
</table>
<h3 id="build-design-allfunds-components-af-scheduler-dictionary">Dictionary<a class="headerlink" href="#build-design-allfunds-components-af-scheduler-dictionary" title="Permanent link">#</a></h3>
<h4 id="build-design-allfunds-components-af-scheduler-tables">Tables<a class="headerlink" href="#build-design-allfunds-components-af-scheduler-tables" title="Permanent link">#</a></h4>
<table>
<thead>
<tr>
<th>Table</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>schedule</td>
<td>Maintain all configuration related to scheduler</td>
</tr>
</tbody>
</table>
<h4 id="build-design-allfunds-components-af-scheduler-fields">Fields<a class="headerlink" href="#build-design-allfunds-components-af-scheduler-fields" title="Permanent link">#</a></h4>
<table>
<thead>
<tr>
<th>Table</th>
<th>Field</th>
<th>Purpose</th>
<th>Type</th>
<th>Size</th>
<th>Nullable</th>
<th>Keys</th>
</tr>
</thead>
<tbody>
<tr>
<td>schedule</td>
<td>job_key</td>
<td>Identifier</td>
<td>int</td>
<td></td>
<td>No</td>
<td>PK</td>
</tr>
<tr>
<td>schedule</td>
<td>job_description</td>
<td>notification sender</td>
<td>text</td>
<td>255</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td>schedule</td>
<td>schedule_cron</td>
<td>notification receiver</td>
<td>text</td>
<td>255</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td>schedule</td>
<td>routing_key</td>
<td>message</td>
<td>text</td>
<td>255</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td>schedule</td>
<td>context</td>
<td>notification created date</td>
<td>date</td>
<td>20</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td>schedule</td>
<td>active</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>schedule</td>
<td>payload</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>schedule</td>
<td>created</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>schedule</td>
<td>last_modified</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="build-design-allfunds-components-af-scheduler-mongo">Mongo<a class="headerlink" href="#build-design-allfunds-components-af-scheduler-mongo" title="Permanent link">#</a></h2>
<h3 id="build-design-allfunds-components-af-scheduler-collections">Collections<a class="headerlink" href="#build-design-allfunds-components-af-scheduler-collections" title="Permanent link">#</a></h3>
<h4 id="build-design-allfunds-components-af-scheduler-example">Example<a class="headerlink" href="#build-design-allfunds-components-af-scheduler-example" title="Permanent link">#</a></h4>
<div class="highlight"><pre><span></span><code>
</code></pre></div>
<h1 id="build-design-allfunds-components-af-scheduler-build">Build<a class="headerlink" href="#build-design-allfunds-components-af-scheduler-build" title="Permanent link">#</a></h1>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Artifacts</td>
<td></td>
</tr>
<tr>
<td>Location</td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="build-design-allfunds-components-af-scheduler-deployment">Deployment<a class="headerlink" href="#build-design-allfunds-components-af-scheduler-deployment" title="Permanent link">#</a></h1>
<h1 id="build-design-allfunds-components-af-scheduler-security">Security<a class="headerlink" href="#build-design-allfunds-components-af-scheduler-security" title="Permanent link">#</a></h1>
<h1 id="build-design-allfunds-components-af-scheduler-scalability">Scalability<a class="headerlink" href="#build-design-allfunds-components-af-scheduler-scalability" title="Permanent link">#</a></h1>
<h1 id="build-design-allfunds-components-af-scheduler-resilience">Resilience<a class="headerlink" href="#build-design-allfunds-components-af-scheduler-resilience" title="Permanent link">#</a></h1></section><section class="print-page" id="build-design-allfunds-components-dlq-processor"><h1 id="build-design-allfunds-components-dlq-processor-dlq-processor">DLQ Processor<a class="headerlink" href="#build-design-allfunds-components-dlq-processor-dlq-processor" title="Permanent link">#</a></h1>
<p><span dir="">An af-dlq-processor component will consume all undelivered or exception messages from the retry queue, then it will check that the routing key is configured in the dlq_event_config table and application.properties. If it is configured, then it will start the retry processing based on max retries in the dlq_event_config table otherwise it will publish the message to dead letter queue.</span></p>
<p><strong>Retry Processing</strong></p>
<p>In the retry processing it will publish the message to route exchange by using delay routing key (i.e here we are creating delay routing key by using routing key plus retry count).The delay routing keys will be binded with delay queues , these delay queues will consume the message and hold the message with configured TTL (time to leave).Once the message elapsed TTL time that message automatically moved to configured retry queues. The retry queues will consume the message and publish to origin queue for reprocessing. This process will be repeated until it reaches to max retries, once it reached to max retries still the issue presist, then that message will be moved to dead letter queue.</p>
<h1 id="build-design-allfunds-components-dlq-processor-interface">Interface<a class="headerlink" href="#build-design-allfunds-components-dlq-processor-interface" title="Permanent link">#</a></h1>
<h2 id="build-design-allfunds-components-dlq-processor-messaging">Messaging<a class="headerlink" href="#build-design-allfunds-components-dlq-processor-messaging" title="Permanent link">#</a></h2>
<h3 id="build-design-allfunds-components-dlq-processor-exchanges">Exchanges<a class="headerlink" href="#build-design-allfunds-components-dlq-processor-exchanges" title="Permanent link">#</a></h3>
<h4 id="build-design-allfunds-components-dlq-processor-retry-exchanges">Retry Exchanges<a class="headerlink" href="#build-design-allfunds-components-dlq-processor-retry-exchanges" title="Permanent link">#</a></h4>
<table>
<thead>
<tr>
<th>Exchange</th>
<th>Routing Key</th>
<th>Headers</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>retry-exchange</td>
<td>retry-routing-key</td>
<td>content_type=application/json</td>
<td></td>
</tr>
<tr>
<td>retry-exchange-1</td>
<td>retry.#.1</td>
<td>content_type=application/json</td>
<td></td>
</tr>
<tr>
<td>retry-exchange-2</td>
<td>retry.#.2</td>
<td>content_type=application/json</td>
<td></td>
</tr>
<tr>
<td>retry-exchange-3</td>
<td>retry.#.3</td>
<td>content_type=application/json</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="build-design-allfunds-components-dlq-processor-route-delay-exchanges">Route Delay Exchanges<a class="headerlink" href="#build-design-allfunds-components-dlq-processor-route-delay-exchanges" title="Permanent link">#</a></h4>
<p><span dir="">This Exchanges is used to publish the message to retry delay queues based on routing key</span></p>
<table>
<thead>
<tr>
<th>Exchange</th>
<th>Routing Key</th>
<th>Headers</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>route-delay</td>
<td>binding.#.1</td>
<td>content_type=application/json</td>
<td></td>
</tr>
<tr>
<td>route-delay</td>
<td>binding.#.2</td>
<td>content_type=application/json</td>
<td></td>
</tr>
<tr>
<td>route-delay</td>
<td>binding.#.3</td>
<td>content_type=application/json</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="build-design-allfunds-components-dlq-processor-dead-letter-exchanges">Dead Letter Exchanges<a class="headerlink" href="#build-design-allfunds-components-dlq-processor-dead-letter-exchanges" title="Permanent link">#</a></h4>
<p><span dir="">This Exchanges is used to publish the message based on routing key</span></p>
<table>
<thead>
<tr>
<th>Exchange</th>
<th>Routing Key</th>
<th>Headers</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>dlq-exchange</td>
<td>dlq-routing-key</td>
<td>content_type=application/json</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="build-design-allfunds-components-dlq-processor-test-exchanges">Test Exchanges<a class="headerlink" href="#build-design-allfunds-components-dlq-processor-test-exchanges" title="Permanent link">#</a></h4>
<p><span dir="">This Exchanges is used to publish the test messages based on routing key</span></p>
<table>
<thead>
<tr>
<th>Exchange</th>
<th>Routing Key</th>
<th>Headers</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>test-retry-exchange</td>
<td>rk.test.pass</td>
<td>content_type=application/json</td>
<td></td>
</tr>
<tr>
<td>test-retry-exchange</td>
<td>rk.test.fail</td>
<td>content_type=application/json</td>
<td></td>
</tr>
<tr>
<td>test-retry-exchange</td>
<td>rk.test.fail.pass</td>
<td>content_type=application/json</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="build-design-allfunds-components-dlq-processor-queues">Queues<a class="headerlink" href="#build-design-allfunds-components-dlq-processor-queues" title="Permanent link">#</a></h3>
<h4 id="build-design-allfunds-components-dlq-processor-retry-queues">Retry Queues<a class="headerlink" href="#build-design-allfunds-components-dlq-processor-retry-queues" title="Permanent link">#</a></h4>
<p><span dir="">This Queue will consume any undelivered or exception messages from the retry queue and send them to the retry delay queue.</span></p>
<table>
<thead>
<tr>
<th>Queue</th>
<th>Routing Key</th>
<th>Headers</th>
<th>Retriable</th>
<th>Arguments</th>
</tr>
</thead>
<tbody>
<tr>
<td>retry-queue</td>
<td>retry-routing-key</td>
<td>content_type=application/json</td>
<td></td>
<td></td>
</tr>
<tr>
<td>retry-queue-1</td>
<td>retry.#.1</td>
<td>content_type=application/json</td>
<td></td>
<td></td>
</tr>
<tr>
<td>retry-queue-2</td>
<td>retry.#.2</td>
<td>content_type=application/json</td>
<td></td>
<td></td>
</tr>
<tr>
<td>retry-queue-3</td>
<td>retry.#.3</td>
<td>content_type=application/json</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="build-design-allfunds-components-dlq-processor-delay-queues">Delay Queues<a class="headerlink" href="#build-design-allfunds-components-dlq-processor-delay-queues" title="Permanent link">#</a></h4>
<p><span dir="">This Queues will hold message based on TTL time and send them to the Origin queue.</span></p>
<table>
<thead>
<tr>
<th>Queue</th>
<th>Routing Key</th>
<th>Headers</th>
<th>Retriable</th>
<th>Arguments</th>
</tr>
</thead>
<tbody>
<tr>
<td>queue.delay.1</td>
<td>binding.#.1</td>
<td>content_type=application/json</td>
<td></td>
<td>x-dead-letter-exchange:retry-exchange-1,x-dead-letter-routing-key:retry.#.1,x-message-ttl:10000</td>
</tr>
<tr>
<td>queue.delay.2</td>
<td>binding.#.2</td>
<td>content_type=application/json</td>
<td></td>
<td>x-dead-letter-exchange:retry-exchange-2,x-dead-letter-routing-key:retry.#.2,x-message-ttl:15000</td>
</tr>
<tr>
<td>queue.delay.3</td>
<td>binding.#.3</td>
<td>content_type=application/json</td>
<td></td>
<td>x-dead-letter-exchange:retry-exchange-3,x-dead-letter-routing-key:retry.#.3,x-message-ttl:20000</td>
</tr>
</tbody>
</table>
<h4 id="build-design-allfunds-components-dlq-processor-dead-queues">Dead Queues<a class="headerlink" href="#build-design-allfunds-components-dlq-processor-dead-queues" title="Permanent link">#</a></h4>
<p><span dir="">This Queues used to hold the dead message</span></p>
<table>
<thead>
<tr>
<th>Queue</th>
<th>Routing Key</th>
<th>Headers</th>
<th>Retriable</th>
<th>Arguments</th>
</tr>
</thead>
<tbody>
<tr>
<td>dlq-queue</td>
<td>dlq-routing-key</td>
<td>content_type=application/json</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="build-design-allfunds-components-dlq-processor-test-queues">Test Queues<a class="headerlink" href="#build-design-allfunds-components-dlq-processor-test-queues" title="Permanent link">#</a></h4>
<p><span dir="">This Queues is used for consuming the test messages</span></p>
<table>
<thead>
<tr>
<th>Queue</th>
<th>Routing Key</th>
<th>Headers</th>
<th>Retriable</th>
<th>Arguments</th>
</tr>
</thead>
<tbody>
<tr>
<td>test-pass-queue</td>
<td>rk.test.pass</td>
<td>content_type=application/json</td>
<td></td>
<td>x-dead-letter-exchange:retry-exchange, x-dead-letter-routing-key: retry-routing-key, durable:true</td>
</tr>
<tr>
<td>test-fail-queue</td>
<td>rk.test.fail</td>
<td>content_type=application/json</td>
<td></td>
<td>x-dead-letter-exchange:retry-exchange, x-dead-letter-routing-key: retry-routing-key , durable:true</td>
</tr>
<tr>
<td>test-fail-pass-queue</td>
<td>rk.test.fail.pass</td>
<td>content_type=application/json</td>
<td></td>
<td>x-dead-letter-exchange:retry-exchange, x-dead-letter-routing-key: retry-routing-key , durable:true</td>
</tr>
</tbody>
</table>
<h3 id="build-design-allfunds-components-dlq-processor-bindings">Bindings<a class="headerlink" href="#build-design-allfunds-components-dlq-processor-bindings" title="Permanent link">#</a></h3>
<h4 id="build-design-allfunds-components-dlq-processor-retry-binding">Retry Binding<a class="headerlink" href="#build-design-allfunds-components-dlq-processor-retry-binding" title="Permanent link">#</a></h4>
<table>
<thead>
<tr>
<th>Exchange</th>
<th>Type</th>
<th>Queue</th>
<th>Routing Key</th>
</tr>
</thead>
<tbody>
<tr>
<td>retry-exchange</td>
<td>topic</td>
<td>retry-queue</td>
<td>retry-routing-key</td>
</tr>
<tr>
<td>retry-exchange-1</td>
<td>topic</td>
<td>retry-queue-1</td>
<td></td>
</tr>
<tr>
<td>retry-exchange-2</td>
<td>topic</td>
<td>retry-queue-2</td>
<td></td>
</tr>
<tr>
<td>retry-exchange-3</td>
<td>topic</td>
<td>retry-queue-3</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="build-design-allfunds-components-dlq-processor-route-delay-binding">Route Delay Binding<a class="headerlink" href="#build-design-allfunds-components-dlq-processor-route-delay-binding" title="Permanent link">#</a></h4>
<table>
<thead>
<tr>
<th>Exchange</th>
<th>Type</th>
<th>Queue</th>
<th>Routing Key</th>
</tr>
</thead>
<tbody>
<tr>
<td>route-delay</td>
<td>topic</td>
<td>queue.delay.1</td>
<td>binding.#.1</td>
</tr>
<tr>
<td>route-delay</td>
<td>topic</td>
<td>queue.delay.2</td>
<td>binding.#.2</td>
</tr>
<tr>
<td>route-delay</td>
<td>topic</td>
<td>queue.delay.3</td>
<td>binding.#.3</td>
</tr>
</tbody>
</table>
<h4 id="build-design-allfunds-components-dlq-processor-dead-letter-binding">Dead Letter Binding<a class="headerlink" href="#build-design-allfunds-components-dlq-processor-dead-letter-binding" title="Permanent link">#</a></h4>
<table>
<thead>
<tr>
<th>Exchange</th>
<th>Type</th>
<th>Queue</th>
<th>Routing Key</th>
</tr>
</thead>
<tbody>
<tr>
<td>dlq-exchange</td>
<td>topic</td>
<td>dlq-queue</td>
<td>dlq-exchange</td>
</tr>
</tbody>
</table>
<h4 id="build-design-allfunds-components-dlq-processor-test-retry-binding">Test Retry Binding<a class="headerlink" href="#build-design-allfunds-components-dlq-processor-test-retry-binding" title="Permanent link">#</a></h4>
<table>
<thead>
<tr>
<th>Exchange</th>
<th>Type</th>
<th>Queue</th>
<th>Routing Key</th>
</tr>
</thead>
<tbody>
<tr>
<td>test-retry-exchange</td>
<td>topic</td>
<td>test-pass-queue</td>
<td>rk.test.pass</td>
</tr>
<tr>
<td>test-retry-exchange</td>
<td>topic</td>
<td>test-fail-queue</td>
<td>rk.test.fail</td>
</tr>
<tr>
<td>test-retry-exchange</td>
<td>topic</td>
<td>test-fail-pass-queue</td>
<td>rk.test.fail.pass</td>
</tr>
</tbody>
</table>
<h1 id="build-design-allfunds-components-dlq-processor-diagrams">Diagrams<a class="headerlink" href="#build-design-allfunds-components-dlq-processor-diagrams" title="Permanent link">#</a></h1>
<p>Data flow diagram</p>
<h2 id="build-design-allfunds-components-dlq-processor-example-diagram">Example diagram<a class="headerlink" href="#build-design-allfunds-components-dlq-processor-example-diagram" title="Permanent link">#</a></h2>
<div class="highlight"><pre><span></span><code>flowchart TD
    pub1[publisher-1] --&gt;ex1(Exchange-1)--&gt;|Routing key-1| q1(Queue-1)
    pub2[publisher-2] --&gt;ex2(Exchange-2)--&gt;|Routing key-2| q2(Queue-2)
    q1--&gt;|success|sub1(subscriber-1)
    q1--&gt;|error| retryq(retryQueue)
    q2--&gt;|success| sub2(subscriber-2)
    q2--&gt;|error| retryq(retryQueue)
    retryq--&gt;dlqComp[DLQProcessor]
    dlqComp--&gt;|retry| retry{check Routing key \n is configured in \n dlq_event_config or \n application.props }
    retry--&gt;|yes| retryCount{retrycount&lt;=max-retry}
    retryCount--&gt;|no| dlq(dlqExchange)
    retryCount--&gt;|yes| routeDelayExchange(routeDelayExchange)
    routeDelayExchange--&gt;|1000sec| qd1(queuedelay-1)
    routeDelayExchange--&gt;|1500sec| qd2(queuedelay-2)
    routeDelayExchange--&gt;|2000sec| qd3(queuedelay-3)
    qd1--&gt;retryDelayExchange1[retryDelayExchange1]
    qd2--&gt;retryDelayExchange2[retryDelayExchange2]
    qd3--&gt;retryDelayExchange3[retryDelayExchange3]
    retryDelayExchange1--&gt;retryDelayQueue1[retryDelayQueue1]
    retryDelayExchange2--&gt;retryDelayQueue2[retryDelayQueue2]
    retryDelayExchange3--&gt;retryDelayQueue3[retryDelayQueue3]
    retryDelayQueue1--&gt;|republish to queue | ex1
    retryDelayQueue2--&gt;|republish to queue | ex1
    retryDelayQueue3--&gt;|republish to queue | ex1
    retryDelayQueue1--&gt;|republish to queue | ex2
    retryDelayQueue2--&gt;|republish to queue | ex2
    retryDelayQueue3--&gt;|republish to queue | ex2
    retry--&gt;|no| dlq(dlqExchange)
    dlq--&gt;dlqQueue(dlqQueue)
    dlqQueue--&gt;achor[fa:fa-user actor]
</code></pre></div>
<h1 id="build-design-allfunds-components-dlq-processor-persistence">Persistence<a class="headerlink" href="#build-design-allfunds-components-dlq-processor-persistence" title="Permanent link">#</a></h1>
<h2 id="build-design-allfunds-components-dlq-processor-postgres">Postgres<a class="headerlink" href="#build-design-allfunds-components-dlq-processor-postgres" title="Permanent link">#</a></h2>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Database Engine</td>
<td>postgresql</td>
</tr>
<tr>
<td>Schema</td>
<td></td>
</tr>
<tr>
<td>Migrations</td>
<td>Yes / No</td>
</tr>
<tr>
<td>Charset</td>
<td>UTF-8</td>
</tr>
</tbody>
</table>
<h3 id="build-design-allfunds-components-dlq-processor-dictionary">Dictionary<a class="headerlink" href="#build-design-allfunds-components-dlq-processor-dictionary" title="Permanent link">#</a></h3>
<h4 id="build-design-allfunds-components-dlq-processor-tables">Tables<a class="headerlink" href="#build-design-allfunds-components-dlq-processor-tables" title="Permanent link">#</a></h4>
<table>
<thead>
<tr>
<th>Table</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>dlq_event_config</td>
<td>This table is used to configure retries</td>
</tr>
</tbody>
</table>
<h4 id="build-design-allfunds-components-dlq-processor-fields">Fields<a class="headerlink" href="#build-design-allfunds-components-dlq-processor-fields" title="Permanent link">#</a></h4>
<table>
<thead>
<tr>
<th>Table</th>
<th>Field</th>
<th>Purpose</th>
<th>Type</th>
<th>Size</th>
<th>Nullable</th>
<th>Keys</th>
</tr>
</thead>
<tbody>
<tr>
<td>dlq_event_config</td>
<td>id</td>
<td>Identifier</td>
<td>int</td>
<td></td>
<td>No</td>
<td>PK</td>
</tr>
<tr>
<td>dlq_event_config</td>
<td>name</td>
<td>routing key name</td>
<td>varchar</td>
<td>100</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td>dlq_event_config</td>
<td>max_retries</td>
<td>max retries count</td>
<td>integer</td>
<td></td>
<td>Yes</td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="build-design-allfunds-components-dlq-processor-build">Build<a class="headerlink" href="#build-design-allfunds-components-dlq-processor-build" title="Permanent link">#</a></h1>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Artifacts</td>
<td></td>
</tr>
<tr>
<td>Location</td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="build-design-allfunds-components-dlq-processor-deployment">Deployment<a class="headerlink" href="#build-design-allfunds-components-dlq-processor-deployment" title="Permanent link">#</a></h1>
<p>To be filled</p>
<h1 id="build-design-allfunds-components-dlq-processor-security">Security<a class="headerlink" href="#build-design-allfunds-components-dlq-processor-security" title="Permanent link">#</a></h1>
<p>To be filled</p>
<h1 id="build-design-allfunds-components-dlq-processor-scalability">Scalability<a class="headerlink" href="#build-design-allfunds-components-dlq-processor-scalability" title="Permanent link">#</a></h1>
<p>To be filled</p>
<h1 id="build-design-allfunds-components-dlq-processor-resilience">Resilience<a class="headerlink" href="#build-design-allfunds-components-dlq-processor-resilience" title="Permanent link">#</a></h1>
<p>To be filled</p></section><section class="print-page" id="build-design-allfunds-components-statemachines"><h1 id="build-design-allfunds-components-statemachines-statemachines">StateMachines<a class="headerlink" href="#build-design-allfunds-components-statemachines-statemachines" title="Permanent link">#</a></h1>
<h2 id="build-design-allfunds-components-statemachines-lists">lists<a class="headerlink" href="#build-design-allfunds-components-statemachines-lists" title="Permanent link">#</a></h2>
<ul>
<li>Transaction Type State Machine</li>
</ul>
<h2 id="build-design-allfunds-components-statemachines-transaction-type-state-machine">Transaction Type State Machine<a class="headerlink" href="#build-design-allfunds-components-statemachines-transaction-type-state-machine" title="Permanent link">#</a></h2>
<table>
<thead>
<tr>
<th>State</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Created</td>
<td>The Transaction is created in the AllFunds system but has not yet been sent to a executor for processing</td>
</tr>
<tr>
<td>Sent</td>
<td>The transaction is sent to the executor for processing</td>
</tr>
<tr>
<td>Pending</td>
<td>The transaction is accepted by the executor for further processing</td>
</tr>
<tr>
<td>Rejected</td>
<td>The transaction has not been accepted by the executor for processing</td>
</tr>
<tr>
<td>Failed</td>
<td>The transaction has been reporrted as failed by the executor.</td>
</tr>
<tr>
<td>Completed</td>
<td>The transaction is completed.</td>
</tr>
</tbody>
</table>
<h3 id="build-design-allfunds-components-statemachines-visual">Visual<a class="headerlink" href="#build-design-allfunds-components-statemachines-visual" title="Permanent link">#</a></h3>
<p><img alt="Kroki" src="https://kroki.io/plantuml/png/eNpzKC5JLCopzc3hitaKVdDVtVNwLkpNLElNgfODU_NKuKCCCjA-iABxglKzUpNBqmECAal5KZl56VxQGiTklpiZA1SBJOKcn1uQkwrSBmeBrQJayQVRDefCLIALOACNATkXAPSCOSo=?"></p></section><h1 class='nav-section-title-end'>Ended: Components</h1>
                        <h4 class='nav-section-title' id='section-dictionary'>
                            Dictionary <a class='headerlink' href='#section-dictionary' title='Permanent link'>â†µ</a>
                        </h4>
                        <section class="print-page" id="build-design-allfunds-dictionary-collections"><h1 id="build-design-allfunds-dictionary-collections-collections">Collections<a class="headerlink" href="#build-design-allfunds-dictionary-collections-collections" title="Permanent link">#</a></h1>
<h2 id="build-design-allfunds-dictionary-collections-lists">lists<a class="headerlink" href="#build-design-allfunds-dictionary-collections-lists" title="Permanent link">#</a></h2>
<ul>
<li>users</li>
<li>verification</li>
<li>scratchpad</li>
<li>sfa_token</li>
<li>mfu_profiles</li>
<li>mfu_requests</li>
<li>mfu_nct</li>
</ul>
<h2 id="build-design-allfunds-dictionary-collections-users">users<a class="headerlink" href="#build-design-allfunds-dictionary-collections-users" title="Permanent link">#</a></h2>
<p>users collection stores user profile details like user id, user credential, audi, traits etc.</p>
<h3 id="build-design-allfunds-dictionary-collections-example">example<a class="headerlink" href="#build-design-allfunds-dictionary-collections-example" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ZVX1Z12L&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;audit&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;createdAt&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-11-09T06:47:57.634Z&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;lastUpdatedAt&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-11-09T06:47:57.634Z&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;credentials&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;mpin&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;method&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bcrypt&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;$2a$10$sqJLF2wG48NuD228YDXKseLRvpziPFXNsQsoMkAFXKdaqm9HADCVG&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;password&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;method&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bcrypt&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;$2a$10$Kwgj.LKGzXl7hIa8nYK/2.6SOK3u3uAfAFYnNr1UET1XXOLjc/kA6&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;lastEvent&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;createDate&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-12-05T09:58:12.645Z&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;eventType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;USER_LOGIN_FAILURE&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;payload&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{\&quot;userId\&quot;:\&quot;ZVX1Z12L\&quot;,\&quot;emailId\&quot;:\&quot;test1@gmail.com\&quot;,\&quot;userAgent\&quot;:null,\&quot;deviceId\&quot;:\&quot;goldfish_x86_64\&quot;,\&quot;ipAddress\&quot;:null,\&quot;os\&quot;:null}&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;routingKey&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;user.login-failure&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;realm&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;internal&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;schemaVer&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;traits&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;general&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;email&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test1@gmail.com&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;emailVerified&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;firstName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;T&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;lastName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;D&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;phoneNumber&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;7755221144&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;phoneVerified&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;userType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;customer&quot;</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="build-design-allfunds-dictionary-collections-visual">visual<a class="headerlink" href="#build-design-allfunds-dictionary-collections-visual" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code>@startjson
{
  &quot;_id&quot;: &quot;ZVX1Z12L&quot;,
  &quot;audit&quot;: {
    &quot;createdAt&quot;: &quot;2023-11-09T06:47:57.634Z&quot;,
    &quot;lastUpdatedAt&quot;: &quot;2023-11-09T06:47:57.634Z&quot;
  },
  &quot;credentials&quot;: {
    &quot;mpin&quot;: {
      &quot;method&quot;: &quot;bcrypt&quot;,
      &quot;value&quot;: &quot;$2a$10$sqJLF2wG48NuD228YDXKseLRvpziPFXNsQsoMkAFXKdaqm9HADCVG&quot;
    },
    &quot;password&quot;: {
      &quot;method&quot;: &quot;bcrypt&quot;,
      &quot;value&quot;: &quot;$2a$10$Kwgj.LKGzXl7hIa8nYK/2.6SOK3u3uAfAFYnNr1UET1XXOLjc/kA6&quot;
    }
  },
  &quot;lastEvent&quot;: {
    &quot;createDate&quot;: &quot;2023-12-05T09:58:12.645Z&quot;,
    &quot;eventType&quot;: &quot;USER_LOGIN_FAILURE&quot;,
    &quot;payload&quot;: &quot;{\&quot;userId\&quot;:\&quot;ZVX1Z12L\&quot;,\&quot;emailId\&quot;:\&quot;test1@gmail.com\&quot;,\&quot;userAgent\&quot;:null,\&quot;deviceId\&quot;:\&quot;goldfish_x86_64\&quot;,\&quot;ipAddress\&quot;:null,\&quot;os\&quot;:null}&quot;,
    &quot;routingKey&quot;: &quot;user.login-failure&quot;
  },
  &quot;realm&quot;: &quot;internal&quot;,
  &quot;schemaVer&quot;: 0,
  &quot;traits&quot;: {
    &quot;general&quot;: {
      &quot;email&quot;: &quot;test1@gmail.com&quot;,
      &quot;emailVerified&quot;: true,
      &quot;firstName&quot;: &quot;T&quot;,
      &quot;lastName&quot;: &quot;D&quot;,
      &quot;phoneNumber&quot;: &quot;7755221144&quot;,
      &quot;phoneVerified&quot;: true
    }
  },
  &quot;userType&quot;: &quot;customer&quot;
}
@endjson
</code></pre></div>
<h3 id="build-design-allfunds-dictionary-collections-dictionary">dictionary<a class="headerlink" href="#build-design-allfunds-dictionary-collections-dictionary" title="Permanent link">#</a></h3>
<table>
<thead>
<tr>
<th>field</th>
<th>description</th>
<th>characteristics</th>
<th>is enum</th>
<th>example</th>
</tr>
</thead>
<tbody>
<tr>
<td>_id</td>
<td>the identifier of the user</td>
<td>ObjectID</td>
<td>no</td>
<td>QC7G-Q47E-EFWU</td>
</tr>
<tr>
<td>audit</td>
<td>Audit fields</td>
<td>Object</td>
<td>no</td>
<td>holding object</td>
</tr>
<tr>
<td>audit.createdAt</td>
<td>when was this document created</td>
<td>Object</td>
<td>no</td>
<td>Object</td>
</tr>
<tr>
<td>audit.lastUpdated</td>
<td>when was this document last updated</td>
<td>Object</td>
<td>no</td>
<td>Object</td>
</tr>
<tr>
<td>credentials</td>
<td>credentials of users</td>
<td>Object</td>
<td>no</td>
<td>Object</td>
</tr>
<tr>
<td>credentials.mpin</td>
<td>mpin of users</td>
<td>Object</td>
<td>no</td>
<td>Object</td>
</tr>
<tr>
<td>credentials.mpin.method</td>
<td>encryption method</td>
<td>String</td>
<td>no</td>
<td>bcrypt</td>
</tr>
<tr>
<td>credentials.mpin.value</td>
<td>encrypted mpin value</td>
<td>String</td>
<td>no</td>
<td>$2a$10$sqJLF2wG48NuD228YDXKseLRvpziPFXNsQsoMkAFXKdaqm9HADCVG</td>
</tr>
<tr>
<td>credentials.password</td>
<td>stored password</td>
<td>Object</td>
<td>no</td>
<td>Object</td>
</tr>
<tr>
<td>credentials.password.method</td>
<td>encryption method</td>
<td>String</td>
<td>no</td>
<td>bcrypt</td>
</tr>
<tr>
<td>credentials.password.value</td>
<td>encrypted password value</td>
<td>String</td>
<td>no</td>
<td>$2a$10$Kwgj.LKGzXl7hIa8nYK/2.6SOK3u3uAfAFYnNr1UET1XXOLjc/kA6</td>
</tr>
<tr>
<td>lastEvent</td>
<td>when last even occur</td>
<td>Object</td>
<td>no</td>
<td>Object</td>
</tr>
<tr>
<td>lastEvent.createDate</td>
<td>when user created</td>
<td>Date</td>
<td>no</td>
<td>2023-12-05T09:58:12.645Z</td>
</tr>
<tr>
<td>lastEvent.eventType</td>
<td>what is last event</td>
<td>String</td>
<td>no</td>
<td>USER_LOGIN_FAILURE</td>
</tr>
<tr>
<td>lastEvent.payload</td>
<td>what was the payload</td>
<td>String</td>
<td>no</td>
<td>"{\"userId\":\"ZVX1Z12L\",\"emailId\":\"test1@gmail.com\",\"userAgent\":null,\"deviceId\":\"goldfish_x86_64\",\"ipAddress\":null,\"os\":null}"</td>
</tr>
<tr>
<td>lastEvent.routingKey</td>
<td>routing key for messaging</td>
<td>String</td>
<td>no</td>
<td>user.login-failure</td>
</tr>
<tr>
<td>realm</td>
<td>realm of user</td>
<td>String</td>
<td>no</td>
<td>"internal"</td>
</tr>
<tr>
<td>schemaVer</td>
<td>schema version of collection</td>
<td>Int32</td>
<td>no</td>
<td>0</td>
</tr>
<tr>
<td>traits</td>
<td>user traits</td>
<td>Object</td>
<td>no</td>
<td>Object</td>
</tr>
<tr>
<td>traits.general</td>
<td>general traits</td>
<td>Object</td>
<td>no</td>
<td>Object</td>
</tr>
<tr>
<td>traits.general.email</td>
<td>email of user</td>
<td>String</td>
<td>no</td>
<td>test1@gmail.com</td>
</tr>
<tr>
<td>traits.general.emailVerified</td>
<td>if email verified</td>
<td>boolean</td>
<td>no</td>
<td>true</td>
</tr>
<tr>
<td>traits.general.firstName</td>
<td>first name of user</td>
<td>String</td>
<td>no</td>
<td>Haris</td>
</tr>
<tr>
<td>traits.general.lastName</td>
<td>last name of user</td>
<td>String</td>
<td>no</td>
<td>Faiz</td>
</tr>
<tr>
<td>traits.general.phoneNumber</td>
<td>phone number</td>
<td>String</td>
<td>no</td>
<td>7755221144</td>
</tr>
<tr>
<td>traits.general.phoneVerified</td>
<td>if phone verified</td>
<td>boolean</td>
<td>no</td>
<td>true</td>
</tr>
<tr>
<td>traits.general.address</td>
<td>user address</td>
<td>Object</td>
<td>no</td>
<td>Object</td>
</tr>
<tr>
<td>traits.general.address.addressLine1</td>
<td>address line 1</td>
<td>String</td>
<td>no</td>
<td>Gachibowli</td>
</tr>
<tr>
<td>traits.general.address.addressLine2</td>
<td>address line 2</td>
<td>String</td>
<td>no</td>
<td>String</td>
</tr>
<tr>
<td>traits.general.address.city</td>
<td>city</td>
<td>String</td>
<td>no</td>
<td>Hyderabad</td>
</tr>
<tr>
<td>traits.general.address.state</td>
<td>state</td>
<td>String</td>
<td>no</td>
<td>Telangana</td>
</tr>
<tr>
<td>traits.general.address.pinCode</td>
<td>pin code</td>
<td>String</td>
<td>no</td>
<td>500001</td>
</tr>
<tr>
<td>traits.general.address.country</td>
<td>country</td>
<td>String</td>
<td>no</td>
<td>India</td>
</tr>
<tr>
<td>traits.general.dateOfBirth</td>
<td>date of birth</td>
<td>Date</td>
<td>no</td>
<td>2002-12-05</td>
</tr>
<tr>
<td>traits.customer</td>
<td>customer traits</td>
<td>Object</td>
<td>no</td>
<td>Object</td>
</tr>
<tr>
<td>traits.customer.pan</td>
<td>pan</td>
<td>String</td>
<td>no</td>
<td>ACMP9837D</td>
</tr>
<tr>
<td>traits.customer.membershipPlan</td>
<td>membership plan</td>
<td>String</td>
<td>no</td>
<td>GOLD</td>
</tr>
<tr>
<td>traits.customer.kyc</td>
<td>kyc</td>
<td>Object</td>
<td>no</td>
<td>Object</td>
</tr>
<tr>
<td>traits.customer.kyc.status</td>
<td>kyc status</td>
<td>String</td>
<td>no</td>
<td>String</td>
</tr>
<tr>
<td>traits.customer.kyc.statusCode</td>
<td>status code</td>
<td>String</td>
<td>no</td>
<td>String</td>
</tr>
<tr>
<td>traits.customer.kyc.lastVerified</td>
<td>last verified</td>
<td>long</td>
<td>no</td>
<td>2023-12-05</td>
</tr>
<tr>
<td>traits.customer.kyc.claims</td>
<td>kyc claims</td>
<td>Object</td>
<td>no</td>
<td>Object</td>
</tr>
<tr>
<td>auth</td>
<td>auth info</td>
<td>Object</td>
<td>no</td>
<td>Object</td>
</tr>
<tr>
<td>auth.status</td>
<td>auth status</td>
<td>String</td>
<td>no</td>
<td>String</td>
</tr>
<tr>
<td>auth.lastLoginAt</td>
<td>last login</td>
<td>long</td>
<td>no</td>
<td>long</td>
</tr>
<tr>
<td>auth.failedLogins</td>
<td>failed logins</td>
<td>int</td>
<td>no</td>
<td>2</td>
</tr>
</tbody>
</table>
<h2 id="build-design-allfunds-dictionary-collections-verification">verification<a class="headerlink" href="#build-design-allfunds-dictionary-collections-verification" title="Permanent link">#</a></h2>
<p>verification collection stores verification related all aspects while user creation and verification.</p>
<h3 id="build-design-allfunds-dictionary-collections-example_1">example<a class="headerlink" href="#build-design-allfunds-dictionary-collections-example_1" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;656ef6f5e04a1c5726d26c63&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;createdDate&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-12-05T10:09:57.382Z&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;email&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test11@gmail.com&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;emailOTP&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;9767&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;emailOTPExpriedDate&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-12-05T10:10:57.382Z&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;emailVerified&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;firstName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Test&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;lastName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;User&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;phone&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;9876547896&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;phoneOTP&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2910&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;phoneOTPExpriedDate&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-12-05T10:11:12.315Z&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;phoneVerified&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;lastEvent&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;createDate&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-11-15T13:48:06.649Z&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;eventType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;USER_EMAIL_VERIFICATION_INITIATED&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;payload&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{\&quot;emailId\&quot;:\&quot;testuser.12334@gmail.com\&quot;,\&quot;otp\&quot;:\&quot;2358\&quot;,\&quot;createDate\&quot;:\&quot;2023-11-15T13:48:06.645+00:00\&quot;,\&quot;expiredDate\&quot;:\&quot;2023-11-15T13:49:06.645+00:00\&quot;}&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;routingKey&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;user.email-verification-initiated&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="build-design-allfunds-dictionary-collections-visual_1">visual<a class="headerlink" href="#build-design-allfunds-dictionary-collections-visual_1" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code>@startjson
{
  &quot;_id&quot;: &quot;656ef6f5e04a1c5726d26c63&quot;,
  &quot;createdDate&quot;: &quot;2023-12-05T10:09:57.382Z&quot;,
  &quot;email&quot;: &quot;test11@gmail.com&quot;,
  &quot;emailOTP&quot;: &quot;9767&quot;,
  &quot;emailOTPExpriedDate&quot;: &quot;2023-12-05T10:10:57.382Z&quot;,
  &quot;emailVerified&quot;: true,
  &quot;firstName&quot;: &quot;Test&quot;,
  &quot;lastName&quot;: &quot;User&quot;,
  &quot;phone&quot;: &quot;9876547896&quot;,
  &quot;phoneOTP&quot;: &quot;2910&quot;,
  &quot;phoneOTPExpriedDate&quot;: &quot;2023-12-05T10:11:12.315Z&quot;,
  &quot;phoneVerified&quot;: true,
  &quot;lastEvent&quot;: {
    &quot;createDate&quot;: &quot;2023-11-15T13:48:06.649Z&quot;,
    &quot;eventType&quot;: &quot;USER_EMAIL_VERIFICATION_INITIATED&quot;,
    &quot;payload&quot;: &quot;{\&quot;emailId\&quot;:\&quot;testuser.12334@gmail.com\&quot;,\&quot;otp\&quot;:\&quot;2358\&quot;,\&quot;createDate\&quot;:\&quot;2023-11-15T13:48:06.645+00:00\&quot;,\&quot;expiredDate\&quot;:\&quot;2023-11-15T13:49:06.645+00:00\&quot;}&quot;,
    &quot;routingKey&quot;: &quot;user.email-verification-initiated&quot;
  }
}
@endjson
</code></pre></div>
<h3 id="build-design-allfunds-dictionary-collections-dictionary_1">dictionary<a class="headerlink" href="#build-design-allfunds-dictionary-collections-dictionary_1" title="Permanent link">#</a></h3>
<table>
<thead>
<tr>
<th>field</th>
<th>description</th>
<th>characteristics</th>
<th>is enum</th>
<th>example</th>
</tr>
</thead>
<tbody>
<tr>
<td>_id</td>
<td>object id</td>
<td>ObjectId</td>
<td>no</td>
<td>6554cc16ce74ee253e46db44</td>
</tr>
<tr>
<td>firstName</td>
<td>First Name</td>
<td>String</td>
<td>no</td>
<td>Test</td>
</tr>
<tr>
<td>lastName</td>
<td>Last Name</td>
<td>String</td>
<td>no</td>
<td>User</td>
</tr>
<tr>
<td>email</td>
<td>email</td>
<td>String</td>
<td>no</td>
<td>test@gmail.com</td>
</tr>
<tr>
<td>emailOTP</td>
<td>otp</td>
<td>String</td>
<td>no</td>
<td>9767</td>
</tr>
<tr>
<td>isEmailVerified</td>
<td>if email verified</td>
<td>boolean</td>
<td>no</td>
<td>true</td>
</tr>
<tr>
<td>emailOTPExpriedDate</td>
<td>otp expire date</td>
<td>Date</td>
<td>no</td>
<td>"2023-12-05T10:10:57.382Z"</td>
</tr>
<tr>
<td>phone</td>
<td>phone number</td>
<td>String</td>
<td>no</td>
<td>9876007896</td>
</tr>
<tr>
<td>phoneOTP</td>
<td>otp</td>
<td>String</td>
<td>no</td>
<td>2910</td>
</tr>
<tr>
<td>isPhoneVerified</td>
<td>if phone number verified</td>
<td>boolean</td>
<td>no</td>
<td>true</td>
</tr>
<tr>
<td>phoneOTPExpriedDate</td>
<td>otp expire date</td>
<td>Date</td>
<td>no</td>
<td>2023-12-05T10:11:12.315Z</td>
</tr>
<tr>
<td>createdDate</td>
<td>created date</td>
<td>Date</td>
<td>no</td>
<td>2023-12-05T10:09:57.382Z</td>
</tr>
<tr>
<td>lastEvent</td>
<td>last event</td>
<td>Object</td>
<td>no</td>
<td>Object</td>
</tr>
<tr>
<td>lastEvent.createdDate</td>
<td>created date</td>
<td>Date</td>
<td>no</td>
<td>2023-11-15T13:48:06.649Z</td>
</tr>
<tr>
<td>lastEvent.eventType</td>
<td>event type</td>
<td><a href="https://gitlabnew.techwave.net/fintrust/af-commons/-/blob/main/src/main/java/com/fintrust/allfunds/commons/enums/EventType.java">EventType</a></td>
<td>yes</td>
<td>USER_EMAIL_VERIFICATION_INITIATED</td>
</tr>
<tr>
<td>lastEvent.payLoad</td>
<td>payload</td>
<td>String</td>
<td>no</td>
<td>"{\"emailId\":\"testuser.12334@gmail.com\",\"otp\":\"2358\",\"createDate\":\"2023-11-15T13:48:06.645+00:00\",\"expiredDate\":\"2023-11-15T13:49:06.645+00:00\"}"</td>
</tr>
<tr>
<td>lastEvent.routingKey</td>
<td>routing key</td>
<td>String</td>
<td>no</td>
<td>user.email-verification-initiated</td>
</tr>
</tbody>
</table>
<h2 id="build-design-allfunds-dictionary-collections-scratchpad">scratchpad<a class="headerlink" href="#build-design-allfunds-dictionary-collections-scratchpad" title="Permanent link">#</a></h2>
<p>scratchpad collection is used to store Items in cart, wishlist and compare.</p>
<h3 id="build-design-allfunds-dictionary-collections-example_2">example<a class="headerlink" href="#build-design-allfunds-dictionary-collections-example_2" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;52CF06LF&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;cartItems&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;assetCategory&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MIDCAP&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;assetClass&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;EQUITY&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;isin&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;INF336L01PB2&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;HSBC Focused Fund - Direct Growth&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;oneTimeOrSIP&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;amount&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5000</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;investmentType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ONETIME&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;oneTimeTenureInMonths&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;sipDayOfMonth&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;sipInterval&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;sipIsPerpetual&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;portfolioId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;02&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;assetCategory&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MIDCAP&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;assetClass&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;EQUITY&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;isin&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;INF680P01109&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Shriram Flexi Cap Fund - Direct Growth&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;oneTimeOrSIP&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;amount&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5000</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;investmentType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ONETIME&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;oneTimeTenureInMonths&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;sipDayOfMonth&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;sipInterval&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;sipIsPerpetual&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;portfolioId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;01&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;assetCategory&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MIDCAP&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;assetClass&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;EQUITY&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;isin&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;INF204K01G52&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Nippon India Consumption Fund - Direct Plan Growth Plan - Growth Option&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;oneTimeOrSIP&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;amount&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5000</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;investmentType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ONETIME&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;oneTimeTenureInMonths&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;sipDayOfMonth&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;sipInterval&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;sipIsPerpetual&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;portfolioId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;01&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;assetCategory&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MIDCAP&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;assetClass&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;EQUITY&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;isin&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;INF760K01DU1&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CANARA ROBECO CONSUMER TRENDS FUND - DIRECT PLAN - GROWTH OPTION&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;oneTimeOrSIP&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;amount&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2000</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;investmentType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SIP&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;oneTimeTenureInMonths&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;sipDayOfMonth&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;sipEndDate&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-05-01T00:00:00.000Z&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;sipInterval&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MONTHLY&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;sipIsPerpetual&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;sipStartDate&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-12-01T00:00:00.000Z&quot;</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;portfolioId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;01&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;compareItems&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span>
<span class="w">  </span><span class="nt">&quot;uccCode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;52CF06LF&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;wishlistItems&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;assetCategory&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MIDCAP&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;assetClass&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;EQUITY&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;isin&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;INF760K01JC6&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CANARA ROBECO SMALL CAP FUND - DIRECT PLAN - GROWTH OPTION&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;assetCategory&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MIDCAP&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;assetClass&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;EQUITY&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;isin&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;INF879O01100&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Parag Parikh Tax Saver Fund- Direct Growth&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;assetCategory&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Flexi Cap&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;isin&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;INF680P01109&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Shriram Flexi Cap Fund - Direct Growth&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;assetCategory&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MIDCAP&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;assetClass&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;EQUITY&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;isin&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;INF336L01NV5&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;HSBC Large &amp; Mid Cap Fund - Direct Growth&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="build-design-allfunds-dictionary-collections-visual_2">visual<a class="headerlink" href="#build-design-allfunds-dictionary-collections-visual_2" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code>@startjson
{
  &quot;_id&quot;: &quot;52CF06LF&quot;,
  &quot;cartItems&quot;: [
    {
      &quot;assetCategory&quot;: &quot;MIDCAP&quot;,
      &quot;assetClass&quot;: &quot;EQUITY&quot;,
      &quot;isin&quot;: &quot;INF336L01PB2&quot;,
      &quot;name&quot;: &quot;HSBC Focused Fund - Direct Growth&quot;,
      &quot;oneTimeOrSIP&quot;: {
        &quot;amount&quot;: 5000,
        &quot;investmentType&quot;: &quot;ONETIME&quot;,
        &quot;oneTimeTenureInMonths&quot;: 0,
        &quot;sipDayOfMonth&quot;: 0,
        &quot;sipInterval&quot;: &quot;&quot;,
        &quot;sipIsPerpetual&quot;: true
      },
      &quot;portfolioId&quot;: &quot;02&quot;
    },
    {
      &quot;assetCategory&quot;: &quot;MIDCAP&quot;,
      &quot;assetClass&quot;: &quot;EQUITY&quot;,
      &quot;isin&quot;: &quot;INF680P01109&quot;,
      &quot;name&quot;: &quot;Shriram Flexi Cap Fund - Direct Growth&quot;,
      &quot;oneTimeOrSIP&quot;: {
        &quot;amount&quot;: 5000,
        &quot;investmentType&quot;: &quot;ONETIME&quot;,
        &quot;oneTimeTenureInMonths&quot;: 0,
        &quot;sipDayOfMonth&quot;: 0,
        &quot;sipInterval&quot;: &quot;&quot;,
        &quot;sipIsPerpetual&quot;: true
      },
      &quot;portfolioId&quot;: &quot;01&quot;
    },
    {
      &quot;assetCategory&quot;: &quot;MIDCAP&quot;,
      &quot;assetClass&quot;: &quot;EQUITY&quot;,
      &quot;isin&quot;: &quot;INF204K01G52&quot;,
      &quot;name&quot;: &quot;Nippon India Consumption Fund - Direct Plan Growth Plan - Growth Option&quot;,
      &quot;oneTimeOrSIP&quot;: {
        &quot;amount&quot;: 5000,
        &quot;investmentType&quot;: &quot;ONETIME&quot;,
        &quot;oneTimeTenureInMonths&quot;: 0,
        &quot;sipDayOfMonth&quot;: 0,
        &quot;sipInterval&quot;: &quot;&quot;,
        &quot;sipIsPerpetual&quot;: true
      },
      &quot;portfolioId&quot;: &quot;01&quot;
    },
    {
      &quot;assetCategory&quot;: &quot;MIDCAP&quot;,
      &quot;assetClass&quot;: &quot;EQUITY&quot;,
      &quot;isin&quot;: &quot;INF760K01DU1&quot;,
      &quot;name&quot;: &quot;CANARA ROBECO CONSUMER TRENDS FUND - DIRECT PLAN - GROWTH OPTION&quot;,
      &quot;oneTimeOrSIP&quot;: {
        &quot;amount&quot;: 2000,
        &quot;investmentType&quot;: &quot;SIP&quot;,
        &quot;oneTimeTenureInMonths&quot;: 0,
        &quot;sipDayOfMonth&quot;: 1,
        &quot;sipEndDate&quot;: &quot;2024-05-01T00:00:00.000Z&quot;,
        &quot;sipInterval&quot;: &quot;MONTHLY&quot;,
        &quot;sipIsPerpetual&quot;: true,
        &quot;sipStartDate&quot;: &quot;2023-12-01T00:00:00.000Z&quot;
      },
      &quot;portfolioId&quot;: &quot;01&quot;
    }
  ],
  &quot;compareItems&quot;: [],
  &quot;uccCode&quot;: &quot;52CF06LF&quot;,
  &quot;wishlistItems&quot;: [
    {
      &quot;assetCategory&quot;: &quot;MIDCAP&quot;,
      &quot;assetClass&quot;: &quot;EQUITY&quot;,
      &quot;isin&quot;: &quot;INF760K01JC6&quot;,
      &quot;name&quot;: &quot;CANARA ROBECO SMALL CAP FUND - DIRECT PLAN - GROWTH OPTION&quot;
    },
    {
      &quot;assetCategory&quot;: &quot;MIDCAP&quot;,
      &quot;assetClass&quot;: &quot;EQUITY&quot;,
      &quot;isin&quot;: &quot;INF879O01100&quot;,
      &quot;name&quot;: &quot;Parag Parikh Tax Saver Fund- Direct Growth&quot;
    },
    {
      &quot;assetCategory&quot;: &quot;Flexi Cap&quot;,
      &quot;isin&quot;: &quot;INF680P01109&quot;,
      &quot;name&quot;: &quot;Shriram Flexi Cap Fund - Direct Growth&quot;
    },
    {
      &quot;assetCategory&quot;: &quot;MIDCAP&quot;,
      &quot;assetClass&quot;: &quot;EQUITY&quot;,
      &quot;isin&quot;: &quot;INF336L01NV5&quot;,
      &quot;name&quot;: &quot;HSBC Large &amp; Mid Cap Fund - Direct Growth&quot;
    }
  ]
}
@endjson
</code></pre></div>
<h3 id="build-design-allfunds-dictionary-collections-dictionary_2">dictionary<a class="headerlink" href="#build-design-allfunds-dictionary-collections-dictionary_2" title="Permanent link">#</a></h3>
<table>
<thead>
<tr>
<th>field</th>
<th>description</th>
<th>characteristics</th>
<th>is enum</th>
<th>example</th>
</tr>
</thead>
<tbody>
<tr>
<td>_id</td>
<td>identifier</td>
<td>String</td>
<td>no</td>
<td>52CF06LF</td>
</tr>
<tr>
<td>uccCode</td>
<td>user identity</td>
<td>String</td>
<td>no</td>
<td>52CF06LF</td>
</tr>
<tr>
<td>wishlistItems</td>
<td>wishlist items</td>
<td>Array</td>
<td>no</td>
<td>Array of Objects</td>
</tr>
<tr>
<td>wishlistItems.isin</td>
<td>fund isin</td>
<td>String</td>
<td>no</td>
<td>INF760K01DU1</td>
</tr>
<tr>
<td>wishlistItems.name</td>
<td>fund name</td>
<td>String</td>
<td>no</td>
<td>Parag Parikh Tax Saver Fund- Direct Growth</td>
</tr>
<tr>
<td>wishlistItems.assetClass</td>
<td>asset class</td>
<td><a href="https://gitlabnew.techwave.net/fintrust/af-commons/-/blob/main/src/main/java/com/fintrust/allfunds/commons/enums/AssetClassType.java">AssetClassType</a></td>
<td>yes</td>
<td>EQUITY</td>
</tr>
<tr>
<td>wishlistItems.assetCategory</td>
<td>asset category</td>
<td>String</td>
<td>no</td>
<td>MIDCAP</td>
</tr>
<tr>
<td>compareItems</td>
<td>compare items</td>
<td>Array</td>
<td>no</td>
<td>Array of Objects</td>
</tr>
<tr>
<td>compareItems.isin</td>
<td>fund isin</td>
<td>String</td>
<td>no</td>
<td>INF879O01100</td>
</tr>
<tr>
<td>compareItems.assetClass</td>
<td>asset class</td>
<td><a href="https://gitlabnew.techwave.net/fintrust/af-commons/-/blob/main/src/main/java/com/fintrust/allfunds/commons/enums/AssetClassType.java">AssetClassType</a></td>
<td>yes</td>
<td>EQUITY</td>
</tr>
<tr>
<td>cartItems</td>
<td>cart items</td>
<td>Array</td>
<td>no</td>
<td>Array of Objects</td>
</tr>
<tr>
<td>cartItems.isin</td>
<td>fund isin</td>
<td>String</td>
<td>no</td>
<td>INF336L01NV5</td>
</tr>
<tr>
<td>cartItems.name</td>
<td>fund name</td>
<td>String</td>
<td>no</td>
<td>HSBC Focused Fund - Direct Growth</td>
</tr>
<tr>
<td>cartItems.assetClass</td>
<td>asset class</td>
<td><a href="https://gitlabnew.techwave.net/fintrust/af-commons/-/blob/main/src/main/java/com/fintrust/allfunds/commons/enums/AssetClassType.java">AssetClassType</a></td>
<td>yes</td>
<td>EQUITY</td>
</tr>
<tr>
<td>cartItems.assetCategory</td>
<td>asset category</td>
<td>String</td>
<td>no</td>
<td>MIDCAP</td>
</tr>
<tr>
<td>cartItems.oneTimeOrSIP</td>
<td>purchase or sip or swp or stp or switch or redeem</td>
<td>Object</td>
<td>no</td>
<td>Object</td>
</tr>
<tr>
<td>cartItems.oneTimeOrSIP.oneTimeTenureInMonths</td>
<td>tenure in month</td>
<td>int32</td>
<td>no</td>
<td>12</td>
</tr>
<tr>
<td>cartItems.oneTimeOrSIP.sipDayOfMonth</td>
<td>day of the month</td>
<td>int32</td>
<td>no</td>
<td>1</td>
</tr>
<tr>
<td>cartItems.oneTimeOrSIP.amount</td>
<td>amount</td>
<td>Double</td>
<td>no</td>
<td>5000</td>
</tr>
<tr>
<td>cartItems.oneTimeOrSIP.investmentType</td>
<td>investment type</td>
<td>String</td>
<td>no</td>
<td>BUY</td>
</tr>
<tr>
<td>cartItems.oneTimeOrSIP.sipStartDate</td>
<td>SIP start date</td>
<td>Date</td>
<td>no</td>
<td>2023-12-01T00:00:00.000Z</td>
</tr>
<tr>
<td>cartItems.oneTimeOrSIP.sipEndDate</td>
<td>SIP end date</td>
<td>Date</td>
<td>no</td>
<td>2024-05-01T00:00:00.000Z</td>
</tr>
<tr>
<td>cartItems.oneTimeOrSIP.sipInterval</td>
<td>SIP interval</td>
<td>String</td>
<td>no</td>
<td>MONTHLY</td>
</tr>
<tr>
<td>cartItems.oneTimeOrSIP.sipIsPerpetual</td>
<td>if SIP perpetual</td>
<td>boolean</td>
<td>no</td>
<td>true</td>
</tr>
<tr>
<td>cartItems.oneTimeOrSIP.transferTo</td>
<td>target fund</td>
<td>String</td>
<td>no</td>
<td>INF760K01DU1</td>
</tr>
<tr>
<td>cartItems.oneTimeOrSIP.redeemOrSwitchOption</td>
<td>redeem option</td>
<td>String</td>
<td>no</td>
<td>E - All Units, A - Specific Amount, U - Specific Units</td>
</tr>
<tr>
<td>cartItems.oneTimeOrSIP.redeemOrSwitchUnits</td>
<td>number of units</td>
<td>String</td>
<td>no</td>
<td>5</td>
</tr>
<tr>
<td>cartItems.oneTimeOrSIP.redeemOrSwitchAmount</td>
<td>amount</td>
<td>String</td>
<td>no</td>
<td>500</td>
</tr>
<tr>
<td>cartItems.portfolioId</td>
<td>portfolio ID</td>
<td>String</td>
<td>no</td>
<td>02</td>
</tr>
<tr>
<td>cartItems.folioId</td>
<td>folio ID</td>
<td>String</td>
<td>no</td>
<td>ABC</td>
</tr>
<tr>
<td>cartItems.bankAccountNo</td>
<td>back account number</td>
<td>String</td>
<td>no</td>
<td>8762356784763</td>
</tr>
<tr>
<td>cartItems.isFormFilled</td>
<td>if form filled</td>
<td>boolean</td>
<td>no</td>
<td>true</td>
</tr>
<tr>
<td>cartItems.isPayoutChecked</td>
<td>if payout checked</td>
<td>boolean</td>
<td>no</td>
<td>false</td>
</tr>
<tr>
<td>meta</td>
<td>metadata</td>
<td>Object</td>
<td>no</td>
<td>Object</td>
</tr>
<tr>
<td>meta.created</td>
<td>created date</td>
<td>Date</td>
<td>no</td>
<td>2023-12-05T10:11:12.315Z</td>
</tr>
<tr>
<td>meta.lastModified</td>
<td>last modified</td>
<td>Date</td>
<td>no</td>
<td>2023-12-05T10:11:12.315Z</td>
</tr>
<tr>
<td>schemaVer</td>
<td>schema version</td>
<td>String</td>
<td>no</td>
<td>1</td>
</tr>
</tbody>
</table>
<h2 id="build-design-allfunds-dictionary-collections-sfa_token">sfa_token<a class="headerlink" href="#build-design-allfunds-dictionary-collections-sfa_token" title="Permanent link">#</a></h2>
<p>sfa_token collection stores sfa_token, User ID, device ID, fcm token etc.</p>
<h3 id="build-design-allfunds-dictionary-collections-example_3">example<a class="headerlink" href="#build-design-allfunds-dictionary-collections-example_3" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;65b8a2d4b99e8a50536a7121&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;deviceId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;c2749b2874fcefd9&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;expires&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-04-29T07:18:44.327Z&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;fcmToken&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;dwF-1wLtSQewAAHCBQksgc:APA91bEv_xmQwoycrG4V1k3rGm32JrEg0U2fbm2ig5JeRz8gwzErf8RTydC4uNKjgLwWUEs8p0SnDnTc-vid8MrPodfkuonycYKsjK7Rt0gtUTtBy7O7IBUgaPkfkPU178EzklQBfrrA&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;token&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJodHRwczovL2V4YW1wbGUuY29tL21mQXV0aCIsInN1YiI6IlRRQkpYWlU3VlBXSiIsImdyb3VwcyI6WyJTRkEtVVNFUiJdLCJkZXZpY2VJRCI6ImMyNzQ5YjI4NzRmY2VmZDkiLCJpYXQiOjE3MDY1OTkxMjQsImV4cCI6MTcxNDM3NTEyNCwianRpIjoiODg5Mzc1MmEtOTI3Zi00OTg2LThiNmUtZTdhYTNmYWE0ZmEyIn0.M1lfgoqT8T8jvrW3woC7mkZxovZmyBFl9uEQULmu0696p_i8CRoHuzGeFdZn5d3s0n4_BsbDqSIiwhUlR0c8ghW-NldLSLW_geUUc72tl9M1LnWuM81ghgd-786RwemuUuOt7IzZsioziiuvihM7wDnuVK5N_AD2BD0ZHqPD9TukyjLBotGZKS2qoHdkhiqUmZ183_HWwVimZ7aqNK36XSCON17Gbf5typ6QRwbwwcV4kNVPwOR2OX4bhZ2lmQufgE-QOi70FI1P7KA8iEwNtjz3J87sHBXR5XY0u5P9pik0JMEjQCkxpFwTZ_kpkjUpdpaSCmjlWfxeMJarL2FI8A&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;userAgent&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OnePlus OnePlus EB2101&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;userId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;TQBJXZU7VPWJ&quot;</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="build-design-allfunds-dictionary-collections-visual_3">visual<a class="headerlink" href="#build-design-allfunds-dictionary-collections-visual_3" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code>@startjson
{
  &quot;_id&quot;: &quot;65b8a2d4b99e8a50536a7121&quot;,
  &quot;deviceId&quot;: &quot;c2749b2874fcefd9&quot;,
  &quot;expires&quot;: &quot;2024-04-29T07:18:44.327Z&quot;,
  &quot;fcmToken&quot;: &quot;dwF-1wLtSQewAAHCBQksgc:APA91bEv_xmQwoycrG4V1k3rGm32JrEg0U2fbm2ig5JeRz8gwzErf8RTydC4uNKjgLwWUEs8p0SnDnTc-vid8MrPodfkuonycYKsjK7Rt0gtUTtBy7O7IBUgaPkfkPU178EzklQBfrrA&quot;,
  &quot;token&quot;: &quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJodHRwczovL2V4YW1wbGUuY29tL21mQXV0aCIsInN1YiI6IlRRQkpYWlU3VlBXSiIsImdyb3VwcyI6WyJTRkEtVVNFUiJdLCJkZXZpY2VJRCI6ImMyNzQ5YjI4NzRmY2VmZDkiLCJpYXQiOjE3MDY1OTkxMjQsImV4cCI6MTcxNDM3NTEyNCwianRpIjoiODg5Mzc1MmEtOTI3Zi00OTg2LThiNmUtZTdhYTNmYWE0ZmEyIn0.M1lfgoqT8T8jvrW3woC7mkZxovZmyBFl9uEQULmu0696p_i8CRoHuzGeFdZn5d3s0n4_BsbDqSIiwhUlR0c8ghW-NldLSLW_geUUc72tl9M1LnWuM81ghgd-786RwemuUuOt7IzZsioziiuvihM7wDnuVK5N_AD2BD0ZHqPD9TukyjLBotGZKS2qoHdkhiqUmZ183_HWwVimZ7aqNK36XSCON17Gbf5typ6QRwbwwcV4kNVPwOR2OX4bhZ2lmQufgE-QOi70FI1P7KA8iEwNtjz3J87sHBXR5XY0u5P9pik0JMEjQCkxpFwTZ_kpkjUpdpaSCmjlWfxeMJarL2FI8A&quot;,
  &quot;userAgent&quot;: &quot;OnePlus OnePlus EB2101&quot;,
  &quot;userId&quot;: &quot;TQBJXZU7VPWJ&quot;
}
@endjson
</code></pre></div>
<h3 id="build-design-allfunds-dictionary-collections-dictionary_3">dictionary<a class="headerlink" href="#build-design-allfunds-dictionary-collections-dictionary_3" title="Permanent link">#</a></h3>
<table>
<thead>
<tr>
<th>field</th>
<th>description</th>
<th>characteristics</th>
<th>is enum</th>
<th>example</th>
</tr>
</thead>
<tbody>
<tr>
<td>_id</td>
<td>identifier</td>
<td>ObjectId</td>
<td>no</td>
<td>65b8a2d4b99e8a50536a7121</td>
</tr>
<tr>
<td>deviceId</td>
<td>device login id</td>
<td>String</td>
<td>no</td>
<td>c2749b2874fcefd9</td>
</tr>
<tr>
<td>expires</td>
<td>token expire time</td>
<td>Date</td>
<td>no</td>
<td>2024-04-29T07:18:44.327Z</td>
</tr>
<tr>
<td>fcmToken</td>
<td>fire base cloud messaging token</td>
<td>String</td>
<td>no</td>
<td>dwF-1wLtSQewAAHCBQksgc:APA91bEv_xmQwoycrG4V1k3rGm32JrEg0U2fbm2ig5JeRz8gwzErf8RTydC4uNKjgLwWUEs8p0SnDnTc-vid8MrPodfkuonycYKsjK7Rt0gtUTtBy7O7IBUgaPkfkPU178EzklQBfrrA</td>
</tr>
<tr>
<td>token</td>
<td>sfa token</td>
<td>String</td>
<td>no</td>
<td>eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJodHRwczovL2V4YW1wbGUuY29tL21mQXV0aCIsInN1YiI6IlRRQkpYWlU3VlBXSiIsImdyb3VwcyI6WyJTRkEtVVNFUiJdLCJkZXZpY2VJRCI6ImMyNzQ5YjI4NzRmY2VmZDkiLCJpYXQiOjE3MDY1OTkxMjQsImV4cCI6MTcxNDM3NTEyNCwianRpIjoiODg5Mzc1MmEtOTI3Zi00OTg2LThiNmUtZTdhYTNmYWE0ZmEyIn0.M1lfgoqT8T8jvrW3woC7mkZxovZmyBFl9uEQULmu0696p_i8CRoHuzGeFdZn5d3s0n4_BsbDqSIiwhUlR0c8ghW-NldLSLW_geUUc72tl9M1LnWuM81ghgd-786RwemuUuOt7IzZsioziiuvihM7wDnuVK5N_AD2BD0ZHqPD9TukyjLBotGZKS2qoHdkhiqUmZ183_HWwVimZ7aqNK36XSCON17Gbf5typ6QRwbwwcV4kNVPwOR2OX4bhZ2lmQufgE-QOi70FI1P7KA8iEwNtjz3J87sHBXR5XY0u5P9pik0JMEjQCkxpFwTZ_kpkjUpdpaSCmjlWfxeMJarL2FI8A</td>
</tr>
<tr>
<td>userAgent</td>
<td>agent name</td>
<td>String</td>
<td>no</td>
<td>OnePlus OnePlus EB2101</td>
</tr>
<tr>
<td>userId</td>
<td>user Id</td>
<td>String</td>
<td>no</td>
<td>TQBJ-XZU7-VPWJ</td>
</tr>
</tbody>
</table>
<h2 id="build-design-allfunds-dictionary-collections-mfu_profiles">mfu_profiles<a class="headerlink" href="#build-design-allfunds-dictionary-collections-mfu_profiles" title="Permanent link">#</a></h2>
<p>mfu_profiles collection user details against mfu profile.</p>
<h3 id="build-design-allfunds-dictionary-collections-example_4">example<a class="headerlink" href="#build-design-allfunds-dictionary-collections-example_4" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;WGK4DJWN5OW2&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;accounts&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;accountNo&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2213038184&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;accountType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SB&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;bankId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;485&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;bankName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Kotak Mahindra Bank Limited&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;bankSeqNum&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;defaultAccountFlag&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Y&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;ifscCode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;KKBK0007478&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;micrCode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;500485003&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;proofType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LATEST_BANK_ACCOUNT_STATEMENT&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;can&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;31348MJ003&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;canStatus&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;PE&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;documents&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;657ab1c1f953330ef69ae4bc&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;documentType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1#PC&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;eventType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;AD&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;fileName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Screenshot_20231214_125703_AllFunds&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;imageRefNo&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ECA23348BC003&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;657ab37af953330ef69ae4c2&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;documentType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1#PC&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;eventType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;AD&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;fileName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Screenshot_20231214_125703_AllFunds&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;imageRefNo&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ECA23348BC005&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;nominees&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;nomineeDob&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1993-12-15T00:00:00.000Z&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeGuardianDob&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeGuardianName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeGuardianRelation&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Prasad&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeRelation&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Son&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeSeqNum&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;percentage&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;50&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;nomineeDob&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1993-12-15T00:00:00.000Z&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeGuardianDob&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeGuardianName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeGuardianRelation&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Prasad&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeRelation&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Son&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeSeqNum&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;percentage&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;50&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;nomineeDob&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1997-12-15T00:00:00.000Z&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeGuardianDob&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeGuardianName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeGuardianRelation&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Kamal&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeRelation&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Brother&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeSeqNum&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;percentage&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;40&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;nomineeDob&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-12-15T00:00:00.000Z&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeGuardianDob&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2005-12-15&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeGuardianName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;John&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeGuardianRelation&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Uncle&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Lewis&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeRelation&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Monkey&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeSeqNum&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;percentage&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;100&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;nomineeDob&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1996-12-15T00:00:00.000Z&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeGuardianDob&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2005-12-15&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeGuardianName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;John&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeGuardianRelation&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Uncle&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Lewis&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeRelation&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Monkey&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeSeqNum&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;percentage&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;100&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;nomineeDob&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1996-12-15T00:00:00.000Z&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeGuardianDob&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2005-12-15&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeGuardianName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;John&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeGuardianRelation&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Uncle&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Lewis&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeRelation&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Monkey&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeSeqNum&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;percentage&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;100&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;nomineeDob&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2003-12-15T00:00:00.000Z&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeGuardianDob&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeGuardianName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeGuardianRelation&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Lewis&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeRelation&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Donkey&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeSeqNum&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;percentage&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;100&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;nomineeDob&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1986-05-04T00:00:00.000Z&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeGuardianDob&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeGuardianName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeGuardianRelation&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Hurch&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeRelation&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Fried&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeSeqNum&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;percentage&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;100&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;nomineeDob&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1986-05-04T00:00:00.000Z&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeGuardianDob&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeGuardianName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeGuardianRelation&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Hurch&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeRelation&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Fried&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;nomineeSeqNum&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;percentage&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;100&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="build-design-allfunds-dictionary-collections-visual_4">visual<a class="headerlink" href="#build-design-allfunds-dictionary-collections-visual_4" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code>@startjson
{
  &quot;_id&quot;: &quot;WGK4DJWN5OW2&quot;,
  &quot;accounts&quot;: [
    {
      &quot;accountNo&quot;: &quot;2213038184&quot;,
      &quot;accountType&quot;: &quot;SB&quot;,
      &quot;bankId&quot;: &quot;485&quot;,
      &quot;bankName&quot;: &quot;Kotak Mahindra Bank Limited&quot;,
      &quot;bankSeqNum&quot;: 1,
      &quot;defaultAccountFlag&quot;: &quot;Y&quot;,
      &quot;ifscCode&quot;: &quot;KKBK0007478&quot;,
      &quot;micrCode&quot;: &quot;500485003&quot;,
      &quot;proofType&quot;: &quot;LATEST_BANK_ACCOUNT_STATEMENT&quot;
    }
  ],
  &quot;can&quot;: &quot;31348MJ003&quot;,
  &quot;canStatus&quot;: &quot;PE&quot;,
  &quot;documents&quot;: [
    {
      &quot;_id&quot;: &quot;657ab1c1f953330ef69ae4bc&quot;,
      &quot;documentType&quot;: &quot;1#PC&quot;,
      &quot;eventType&quot;: &quot;AD&quot;,
      &quot;fileName&quot;: &quot;Screenshot_20231214_125703_AllFunds&quot;,
      &quot;imageRefNo&quot;: &quot;ECA23348BC003&quot;
    },
    {
      &quot;_id&quot;: &quot;657ab37af953330ef69ae4c2&quot;,
      &quot;documentType&quot;: &quot;1#PC&quot;,
      &quot;eventType&quot;: &quot;AD&quot;,
      &quot;fileName&quot;: &quot;Screenshot_20231214_125703_AllFunds&quot;,
      &quot;imageRefNo&quot;: &quot;ECA23348BC005&quot;
    }
  ],
  &quot;nominees&quot;: [
    {
      &quot;nomineeDob&quot;: &quot;1993-12-15T00:00:00.000Z&quot;,
      &quot;nomineeGuardianDob&quot;: &quot;&quot;,
      &quot;nomineeGuardianName&quot;: &quot;&quot;,
      &quot;nomineeGuardianRelation&quot;: &quot;&quot;,
      &quot;nomineeName&quot;: &quot;Prasad&quot;,
      &quot;nomineeRelation&quot;: &quot;Son&quot;,
      &quot;nomineeSeqNum&quot;: 1,
      &quot;percentage&quot;: &quot;50&quot;
    },
    {
      &quot;nomineeDob&quot;: &quot;1993-12-15T00:00:00.000Z&quot;,
      &quot;nomineeGuardianDob&quot;: &quot;&quot;,
      &quot;nomineeGuardianName&quot;: &quot;&quot;,
      &quot;nomineeGuardianRelation&quot;: &quot;&quot;,
      &quot;nomineeName&quot;: &quot;Prasad&quot;,
      &quot;nomineeRelation&quot;: &quot;Son&quot;,
      &quot;nomineeSeqNum&quot;: 1,
      &quot;percentage&quot;: &quot;50&quot;
    },
    {
      &quot;nomineeDob&quot;: &quot;1997-12-15T00:00:00.000Z&quot;,
      &quot;nomineeGuardianDob&quot;: &quot;&quot;,
      &quot;nomineeGuardianName&quot;: &quot;&quot;,
      &quot;nomineeGuardianRelation&quot;: &quot;&quot;,
      &quot;nomineeName&quot;: &quot;Kamal&quot;,
      &quot;nomineeRelation&quot;: &quot;Brother&quot;,
      &quot;nomineeSeqNum&quot;: 2,
      &quot;percentage&quot;: &quot;40&quot;
    },
    {
      &quot;nomineeDob&quot;: &quot;2023-12-15T00:00:00.000Z&quot;,
      &quot;nomineeGuardianDob&quot;: &quot;2005-12-15&quot;,
      &quot;nomineeGuardianName&quot;: &quot;John&quot;,
      &quot;nomineeGuardianRelation&quot;: &quot;Uncle&quot;,
      &quot;nomineeName&quot;: &quot;Lewis&quot;,
      &quot;nomineeRelation&quot;: &quot;Monkey&quot;,
      &quot;nomineeSeqNum&quot;: 2,
      &quot;percentage&quot;: &quot;100&quot;
    },
    {
      &quot;nomineeDob&quot;: &quot;1996-12-15T00:00:00.000Z&quot;,
      &quot;nomineeGuardianDob&quot;: &quot;2005-12-15&quot;,
      &quot;nomineeGuardianName&quot;: &quot;John&quot;,
      &quot;nomineeGuardianRelation&quot;: &quot;Uncle&quot;,
      &quot;nomineeName&quot;: &quot;Lewis&quot;,
      &quot;nomineeRelation&quot;: &quot;Monkey&quot;,
      &quot;nomineeSeqNum&quot;: 2,
      &quot;percentage&quot;: &quot;100&quot;
    },
    {
      &quot;nomineeDob&quot;: &quot;1996-12-15T00:00:00.000Z&quot;,
      &quot;nomineeGuardianDob&quot;: &quot;2005-12-15&quot;,
      &quot;nomineeGuardianName&quot;: &quot;John&quot;,
      &quot;nomineeGuardianRelation&quot;: &quot;Uncle&quot;,
      &quot;nomineeName&quot;: &quot;Lewis&quot;,
      &quot;nomineeRelation&quot;: &quot;Monkey&quot;,
      &quot;nomineeSeqNum&quot;: 2,
      &quot;percentage&quot;: &quot;100&quot;
    },
    {
      &quot;nomineeDob&quot;: &quot;2003-12-15T00:00:00.000Z&quot;,
      &quot;nomineeGuardianDob&quot;: &quot;&quot;,
      &quot;nomineeGuardianName&quot;: &quot;&quot;,
      &quot;nomineeGuardianRelation&quot;: &quot;&quot;,
      &quot;nomineeName&quot;: &quot;Lewis&quot;,
      &quot;nomineeRelation&quot;: &quot;Donkey&quot;,
      &quot;nomineeSeqNum&quot;: 2,
      &quot;percentage&quot;: &quot;100&quot;
    },
    {
      &quot;nomineeDob&quot;: &quot;1986-05-04T00:00:00.000Z&quot;,
      &quot;nomineeGuardianDob&quot;: &quot;&quot;,
      &quot;nomineeGuardianName&quot;: &quot;&quot;,
      &quot;nomineeGuardianRelation&quot;: &quot;&quot;,
      &quot;nomineeName&quot;: &quot;Hurch&quot;,
      &quot;nomineeRelation&quot;: &quot;Fried&quot;,
      &quot;nomineeSeqNum&quot;: 2,
      &quot;percentage&quot;: &quot;100&quot;
    },
    {
      &quot;nomineeDob&quot;: &quot;1986-05-04T00:00:00.000Z&quot;,
      &quot;nomineeGuardianDob&quot;: &quot;&quot;,
      &quot;nomineeGuardianName&quot;: &quot;&quot;,
      &quot;nomineeGuardianRelation&quot;: &quot;&quot;,
      &quot;nomineeName&quot;: &quot;Hurch&quot;,
      &quot;nomineeRelation&quot;: &quot;Fried&quot;,
      &quot;nomineeSeqNum&quot;: 2,
      &quot;percentage&quot;: &quot;100&quot;
    }
  ]
}
@endjson
</code></pre></div>
<h3 id="build-design-allfunds-dictionary-collections-dictionary_4">dictionary<a class="headerlink" href="#build-design-allfunds-dictionary-collections-dictionary_4" title="Permanent link">#</a></h3>
<table>
<thead>
<tr>
<th>fields</th>
<th>description</th>
<th>characteristics</th>
<th>is enum</th>
<th>example</th>
</tr>
</thead>
<tbody>
<tr>
<td>_id</td>
<td>ucc id as identifier</td>
<td>String</td>
<td>no</td>
<td>WGK4-DJWN-5OW2</td>
</tr>
<tr>
<td>can</td>
<td>can (common account number)</td>
<td>String</td>
<td>no</td>
<td>31348MJ003</td>
</tr>
<tr>
<td>canStatus</td>
<td>status of can</td>
<td>String</td>
<td>no</td>
<td>PE</td>
</tr>
<tr>
<td>nominees</td>
<td>nominees</td>
<td>Object</td>
<td>no</td>
<td>Object</td>
</tr>
<tr>
<td>nominees.nomineeSeqNum</td>
<td>sequence number</td>
<td>int</td>
<td>no</td>
<td>1</td>
</tr>
<tr>
<td>nominees.nomineeName</td>
<td>nominee name</td>
<td>String</td>
<td>no</td>
<td>Prasad</td>
</tr>
<tr>
<td>nominees.nomineeRelation</td>
<td>relation</td>
<td>String</td>
<td>no</td>
<td>Son</td>
</tr>
<tr>
<td>nominees.percentage</td>
<td>percentage</td>
<td>String</td>
<td>no</td>
<td>50</td>
</tr>
<tr>
<td>nominees.nomineeDob</td>
<td>nominee date of birth</td>
<td>Date</td>
<td>no</td>
<td>1993-12-15T00:00:00.000Z</td>
</tr>
<tr>
<td>nominees.nomineeGuardianName</td>
<td>guardian name of nominee</td>
<td>String</td>
<td>no</td>
<td>John</td>
</tr>
<tr>
<td>nominees.nomineeGuardianRelation</td>
<td>relation with guardian</td>
<td>String</td>
<td>no</td>
<td>Uncle</td>
</tr>
<tr>
<td>nominees.nomineeGuardianDob</td>
<td>DOB of guardian of nominee</td>
<td>String</td>
<td>no</td>
<td>2005-12-15</td>
</tr>
<tr>
<td>accounts</td>
<td>account details</td>
<td>Object</td>
<td>no</td>
<td>Object</td>
</tr>
<tr>
<td>accounts.bankSeqNum</td>
<td>sequence number of bank</td>
<td>int</td>
<td>no</td>
<td>1</td>
</tr>
<tr>
<td>accounts.defaultAccountFlag</td>
<td>if default account number</td>
<td>String</td>
<td>no</td>
<td>Y</td>
</tr>
<tr>
<td>accounts.accountNo</td>
<td>account number</td>
<td>String</td>
<td>no</td>
<td>2213038184</td>
</tr>
<tr>
<td>accounts.accountType</td>
<td>account type</td>
<td>String</td>
<td>no</td>
<td>SB</td>
</tr>
<tr>
<td>accounts.bankId</td>
<td>bank Id</td>
<td>String</td>
<td>no</td>
<td>485</td>
</tr>
<tr>
<td>accounts.bankName</td>
<td>bank name</td>
<td>String</td>
<td>no</td>
<td>Kotak Mahindra Bank Limited</td>
</tr>
<tr>
<td>accounts.ifscCode</td>
<td>ifsc code</td>
<td>String</td>
<td>no</td>
<td>KKBK0007478</td>
</tr>
<tr>
<td>accounts.micrCode</td>
<td>micr code</td>
<td>String</td>
<td>no</td>
<td>500485003</td>
</tr>
<tr>
<td>accounts.proofType</td>
<td>bank proof type</td>
<td><a href="https://gitlabnew.techwave.net/fintrust/af-profile/-/blob/main/src/main/java/com/fintrust/allfunds/profile/impl/enums/BankProofType.java">BankProofType</a></td>
<td>yes</td>
<td>LATEST_BANK_ACCOUNT_STATEMENT</td>
</tr>
<tr>
<td>accounts.mandates</td>
<td>mandates</td>
<td>Object</td>
<td>no</td>
<td>Array of Mandates</td>
</tr>
<tr>
<td>accounts.mandates.mmrn</td>
<td>String</td>
<td>String</td>
<td>no</td>
<td>String</td>
</tr>
<tr>
<td>accounts.mandates.mmrnRegStatus</td>
<td>String</td>
<td>String</td>
<td>no</td>
<td>String</td>
</tr>
<tr>
<td>accounts.mandates.mmrnAggrStatus</td>
<td>String</td>
<td>String</td>
<td>no</td>
<td>String</td>
</tr>
<tr>
<td>accounts.mandates.prn</td>
<td>String</td>
<td>String</td>
<td>no</td>
<td>String</td>
</tr>
<tr>
<td>accounts.mandates.stratdate</td>
<td>start date</td>
<td>Date</td>
<td>no</td>
<td>Date</td>
</tr>
<tr>
<td>accounts.mandates.endDate</td>
<td>end date</td>
<td>Date</td>
<td>no</td>
<td>Date</td>
</tr>
<tr>
<td>accounts.mandates.maxAmount</td>
<td>maximum amount</td>
<td>long</td>
<td>no</td>
<td>long</td>
</tr>
<tr>
<td>accounts.mandates.registrationMode</td>
<td>registration mode</td>
<td><a href="https://gitlabnew.techwave.net/fintrust/af-profile/-/blob/main/src/main/java/com/fintrust/allfunds/profile/impl/enums/RegistrationModeType.java">RegistrationModeType</a></td>
<td>yes</td>
<td>PN</td>
</tr>
<tr>
<td>accounts.mandates.termsVersion</td>
<td>terms version</td>
<td>String</td>
<td>no</td>
<td>String</td>
</tr>
<tr>
<td>accounts.mandates.termsAgreed</td>
<td>if user agreed terms</td>
<td>boolean</td>
<td>no</td>
<td>true</td>
</tr>
<tr>
<td>accounts.mandates.termsAgreedDate</td>
<td>date of agreed terms</td>
<td>Date</td>
<td>no</td>
<td>Date</td>
</tr>
<tr>
<td>documents</td>
<td>document of proof</td>
<td>Object</td>
<td>no</td>
<td>Object</td>
</tr>
<tr>
<td>documents.id</td>
<td>identifier</td>
<td>Object Id</td>
<td>no</td>
<td>Object Id</td>
</tr>
<tr>
<td>documents.imageRefNo</td>
<td>image reference number</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>documents.fileName</td>
<td>name of file</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>documents.eventType</td>
<td>event type</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>documents.documentType</td>
<td>document type</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
</tbody>
</table>
<h2 id="build-design-allfunds-dictionary-collections-mfu_requests">mfu_requests<a class="headerlink" href="#build-design-allfunds-dictionary-collections-mfu_requests" title="Permanent link">#</a></h2>
<p>mfu_requests collection stores payload details for mfu response.</p>
<h3 id="build-design-allfunds-dictionary-collections-example_5">example<a class="headerlink" href="#build-design-allfunds-dictionary-collections-example_5" title="Permanent link">#</a></h3>
<p>to be given</p>
<h3 id="build-design-allfunds-dictionary-collections-visual_5">visual<a class="headerlink" href="#build-design-allfunds-dictionary-collections-visual_5" title="Permanent link">#</a></h3>
<p>to be given</p>
<h3 id="build-design-allfunds-dictionary-collections-dictionary_5">dictionary<a class="headerlink" href="#build-design-allfunds-dictionary-collections-dictionary_5" title="Permanent link">#</a></h3>
<table>
<thead>
<tr>
<th>field</th>
<th>description</th>
<th>characteristics</th>
<th>is enum</th>
<th>example</th>
</tr>
</thead>
<tbody>
<tr>
<td>_id</td>
<td>identifier</td>
<td>ObjectId</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>orderId</td>
<td>order id</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>request</td>
<td>request</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>mfuResponse</td>
<td>mfu response</td>
<td>Object</td>
<td>no</td>
<td>Object</td>
</tr>
<tr>
<td>mfuResponse.statusCode</td>
<td>status code</td>
<td>int</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>mfuResponse.statusText</td>
<td>status text</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>mfuResponse.responseBody</td>
<td>response body</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>sentAt</td>
<td>request sent date and time</td>
<td>long</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>receivedAt</td>
<td>response revived date and time</td>
<td>Date</td>
<td>no</td>
<td>to be given</td>
</tr>
</tbody>
</table>
<h2 id="build-design-allfunds-dictionary-collections-mfu_nct">mfu_nct<a class="headerlink" href="#build-design-allfunds-dictionary-collections-mfu_nct" title="Permanent link">#</a></h2>
<p>mfu_nct collection stores details of non commercial transaction.</p>
<h3 id="build-design-allfunds-dictionary-collections-example_6">example<a class="headerlink" href="#build-design-allfunds-dictionary-collections-example_6" title="Permanent link">#</a></h3>
<p>to be given</p>
<h3 id="build-design-allfunds-dictionary-collections-visual_6">visual<a class="headerlink" href="#build-design-allfunds-dictionary-collections-visual_6" title="Permanent link">#</a></h3>
<p>to be given</p>
<h3 id="build-design-allfunds-dictionary-collections-dictionary_6">dictionary<a class="headerlink" href="#build-design-allfunds-dictionary-collections-dictionary_6" title="Permanent link">#</a></h3>
<table>
<thead>
<tr>
<th>fields</th>
<th>description</th>
<th>characteristics</th>
<th>is enum</th>
<th>example</th>
</tr>
</thead>
<tbody>
<tr>
<td>_id</td>
<td>identifier</td>
<td>Object Id</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>ucc</td>
<td>unique customer code</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>changeType</td>
<td>change tye</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>operation</td>
<td>operation</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>sentAt</td>
<td>request date and time</td>
<td>Date</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>responserecievedAt</td>
<td>response date and time</td>
<td>Date</td>
<td>not</td>
<td>to be given</td>
</tr>
<tr>
<td>status</td>
<td>status</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>mfuStatus</td>
<td>mfu status</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>uniqueId</td>
<td>unique Id</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>nctRefNo</td>
<td>nct reference number</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>bankDetails</td>
<td>bank details</td>
<td>Object</td>
<td>no</td>
<td>Object</td>
</tr>
<tr>
<td>bankDetails.bankSeqNum</td>
<td>bank sequence number</td>
<td>int</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>bankDetails.defaultAccountFlag</td>
<td>if default account selected</td>
<td>boolean</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>bankDetails.accountNo</td>
<td>account number</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>bankDetails.accountType</td>
<td>account type</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>bankDetails.bankId</td>
<td>bank Id</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>bankDetails.bankName</td>
<td>bank name</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>bankDetails.ifscCode</td>
<td>ifsc code</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>bankDetails.micrCode</td>
<td>micr code</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>bankDetails.proofType</td>
<td>proof type</td>
<td><a href="https://gitlabnew.techwave.net/fintrust/af-profile/-/blob/main/src/main/java/com/fintrust/allfunds/profile/impl/enums/BankProofType.java">BankProofType</a></td>
<td>yes</td>
<td>to be given</td>
</tr>
<tr>
<td>bankDetails.bankEventType</td>
<td>bank event type</td>
<td><a href="https://gitlabnew.techwave.net/fintrust/af-profile/-/blob/main/src/main/java/com/fintrust/allfunds/profile/impl/enums/BankEventType.java">BankEventType</a></td>
<td>yes</td>
<td>to be given</td>
</tr>
</tbody>
</table>
<h2 id="build-design-allfunds-dictionary-collections-orders">orders<a class="headerlink" href="#build-design-allfunds-dictionary-collections-orders" title="Permanent link">#</a></h2>
<p>orders collection stores all aspect of transaction apis of order like Purchase, SWP, STP, SWP, Redeem and Switch.</p>
<h3 id="build-design-allfunds-dictionary-collections-example_7">example<a class="headerlink" href="#build-design-allfunds-dictionary-collections-example_7" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Z1B1LRY1O7VQGWMRY4LR&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;can&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;14167AZA01&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;orderCreatedDate&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-02-01T09:22:29.660Z&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;redeemItems&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;accountNumber&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;50200013404502&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;amount&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1200.0&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;assetClassType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;EQUITY&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;folioId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;AZA011416727&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;ifscCode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;HDFC0000090&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;isin&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;INF090I01742&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;micrCode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;110240012&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;HDFC BANK LTD&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;volumeType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;A&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;statusType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CREATED&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;transactionType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;REDEEM&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;userId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;TQBJXZU7VPWJ&quot;</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="build-design-allfunds-dictionary-collections-visual_7">visual<a class="headerlink" href="#build-design-allfunds-dictionary-collections-visual_7" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code>@startjson
{
  &quot;_id&quot;: &quot;Z1B1LRY1O7VQGWMRY4LR&quot;,
  &quot;can&quot;: &quot;14167AZA01&quot;,
  &quot;orderCreatedDate&quot;: &quot;2024-02-01T09:22:29.660Z&quot;,
  &quot;redeemItems&quot;: [
    {
      &quot;accountNumber&quot;: &quot;50200013404502&quot;,
      &quot;amount&quot;: &quot;1200.0&quot;,
      &quot;assetClassType&quot;: &quot;EQUITY&quot;,
      &quot;folioId&quot;: &quot;AZA011416727&quot;,
      &quot;ifscCode&quot;: &quot;HDFC0000090&quot;,
      &quot;isin&quot;: &quot;INF090I01742&quot;,
      &quot;micrCode&quot;: &quot;110240012&quot;,
      &quot;name&quot;: &quot;HDFC BANK LTD&quot;,
      &quot;volumeType&quot;: &quot;A&quot;
    }
  ],
  &quot;statusType&quot;: &quot;CREATED&quot;,
  &quot;transactionType&quot;: &quot;REDEEM&quot;,
  &quot;userId&quot;: &quot;TQBJXZU7VPWJ&quot;
}
@endjson
</code></pre></div>
<h3 id="build-design-allfunds-dictionary-collections-dictionary_7">dictionary<a class="headerlink" href="#build-design-allfunds-dictionary-collections-dictionary_7" title="Permanent link">#</a></h3>
<table>
<thead>
<tr>
<th>fields</th>
<th>description</th>
<th>characteristics</th>
<th>is enum</th>
<th>example</th>
</tr>
</thead>
<tbody>
<tr>
<td>_id</td>
<td>external group order reference number as identifier</td>
<td>String</td>
<td>no</td>
<td>Z1B1-LRY1-O7VQ-GWMR-Y4LR</td>
</tr>
<tr>
<td>userId</td>
<td>all funds user Id</td>
<td>String</td>
<td>no</td>
<td>TQBJ-XZU7-VPWJ</td>
</tr>
<tr>
<td>can</td>
<td>common account number</td>
<td>String</td>
<td>no</td>
<td>14167AZA01</td>
</tr>
<tr>
<td>portfolioId</td>
<td>portfolio Id</td>
<td>String</td>
<td>no</td>
<td>01</td>
</tr>
<tr>
<td>mfuGroupOrderReferenceNumber</td>
<td>mfu group order reference number</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>orderCreatedDate</td>
<td>order created date</td>
<td>Date</td>
<td>no</td>
<td>2024-02-01T09:22:29.660Z</td>
</tr>
<tr>
<td>orderSentDate</td>
<td>order sent date</td>
<td>Date</td>
<td>no</td>
<td>2024-02-01T09:22:29.660Z</td>
</tr>
<tr>
<td>statusType</td>
<td>status type</td>
<td><a href="https://gitlabnew.techwave.net/fintrust/af-portfolio/-/blob/main/src/main/java/com/fintrust/allfunds/portfolio/impl/enums/OrderStatusType.java">OrderStatusType</a></td>
<td>yes</td>
<td>CREATED</td>
</tr>
<tr>
<td>transactionType</td>
<td>transaction type</td>
<td><a href="https://gitlabnew.techwave.net/fintrust/af-portfolio/-/blob/main/src/main/java/com/fintrust/allfunds/portfolio/impl/enums/TransactionType.java">TransactionType</a></td>
<td>yes</td>
<td>REDEEM</td>
</tr>
<tr>
<td>orderResponse</td>
<td>order response</td>
<td>Object</td>
<td>no</td>
<td>Object</td>
</tr>
<tr>
<td>orderResponse.txnRespCodeDetail</td>
<td>transaction response code detail</td>
<td>Object</td>
<td>no</td>
<td>Object</td>
</tr>
<tr>
<td>orderResponse.txnRespCodeDetail.errorFlag</td>
<td>error flag</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>orderResponse.txnRespCodeDetail.errorCode</td>
<td>error code</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>orderResponse.txnRespCodeDetail.errorMsg</td>
<td>error message</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>orderResponse.groupOrderNo</td>
<td>group order no</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>orderResponse.orderDate</td>
<td>order date</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>orderResponse.lastModifiedDate</td>
<td>last modified date</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>orderResponse.lastModifiedTime</td>
<td>last modified time</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>orderResponse.paymentFlag</td>
<td>payment flag</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>orderResponse.submitToPosFlag</td>
<td>to be given</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>orderResponse.txnApproveFlag</td>
<td>transaction approve flag</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>orderResponse.bankRefFlag</td>
<td>bank reference flag</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>orderResponse.bankTxnRefNo</td>
<td>bank transaction reference number</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>orderResponse.virtualAccNo</td>
<td>virtual account number</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>orderResponse.virtAccIfsc</td>
<td>virtual account ifsc</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>orderResponse.appLinkPrim</td>
<td>app link primary</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>orderResponse.appLinkH1</td>
<td>to be given</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>orderResponse.appLinkH2</td>
<td>to be given</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>orderResponse.appLinkPOA</td>
<td>to be given</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>orderResponse.netBankingLink</td>
<td>net banking link</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>orderResponse.payItrnSplitList</td>
<td>to be given</td>
<td>Array of Objects</td>
<td>no</td>
<td>Array of Objects</td>
</tr>
<tr>
<td>orderResponse.payItrnSplitList.accName</td>
<td>account name</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>orderResponse.payItrnSplitList.accType</td>
<td>account type</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>orderResponse.payItrnSplitList.amcPayID</td>
<td>amc pay Id</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>orderResponse.payItrnSplitList.ifsc</td>
<td>ifsc code</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>orderResponse.payItrnSplitList.invAccNo</td>
<td>to be given</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>orderResponse.payItrnSplitList.itrn</td>
<td>to be given</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>orderResponse.payItrnSplitList.itrnAmt</td>
<td>to be given</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>orderResponse.payItrnSplitList.rtaAmcCode</td>
<td>rta amc code</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>orderResponse.payItrnSplitList.rtaSchCode</td>
<td>to be given</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>orderResponse.payItrnSplitList.uniqPayItrnRefNo</td>
<td>to be given</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>orderResponse.payItrnSplitList.usrTxnRefNo</td>
<td>to be given</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
</tbody>
</table>
<h2 id="build-design-allfunds-dictionary-collections-outbox">outbox<a class="headerlink" href="#build-design-allfunds-dictionary-collections-outbox" title="Permanent link">#</a></h2>
<p>to be provided </p>
<h2 id="build-design-allfunds-dictionary-collections-portfolio">portfolio<a class="headerlink" href="#build-design-allfunds-dictionary-collections-portfolio" title="Permanent link">#</a></h2>
<p>portfolio collection stores assets of a user.</p>
<h3 id="build-design-allfunds-dictionary-collections-example_8">example<a class="headerlink" href="#build-design-allfunds-dictionary-collections-example_8" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;65a11d232d810368f1df3bee&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;custmerId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;H76C6ZRJV9VV&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;distribution&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;commodity&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;debt&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;equity&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">60</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;draft&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;investmentApproach&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Moderate&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;meta&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;created&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1706078825523&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;lastModified&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;0&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;schemaVer&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;oneTimeOrSIP&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;amount&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">50000</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;investmentType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ONETIME&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;oneTimeTenureInMonths&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">120</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;sipDayOfMonth&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;sipIsPerpetual&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;questions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;questionId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;selectedOption&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;questionId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;selectedOption&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;questionId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;3&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;selectedOption&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;questionId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;4&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;selectedOption&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;questionId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;5&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;selectedOption&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;questionId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;6&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;selectedOption&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;questionId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;7&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;selectedOption&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="build-design-allfunds-dictionary-collections-visual_8">visual<a class="headerlink" href="#build-design-allfunds-dictionary-collections-visual_8" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code>@startjson
{
  &quot;_id&quot;: &quot;65a11d232d810368f1df3bee&quot;,
  &quot;custmerId&quot;: &quot;H76C6ZRJV9VV&quot;,
  &quot;distribution&quot;: {
    &quot;commodity&quot;: 0,
    &quot;debt&quot;: 40,
    &quot;equity&quot;: 60
  },
  &quot;draft&quot;: true,
  &quot;investmentApproach&quot;: &quot;Moderate&quot;,
  &quot;meta&quot;: {
    &quot;created&quot;: &quot;1706078825523&quot;,
    &quot;lastModified&quot;: &quot;0&quot;,
    &quot;schemaVer&quot;: &quot;1&quot;
  },
  &quot;oneTimeOrSIP&quot;: {
    &quot;amount&quot;: 50000,
    &quot;investmentType&quot;: &quot;ONETIME&quot;,
    &quot;oneTimeTenureInMonths&quot;: 120,
    &quot;sipDayOfMonth&quot;: 0,
    &quot;sipIsPerpetual&quot;: false
  },
  &quot;questions&quot;: [
    {
      &quot;questionId&quot;: &quot;1&quot;,
      &quot;selectedOption&quot;: 2
    },
    {
      &quot;questionId&quot;: &quot;2&quot;,
      &quot;selectedOption&quot;: 3
    },
    {
      &quot;questionId&quot;: &quot;3&quot;,
      &quot;selectedOption&quot;: 2
    },
    {
      &quot;questionId&quot;: &quot;4&quot;,
      &quot;selectedOption&quot;: 3
    },
    {
      &quot;questionId&quot;: &quot;5&quot;,
      &quot;selectedOption&quot;: 3
    },
    {
      &quot;questionId&quot;: &quot;6&quot;,
      &quot;selectedOption&quot;: 2
    },
    {
      &quot;questionId&quot;: &quot;7&quot;,
      &quot;selectedOption&quot;: 3
    }
  ]
}
@endjson
</code></pre></div>
<h3 id="build-design-allfunds-dictionary-collections-dictionary_8">dictionary<a class="headerlink" href="#build-design-allfunds-dictionary-collections-dictionary_8" title="Permanent link">#</a></h3>
<table>
<thead>
<tr>
<th>fields</th>
<th>description</th>
<th>characteristics</th>
<th>is enum</th>
<th>example</th>
</tr>
</thead>
<tbody>
<tr>
<td>_id</td>
<td>Id</td>
<td>Object</td>
<td>no</td>
<td>65a907018919ff20f94ba57a</td>
</tr>
<tr>
<td>draft</td>
<td>if drafted</td>
<td>boolean</td>
<td>no</td>
<td>true</td>
</tr>
<tr>
<td>label</td>
<td>label name of portfolio</td>
<td>String</td>
<td>no</td>
<td>to be provided</td>
</tr>
<tr>
<td>custmerId</td>
<td>customer Id</td>
<td>String</td>
<td>no</td>
<td>52B5-50K0-L1ES</td>
</tr>
<tr>
<td>investmentApproach</td>
<td>investment approach</td>
<td>String</td>
<td>no</td>
<td>aggressive</td>
</tr>
<tr>
<td>distribution</td>
<td>distribution</td>
<td>Object</td>
<td>no</td>
<td>Object</td>
</tr>
<tr>
<td>distribution.commodity</td>
<td>asset distribution in commodity</td>
<td>int</td>
<td>no</td>
<td>0</td>
</tr>
<tr>
<td>distribution.equity</td>
<td>asset distribution in equity</td>
<td>int</td>
<td>no</td>
<td>60</td>
</tr>
<tr>
<td>distribution.debt</td>
<td>asset distribution in debt</td>
<td>int</td>
<td>no</td>
<td>40</td>
</tr>
<tr>
<td>questions</td>
<td>array of questions</td>
<td>array of questions</td>
<td>no</td>
<td>array of questions</td>
</tr>
<tr>
<td>questions.selectedOption</td>
<td>selected option</td>
<td>int</td>
<td>no</td>
<td>2</td>
</tr>
<tr>
<td>questions.questionId</td>
<td>question Id</td>
<td>String</td>
<td>no</td>
<td>7</td>
</tr>
<tr>
<td>oneTimeOrSIP</td>
<td>one time or sip or swp or switch or redeem or buy</td>
<td>Object</td>
<td>no</td>
<td>Object</td>
</tr>
<tr>
<td>oneTimeOrSIP.oneTimeTenureInMonths</td>
<td>tenure in month</td>
<td>int</td>
<td>no</td>
<td>12</td>
</tr>
<tr>
<td>oneTimeOrSIP.sipDayOfMonth</td>
<td>day of the month</td>
<td>int</td>
<td>no</td>
<td>3</td>
</tr>
<tr>
<td>oneTimeOrSIP.amount</td>
<td>amount</td>
<td>Double</td>
<td>no</td>
<td>5000</td>
</tr>
<tr>
<td>oneTimeOrSIP.investmentType</td>
<td>investment type</td>
<td>String</td>
<td>no</td>
<td>ONETIME</td>
</tr>
<tr>
<td>oneTimeOrSIP.sipStartDate</td>
<td>sip start date</td>
<td>Date</td>
<td>no</td>
<td>2023-09-07T00:00:00.000Z</td>
</tr>
<tr>
<td>oneTimeOrSIP.sipEndDate</td>
<td>sip end date</td>
<td>Date</td>
<td>no</td>
<td>2024-03-10T00:00:00.000Z</td>
</tr>
<tr>
<td>oneTimeOrSIP.sipInterval</td>
<td>sip interval</td>
<td>String</td>
<td>no</td>
<td>QUARTERLY</td>
</tr>
<tr>
<td>oneTimeOrSIP.sipIsPerpetual</td>
<td>sip is perpetual</td>
<td>boolean</td>
<td>no</td>
<td>true</td>
</tr>
<tr>
<td>meta</td>
<td>meta</td>
<td>Object</td>
<td>no</td>
<td>Object</td>
</tr>
<tr>
<td>meta.created</td>
<td>created at</td>
<td>int 64</td>
<td>no</td>
<td>1706078825523</td>
</tr>
<tr>
<td>meta.lastModified</td>
<td>last modified at</td>
<td>int 64</td>
<td>no</td>
<td>0</td>
</tr>
<tr>
<td>meta.schemaVer</td>
<td>schema version</td>
<td>String</td>
<td>no</td>
<td>1</td>
</tr>
</tbody>
</table>
<h2 id="build-design-allfunds-dictionary-collections-transaction">transaction<a class="headerlink" href="#build-design-allfunds-dictionary-collections-transaction" title="Permanent link">#</a></h2>
<p>transaction collection stores request and response of mfu orders and maintain transaction status.</p>
<h3 id="build-design-allfunds-dictionary-collections-example_9">example<a class="headerlink" href="#build-design-allfunds-dictionary-collections-example_9" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ZZUG1EA2ZFE5K2NUF4WM&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;executor&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;mfu&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;mfuItrnNo&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;01&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;orderId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;A98JHU9827JHF8726HI3&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;isin&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;INF204K01ZP3&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;panNumber&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;BTCPK4218U&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;redeem&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;accountNumber&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1233&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;ifscCode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;UTBI0BEC13&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;micrCode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;123456789&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;volumeType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;E&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;FAILED&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;transactionType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;REDEEM&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;txDate&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-01-23T08:19:05.164Z&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;userId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;JHMJDETS&quot;</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="build-design-allfunds-dictionary-collections-visual_9">visual<a class="headerlink" href="#build-design-allfunds-dictionary-collections-visual_9" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code>@startjson
{
  &quot;_id&quot;: &quot;ZZUG1EA2ZFE5K2NUF4WM&quot;,
  &quot;executor&quot;: {
    &quot;mfu&quot;: {
      &quot;mfuItrnNo&quot;: &quot;01&quot;,
      &quot;orderId&quot;: &quot;A98JHU9827JHF8726HI3&quot;
    }
  },
  &quot;isin&quot;: &quot;INF204K01ZP3&quot;,
  &quot;panNumber&quot;: &quot;BTCPK4218U&quot;,
  &quot;redeem&quot;: {
    &quot;accountNumber&quot;: &quot;1233&quot;,
    &quot;ifscCode&quot;: &quot;UTBI0BEC13&quot;,
    &quot;micrCode&quot;: &quot;123456789&quot;,
    &quot;volumeType&quot;: &quot;E&quot;
  },
  &quot;status&quot;: &quot;FAILED&quot;,
  &quot;transactionType&quot;: &quot;REDEEM&quot;,
  &quot;txDate&quot;: &quot;2024-01-23T08:19:05.164Z&quot;,
  &quot;userId&quot;: &quot;JHMJDETS&quot;
}
@endjson
</code></pre></div>
<h3 id="build-design-allfunds-dictionary-collections-dictionary_9">dictionary<a class="headerlink" href="#build-design-allfunds-dictionary-collections-dictionary_9" title="Permanent link">#</a></h3>
<table>
<thead>
<tr>
<th>fields</th>
<th>description</th>
<th>characteristics</th>
<th>is enum</th>
<th>example</th>
</tr>
</thead>
<tbody>
<tr>
<td>_id</td>
<td>external transaction reference number as id</td>
<td>String</td>
<td>no</td>
<td>ZZUG-1EA2-ZFE5-K2NU-F4WM</td>
</tr>
<tr>
<td>isin</td>
<td>fund isin</td>
<td>String</td>
<td>no</td>
<td>INF204K01ZP3</td>
</tr>
<tr>
<td>userId</td>
<td>user Id</td>
<td>String</td>
<td>no</td>
<td>JHMJDETS</td>
</tr>
<tr>
<td>portfolioId</td>
<td>portfolio Id</td>
<td>String</td>
<td>no</td>
<td>01</td>
</tr>
<tr>
<td>status</td>
<td>transaction status type</td>
<td><a href="https://gitlabnew.techwave.net/fintrust/af-portfolio/-/blob/main/src/main/java/com/fintrust/allfunds/portfolio/impl/enums/TransactionStatusType.java">TransactionStatusType</a></td>
<td>yes</td>
<td>FAILED</td>
</tr>
<tr>
<td>transactionType</td>
<td>transaction type</td>
<td><a href="https://gitlabnew.techwave.net/fintrust/af-portfolio/-/blob/main/src/main/java/com/fintrust/allfunds/portfolio/impl/enums/TransactionType.java">TransactionType</a></td>
<td>yes</td>
<td>REDEEM</td>
</tr>
<tr>
<td>txDate</td>
<td>transaction date</td>
<td>Date</td>
<td>no</td>
<td>2024-01-23T08:19:05.164Z</td>
</tr>
<tr>
<td>panNumber</td>
<td>pan number</td>
<td>String</td>
<td>no</td>
<td>BTCPK4218U</td>
</tr>
<tr>
<td>accounting</td>
<td>accounting detail</td>
<td>Object</td>
<td>no</td>
<td>Object</td>
</tr>
<tr>
<td>accounting.remarks</td>
<td>remark</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>accounting.folioNumber</td>
<td>folio number</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>purchase</td>
<td>purchase details</td>
<td>Object</td>
<td>no</td>
<td>Object</td>
</tr>
<tr>
<td>purchase.tenureInMonths</td>
<td>tenure in month</td>
<td>int</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>purchase.amount</td>
<td>amount</td>
<td>decimal</td>
<td>no</td>
<td>5000</td>
</tr>
<tr>
<td>sip</td>
<td>systematic investment plan details</td>
<td>Object</td>
<td>no</td>
<td>Object</td>
</tr>
<tr>
<td>sip.frequency</td>
<td>frequency</td>
<td><a href="https://gitlabnew.techwave.net/fintrust/af-portfolio/-/blob/main/src/main/java/com/fintrust/allfunds/portfolio/impl/enums/FrequencyType.java">FrequencyType</a></td>
<td>yes</td>
<td>D</td>
</tr>
<tr>
<td>sip.day</td>
<td>day</td>
<td>String</td>
<td>no</td>
<td>1</td>
</tr>
<tr>
<td>sip.startDate</td>
<td>start date</td>
<td>Date</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>sip.endDate</td>
<td>end date</td>
<td>Date</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>sip.amount</td>
<td>amount</td>
<td>Decimal</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>swp</td>
<td>systematic withdrawal plan details</td>
<td>Object</td>
<td>no</td>
<td>Object</td>
</tr>
<tr>
<td>swp.startDate</td>
<td>start date</td>
<td>Date</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>swp.endDate</td>
<td>end date</td>
<td>Date</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>swp.dayOfMonth</td>
<td>day of the month</td>
<td>Date</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>swp.frequencyType</td>
<td>frequency type</td>
<td><a href="https://gitlabnew.techwave.net/fintrust/af-portfolio/-/blob/main/src/main/java/com/fintrust/allfunds/portfolio/impl/enums/FrequencyType.java">FrequencyType</a></td>
<td>yes</td>
<td>D</td>
</tr>
<tr>
<td>swp.amount</td>
<td>amount</td>
<td>Decimal</td>
<td>no</td>
<td>5000</td>
</tr>
<tr>
<td>stp</td>
<td>systematic transfer plan details</td>
<td>Object</td>
<td>no</td>
<td>Object</td>
</tr>
<tr>
<td>stp.tarIsin</td>
<td>target isin</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>stp.tarName</td>
<td>target fund name</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>stp.tarAssetClassType</td>
<td>asset class type</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>stp.frequency</td>
<td>frequency type</td>
<td><a href="https://gitlabnew.techwave.net/fintrust/af-portfolio/-/blob/main/src/main/java/com/fintrust/allfunds/portfolio/impl/enums/FrequencyType.java">FrequencyType</a></td>
<td>yes</td>
<td>D</td>
</tr>
<tr>
<td>stp.day</td>
<td>day</td>
<td>String</td>
<td>no</td>
<td>4</td>
</tr>
<tr>
<td>stp.startDate</td>
<td>start date</td>
<td>Date</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>stp.endDate</td>
<td>end date</td>
<td>Date</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>stp.amount</td>
<td>amount</td>
<td>Decimal</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>switchFund</td>
<td>switch</td>
<td>Object</td>
<td>no</td>
<td>Object</td>
</tr>
<tr>
<td>switchFund.tarIsin</td>
<td>target isin</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>switchFund.tarName</td>
<td>target fund name</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>switchFund.tarAssetClassType</td>
<td>target asset class type</td>
<td><a href="https://gitlabnew.techwave.net/fintrust/af-commons/-/blob/main/src/main/java/com/fintrust/allfunds/commons/enums/AssetClassType.java">AssetClassType</a></td>
<td>no</td>
<td>EQUITY</td>
</tr>
<tr>
<td>switchFund.tarAssetCategory</td>
<td>target asset category</td>
<td>String</td>
<td>no</td>
<td>Large cap</td>
</tr>
<tr>
<td>switchFund.amount</td>
<td>amount</td>
<td>Decimal</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>switchFund.units</td>
<td>units</td>
<td>Decimal</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>switchFund.volumeType</td>
<td>volume type</td>
<td><a href="https://gitlabnew.techwave.net/fintrust/af-portfolio/-/blob/main/src/main/java/com/fintrust/allfunds/portfolio/impl/enums/VolumeType.java">VolumeType</a></td>
<td>no</td>
<td>E</td>
</tr>
<tr>
<td>redeem</td>
<td>redeem</td>
<td>Object</td>
<td>no</td>
<td>Object</td>
</tr>
<tr>
<td>redeem.payoutFlag</td>
<td>payout flag</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>redeem.amount</td>
<td>redeem amount</td>
<td>Decimal</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>redeem.units</td>
<td>units</td>
<td>Decimal</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>redeem.volumeType</td>
<td>volume type</td>
<td><a href="https://gitlabnew.techwave.net/fintrust/af-portfolio/-/blob/main/src/main/java/com/fintrust/allfunds/portfolio/impl/enums/VolumeType.java">VolumeType</a></td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>redeem.accountNumber</td>
<td>account number</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>redeem.ifscCode</td>
<td>ifsc code</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>redeem.micrCode</td>
<td>micr code</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>executor</td>
<td>executor</td>
<td>Object</td>
<td>no</td>
<td>Object</td>
</tr>
<tr>
<td>executor.mfu</td>
<td>mfu</td>
<td>Object</td>
<td>no</td>
<td>Object</td>
</tr>
<tr>
<td>executor.mfu.orderId</td>
<td>order Id</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>executor.mfu.mfuOrderRef</td>
<td>mfu order reference</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>executor.mfu.mfuItrnNo</td>
<td>mfu itr number</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>executor.mfu.mfuOrderDate</td>
<td>mfu order date</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>executor.mfu.mfuStatus</td>
<td>mfu status</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>executor.mfu.systematicCancel</td>
<td>systematic cancel</td>
<td>Object</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>executor.mfu.systematicCancel.mfuSCOrderId</td>
<td>mfu sc order id</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>executor.mfu.systematicCancel.mfuSCOrderRef</td>
<td>mfu sc order ref</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>executor.mfu.systematicCancel.mfuSCOrderDate</td>
<td>mfu sc oder date</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>executor.mfu.systematicCancel.mfuLastModDate</td>
<td>mfu last mod date</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
<tr>
<td>executor.mfu.systematicCancel.mfuLastModTime</td>
<td>mfu last mod time</td>
<td>String</td>
<td>no</td>
<td>to be given</td>
</tr>
</tbody>
</table></section><h1 class='nav-section-title-end'>Ended: Dictionary</h1><h1 class='nav-section-title-end'>Ended: AllFunds</h1>
                        <h3 class='nav-section-title' id='section-utilities'>
                            Utilities <a class='headerlink' href='#section-utilities' title='Permanent link'>â†µ</a>
                        </h3>
                        <h1 class='nav-section-title-end'>Ended: Utilities</h1><h1 class='nav-section-title-end'>Ended: Design</h1>
                        <h2 class='nav-section-title' id='section-engineering'>
                            Engineering <a class='headerlink' href='#section-engineering' title='Permanent link'>â†µ</a>
                        </h2>
                        <section class="print-page" id="build-engineering-principles"><h1 id="build-engineering-principles-principles-and-practices">Principles and Practices<a class="headerlink" href="#build-engineering-principles-principles-and-practices" title="Permanent link">#</a></h1>
<h2 id="build-engineering-principles-core-ethos">Core Ethos<a class="headerlink" href="#build-engineering-principles-core-ethos" title="Permanent link">#</a></h2>
<p>The core ethos that underpin all software engineering practices in the system are</p>
<h3 id="build-engineering-principles-everything-as-code">Everything as Code<a class="headerlink" href="#build-engineering-principles-everything-as-code" title="Permanent link">#</a></h3>
<p><a href="https://docs.aws.amazon.com/wellarchitected/latest/devops-guidance/everything-as-code.html">What is everything as code?</a></p>
<p>Every aspect of the system - such as software, migrations, build pipelines, tests, infrastructure, documentation , even diagrams as modeled in Code. This ensures they can be effectively stored, versioned and deployed in a repeatable fashion with very little manual support.</p>
<h3 id="build-engineering-principles-everything-is-a-container">Everything is a Container<a class="headerlink" href="#build-engineering-principles-everything-is-a-container" title="Permanent link">#</a></h3>
<p>Everything that we deliver in this project is a docker container. Nothing in the system requires a manual setup. This ensures very high portability of the components as they move across environments. Containers include developed software, migrations, tests, dependency software, quality assessment tools, wikis and documentation. They can be easily turned on/off for deployment across environments.</p>
<h3 id="build-engineering-principles-everything-is-stored">Everything is Stored<a class="headerlink" href="#build-engineering-principles-everything-is-stored" title="Permanent link">#</a></h3>
<p>Everything in the project has a home â€“ a repository. This includes source code, docker containers, libraries, deployment packages (such as helm-charts)</p>
<h2 id="build-engineering-principles-configuration-management-principles">Configuration Management Principles<a class="headerlink" href="#build-engineering-principles-configuration-management-principles" title="Permanent link">#</a></h2>
<h3 id="build-engineering-principles-code-repositories">Code Repositories<a class="headerlink" href="#build-engineering-principles-code-repositories" title="Permanent link">#</a></h3>
<ul>
<li>All source code is managed in GitLab. </li>
<li>Each unique software function is maintained in a dedicated GitLab repository.</li>
<li>Each repository is connected to a build pipeline</li>
<li>Each build pipeline results in an artifact.</li>
<li>Each artifact is stored in a repository.</li>
</ul>
<p><img alt="GitLab Projects Image" src="../Build/Engineering/gitlab-projects.JPG" /></p>
<h3 id="build-engineering-principles-artifact-repositories">Artifact Repositories<a class="headerlink" href="#build-engineering-principles-artifact-repositories" title="Permanent link">#</a></h3>
<p>All artifacts are housed in dedicated repositories.</p>
<h4 id="build-engineering-principles-reposilite">Reposilite<a class="headerlink" href="#build-engineering-principles-reposilite" title="Permanent link">#</a></h4>
<p>Libraries are stored in Reposilite (like Artifactory or Nexus but free and open source)</p>
<p><img alt="Reposilite Image" src="../Build/Engineering/reposilite.JPG" /></p>
<h4 id="build-engineering-principles-docker-container-registry">Docker Container Registry<a class="headerlink" href="#build-engineering-principles-docker-container-registry" title="Permanent link">#</a></h4>
<p>Containers are stored in GitLab Container Registries</p>
<p><img alt="GitLab Container Registry Image" src="../Build/Engineering/gitlab-container-registry.JPG" /></p>
<h3 id="build-engineering-principles-versioning">Versioning<a class="headerlink" href="#build-engineering-principles-versioning" title="Permanent link">#</a></h3>
<p>All versions follow a major.minor.fix scheme.</p>
<h4 id="build-engineering-principles-during-development">During development<a class="headerlink" href="#build-engineering-principles-during-development" title="Permanent link">#</a></h4>
<p>During development we follow Sprint-versioning scheme. All components are re-versioned at the start of the sprint. 
Given a version number MAJOR.MINOR.PATCH, increment the:
MAJOR version  is always 0
MINOR version is the version of the sprint.
PATCH version is incremented for every additional release made within the sprint</p>
<h4 id="build-engineering-principles-post-go-live">Post go-live<a class="headerlink" href="#build-engineering-principles-post-go-live" title="Permanent link">#</a></h4>
<p>Post go-live all components will follow a Semantic versioning scheme.
The Semver standard is fully described here - https://semver.org/
Given a version number MAJOR.MINOR.PATCH, increment the:
MAJOR version when you make incompatible API changes
MINOR version when you add functionality in a backward compatible manner
PATCH version when you make backward compatible bug fixes
Additional labels for pre-release and build metadata are available as extensions to the MAJOR.MINOR.PATCH format.</p>
<h3 id="build-engineering-principles-continuous-integration">Continuous Integration<a class="headerlink" href="#build-engineering-principles-continuous-integration" title="Permanent link">#</a></h3>
<p>Continuous integration refers to the build and unit testing stages of the software release process. Every revision that is committed triggers an automated build,code analysis,dependency analysis and test.
We have three kinds of code in the gitlab repositories</p>
<ol>
<li><strong>Libraries:</strong> Source code repository where we are storing the common code which will be integrated to individual modules of application.</li>
<li><strong>Individual components of application:</strong> Application is divided into components ( micro-service architecture ). Maintaining the separate repo for each individual components.</li>
<li><strong>Deployment repository:</strong> Repository to store the application and data helm charts.</li>
</ol>
<p>Refer the below diagrams to understand the CI flow of various repositories</p>
<h4 id="build-engineering-principles-library-ci-flow">Library CI Flow<a class="headerlink" href="#build-engineering-principles-library-ci-flow" title="Permanent link">#</a></h4>
<p><img alt="Libraries CI Flow" src="../Build/Engineering/library-ci-flow.jpg" /></p>
<h4 id="build-engineering-principles-components-ci-flow">Components CI Flow<a class="headerlink" href="#build-engineering-principles-components-ci-flow" title="Permanent link">#</a></h4>
<p><img alt="Components CI Flow" src="../Build/Engineering/component-ci-flow.jpg" /></p>
<h4 id="build-engineering-principles-application-ci-flow">Application CI Flow<a class="headerlink" href="#build-engineering-principles-application-ci-flow" title="Permanent link">#</a></h4>
<p><img alt="Application CI Flow" src="../Build/Engineering/application-ci-flow.jpg" /></p>
<h3 id="build-engineering-principles-continuous-deployments">Continuous Deployments<a class="headerlink" href="#build-engineering-principles-continuous-deployments" title="Permanent link">#</a></h3>
<p>Continuous deployment is a strategy in software development where code changes to an application are released automatically into the desired environment.</p>
<h4 id="build-engineering-principles-deployment-flow">Deployment Flow<a class="headerlink" href="#build-engineering-principles-deployment-flow" title="Permanent link">#</a></h4>
<p><img alt="Deployment Flow" src="../Build/Engineering/cd-flow.jpg" /></p>
<h2 id="build-engineering-principles-build-principles">Build Principles<a class="headerlink" href="#build-engineering-principles-build-principles" title="Permanent link">#</a></h2>
<h3 id="build-engineering-principles-sast-and-dast">SAST and DAST<a class="headerlink" href="#build-engineering-principles-sast-and-dast" title="Permanent link">#</a></h3>
<p>We use SonarQube for static and dynamic code analysis and security scans. All build pipelines are integrated to Sonar and capture quality on a continuous basis. We strive to ensure A grade on all parameters such a Reliability, Security, Maintainabilty, Duplications etc.</p>
<p><img alt="SonarQube Code Quality Report Image" src="../Build/Engineering/sonarqube-code-quality.JPG" /></p>
<h3 id="build-engineering-principles-software-dependency-analysis">Software dependency analysis<a class="headerlink" href="#build-engineering-principles-software-dependency-analysis" title="Permanent link">#</a></h3>
<p>The below article describes the need for software dependency analysis as a key driver for building high quality software
<a href="https://www.sonatype.com/resources/articles/what-are-software-dependencies">What are software dependencies?</a>
We are implementing OWASPâ€™s Dependency Scan to assess CVEs and Licensing challenges pertaining to use of 3rd party software. 
<a href="https://owasp.org/www-project-dep-scan/">OWASP DepScan tool</a></p>
<p>According to OWASP,  â€œdep-scan is a next-generation security and risk audit tool based on known vulnerabilities, advisories, and license limitations for project dependencies. Both local repositories and container images are supported as the input, and the tool is ideal for integration with ASPM/VM platforms and in CI environmentsâ€.</p>
<p>See below an integration of DepScan into our CI process
<img alt="OWASP DepScan Dependency Analyzer Image" src="../Build/Engineering/owasp-depscan-dependency-analyzer-ci-integration.JPG" /></p>
<p>See below an extract of vulnerabilities identified by DepScan
<img alt="OWASP DepScan Report Image" src="../Build/Engineering/owasp-depscan-report.JPG" /></p>
<h3 id="build-engineering-principles-environments">Environments<a class="headerlink" href="#build-engineering-principles-environments" title="Permanent link">#</a></h3>
<p>We support a multi-environment system. The design of the environments is such that the lower environments are flexible to the needs of a developer. The higher environments are increasingly closer to the final production environment. The important principle is that all code created and tested in the lower environments are guaranteed to work on the higher environments. To achieve this we run multiple flavors of Kubernetes on these environments.</p>
<table>
<thead>
<tr>
<th>Environment</th>
<th>Stack Used</th>
</tr>
</thead>
<tbody>
<tr>
<td>Local</td>
<td>Docker Desktop Commercial Edition on Windows 10/11 running docker engine and Kubernetes</td>
</tr>
<tr>
<td>Automation</td>
<td>Kubernetes running on Minikube and Docker engine running on Ubuntu 22.04 Linux</td>
</tr>
<tr>
<td>Integration</td>
<td>Kubernetes running on Minikube and Docker engine running on Ubuntu 22.04 Linux</td>
</tr>
<tr>
<td>Staging</td>
<td>AWS Elastic Kubernetes Service (EKS) â€“ managed Kubernetes service</td>
</tr>
<tr>
<td>Production</td>
<td>AWS Elastic Kubernetes Service (EKS) â€“ managed Kubernetes service</td>
</tr>
</tbody>
</table>
<h3 id="build-engineering-principles-unit-tests">Unit Tests<a class="headerlink" href="#build-engineering-principles-unit-tests" title="Permanent link">#</a></h3>
<p>Unit tests are generally discarded in favor of integration tests for end-to-end verification. However, Unit tests are developed for all libraries and any code that uses a lot of logic.
We are exploring the use of GitHub CoPilot to automatically generate Unit tests to optimize time spent by developers on this activity.</p>
<h3 id="build-engineering-principles-integration-tests">Integration Tests<a class="headerlink" href="#build-engineering-principles-integration-tests" title="Permanent link">#</a></h3>
<p>We have a robust automation test suite that tests all APIs developed. The automation suite is built on Karate and supports the ability to invoke tests and also the ability to Mock 3rd party APIs and Services that cannot be tested in a repeatable fashion.
The automation tests are run on a dedicated environment that is recreated on every run with all migrations (db, mq, etc.) applied. This guarantees that the tests are repeatable.
The automation tests are as part of the Continuous Delivery pipeline that packages all software and promotes it to higher environments such as Dev (integration). Unless the tests pass, the software is not promoted.</p>
<p>The tests are run as explained below.</p>
<p>A sample results of the test is shown below.</p>
<h3 id="build-engineering-principles-performance-tests">Performance Tests<a class="headerlink" href="#build-engineering-principles-performance-tests" title="Permanent link">#</a></h3>
<blockquote>
<p>To be done</p>
</blockquote>
<h3 id="build-engineering-principles-vulnerability-and-penetration-tests">Vulnerability and Penetration Tests<a class="headerlink" href="#build-engineering-principles-vulnerability-and-penetration-tests" title="Permanent link">#</a></h3>
<blockquote>
<p>To be done</p>
</blockquote>
<h3 id="build-engineering-principles-packaging-and-deployment">Packaging and Deployment<a class="headerlink" href="#build-engineering-principles-packaging-and-deployment" title="Permanent link">#</a></h3>
<ul>
<li>The applications are packaged as one or more helm charts</li>
<li>The helm charts are stored in the GitLab Package registry.</li>
<li>The packaging and promotion are done as part of the Continuous Delivery pipeline</li>
<li>Configuration and Secrets for various environments are overridden and injected externally.</li>
</ul>
<h2 id="build-engineering-principles-infrastructure-principles">Infrastructure Principles<a class="headerlink" href="#build-engineering-principles-infrastructure-principles" title="Permanent link">#</a></h2>
<h3 id="build-engineering-principles-infrastructure-as-code">Infrastructure as Code<a class="headerlink" href="#build-engineering-principles-infrastructure-as-code" title="Permanent link">#</a></h3>
<p>We use IaC (Infrastructure as Code) practices to patch and re-create infrastructure on demand. 
 - OpenTofu (open source fork of Terraform) is used to build the infra.
 - Generates everything from Bastion, VPC, Networking, Load Balancers, Kubernetes, Databases, Nodepools, Secrets, Observability engines etc.</p>
<p><img alt="Infrastructure as code" src="../Build/Engineering/infrastructure-as-code.JPG" /></p>
<h2 id="build-engineering-principles-run-principles">Run Principles<a class="headerlink" href="#build-engineering-principles-run-principles" title="Permanent link">#</a></h2>
<h3 id="build-engineering-principles-migrations">Migrations<a class="headerlink" href="#build-engineering-principles-migrations" title="Permanent link">#</a></h3>
<ul>
<li>Database changes are captures as Migrations (up and down) and are automatically applied on promotions.</li>
<li>RabbitMQ state (exchanges, queues, bindings) are captured as migrations and are automatically applied on promotions,</li>
<li>We use Kubernetes init-container strategies to prioritize execution of migration containers and wait for them to finish before deploying application components.</li>
</ul>
<p>See below various migration components that are automatically patching the databases and message queues</p>
<p><img alt="Migration Components Image" src="../Build/Engineering/migration-tools.JPG" /></p>
<h3 id="build-engineering-principles-observability">Observability<a class="headerlink" href="#build-engineering-principles-observability" title="Permanent link">#</a></h3>
<ul>
<li>All containers generate logs</li>
<li>Logs are formatted as JSON</li>
<li>Logs are streamed to STDOUT and STDERR</li>
<li>FluentBit is run as a daemonset to trap logs and forward to OpenObserve</li>
<li>Logs can filtered, analyzed and archived in OpenObserve</li>
</ul>
<p><img alt="OpenObserver aggregated logs" src="../Build/Engineering/openobserve-logs.JPG" /></p>
<h3 id="build-engineering-principles-secrets-management">Secrets Management<a class="headerlink" href="#build-engineering-principles-secrets-management" title="Permanent link">#</a></h3>
<p>Secrets are managed in the following ways across various environments</p>
<table>
<thead>
<tr>
<th>Environment</th>
<th>Secrets</th>
</tr>
</thead>
<tbody>
<tr>
<td>Local</td>
<td>Helm overrides (values.yaml)</td>
</tr>
<tr>
<td>Dev</td>
<td>Helm overrides (values.yaml)</td>
</tr>
<tr>
<td>Automation</td>
<td>Helm overrides (values.yaml)</td>
</tr>
<tr>
<td>Staging</td>
<td>Secrets managed in AWS Secrets Manager are injected into AWS EKS using <a href="https://external-secrets.io/latest/">External Secrets Operator</a></td>
</tr>
</tbody>
</table>
<h2 id="build-engineering-principles-documentation-principles">Documentation Principles<a class="headerlink" href="#build-engineering-principles-documentation-principles" title="Permanent link">#</a></h2>
<h3 id="build-engineering-principles-development-aids">Development Aids<a class="headerlink" href="#build-engineering-principles-development-aids" title="Permanent link">#</a></h3>
<p>To fast-track a new developer into understanding how to build and deploy a component, we provide Readmeâ€™s.  See below an example Readme for a component named af-profile.</p>
<p><img alt="Developer Readme" src="../Build/Engineering/developer-aids-readme.JPG" /></p>
<h3 id="build-engineering-principles-api-docs">API Docs<a class="headerlink" href="#build-engineering-principles-api-docs" title="Permanent link">#</a></h3>
<p>All internal and external APIs are fully documented using OpenAPI 3.0 specifications. The requests and responses are fully documented to eliminate any source of confusion. These are used as the ONLY source of information by the UI and QA teams to either integrate into these APIs or perform Quality Assurance on these APIs. In tune with the ethos of the platform, which is to containerize everything, even the API documentation is also built using pipelines and deployed on k8s environments as another container.
A portion of APIs is presented as a snapshot below.</p>
<p><img alt="API Docs" src="../Build/Engineering/openapi-docs.JPG" /></p>
<p>The request and response payloads, headers, statuses are fully documented to ensure minimize dependencies on the API development teams.</p>
<p><img alt="API Docs Exploded" src="../Build/Engineering/openapi-docs-exploded.JPG" /></p>
<h3 id="build-engineering-principles-wikis">Wikis<a class="headerlink" href="#build-engineering-principles-wikis" title="Permanent link">#</a></h3>
<p>All technical documentation is automatically generated as a Wiki. We use mkdocs engine to convert all Markdown files to a readable documentation website. In tune with the ethos of the platform, which is to containerize everything, even the Wikis are also built using pipelines and deployed on k8s environments as another container.
All documentation uses the Markdown syntax. Various aspects of the documentation include
 - Software Engineering Principles &amp; Practices (you are reading this !) 
 - Architecture
 - Component Designs
 - Infrastructure Definition
 - Operation Runbooks</p>
<p><img alt="Wiki Filesystem" src="../Build/Engineering/wiki-filesystem.JPG" /></p>
<p>The build of the Wiki pipeline results in the Wiki container that runs the wiki site below.</p>
<p><img alt="Wiki Docs" src="../Build/Engineering/wiki-docs.JPG" /></p>
<h3 id="build-engineering-principles-diagrams">Diagrams<a class="headerlink" href="#build-engineering-principles-diagrams" title="Permanent link">#</a></h3>
<p>We strive to document diagrams also as code so that they can be stored and regenerated as a diagram on demand. This ensures the  original drawings donot get lost on the developer machines. We use various engines such as PlantUML, Mermaid etc to generate diagrams and in order to interface with these various engines we use Kroki  ( https://kroki.io/ )</p>
<p>See an example diagram generated below.</p>
<p><img alt="Diagrams as Code" src="../Build/Engineering/diagrams-as-code.JPG" /></p></section><h1 class='nav-section-title-end'>Ended: Engineering</h1><h1 class='nav-section-title-end'>Ended: Build</h1>
                        <h1 class='nav-section-title' id='section-run'>
                            Run <a class='headerlink' href='#section-run' title='Permanent link'>â†µ</a>
                        </h1>
                        <section class="print-page" id="run"><h1 id="run-about">About<a class="headerlink" href="#run-about" title="Permanent link">#</a></h1>
<p>This is the home of all technical documentation for Fintrust related to operating the system.</p></section><section class="print-page" id="run-security%20%26%20authentication"><h1 id="run-security%20%26%20authentication-security-authentication">Security &amp; Authentication<a class="headerlink" href="#run-security%20%26%20authentication-security-authentication" title="Permanent link">#</a></h1>
<h3 id="run-security%20%26%20authentication-version-control-system">Version Control System<a class="headerlink" href="#run-security%20%26%20authentication-version-control-system" title="Permanent link">#</a></h3>
<p>We are hosting the source code repositories in Techwave hosted GitLab under the Fintrust Group.</p>
<p><a href="https://gitlabnew.techwave.net">GitLab URL</a></p>
<p>We are providing the access to the team with an expiration period of 3 months</p>
<h3 id="run-security%20%26%20authentication-development-infrastructure-access">Development Infrastructure Access<a class="headerlink" href="#run-security%20%26%20authentication-development-infrastructure-access" title="Permanent link">#</a></h3>
<p>Access ( Login Credentials ) to the 3 servers ( Build , Data and Compute) is with DevOps team and won't be shared with anyone unless there is a necessity.</p>
<h3 id="run-security%20%26%20authentication-staging-infrastructure-access">Staging Infrastructure Access<a class="headerlink" href="#run-security%20%26%20authentication-staging-infrastructure-access" title="Permanent link">#</a></h3>
<p>Staging environment is being hosted in AWS Cloud.</p>
<p>Console access to the AWS account is restricted to DevOps team and team is responsible for providing the cloud access for rest of them if necessary.</p>
<p>Developers are having individual ssh keys to connect to the databases (Postgres, Mongo) of staging environment.</p>
<h3 id="run-security%20%26%20authentication-k8s-secrets-in-dev-staging">K8s secrets in DEV &amp; Staging<a class="headerlink" href="#run-security%20%26%20authentication-k8s-secrets-in-dev-staging" title="Permanent link">#</a></h3>
<p>We created a k8s secret to pull the docker image from GitLab container registry and access token used in this secret will expire for every 3 months.</p>
<p>We need to recreate this secret for every 3 months, so that k8s can happily pull the images from GitLab container registry.</p>
<p>Otherwise status of the all application pods will be "imagepullbackoff" state.</p>
<p>Below are the instructions to recreate the k8s secret.</p>
<div class="highlight"><pre><span></span><code>kubectl create secret docker-registry regcred --docker-server=gitlabnew.techwave.net:5050 --docker-username=mshivaram --docker-password=your-gitlab-group-access-token --docker-email=shivaram.mantripragada@techwave.net
</code></pre></div>
<p>In the above command, gitlab-group-access-token can be retrieved from GitLab UI -&gt; Settings -&gt; Access Tokens -&gt; Add new access token</p>
<p>To expose the secret as k8s manifest:</p>
<p><div class="highlight"><pre><span></span><code>kubectl get secret regcred --output=yaml
</code></pre></div>
store the cleaned output as a k8s manifest, see helm/templates/secrets.yaml for an gitlab docker registry secret stored as a k8s manifest.</p>
<p>Update both allfunds and accounting helm charts, commit the changes and rollout the deployment via pipeline in both the environments.</p></section><section class="print-page" id="run-build-server"><h1 id="run-build-server-build-server">Build Server<a class="headerlink" href="#run-build-server-build-server" title="Permanent link">#</a></h1>
<h2 id="run-build-server-bill-of-materials">Bill of Materials<a class="headerlink" href="#run-build-server-bill-of-materials" title="Permanent link">#</a></h2>
<p>Following are the softwares along with their versions running in Build environment</p>
<table>
<thead>
<tr>
<th>Software</th>
<th>Version</th>
</tr>
</thead>
<tbody>
<tr>
<td>Gitlab-runner</td>
<td>16.2.0</td>
</tr>
<tr>
<td>aws-cli</td>
<td>2.15.21</td>
</tr>
<tr>
<td>docker</td>
<td>20.10.21</td>
</tr>
<tr>
<td>docker-compose</td>
<td>1.29.2</td>
</tr>
<tr>
<td>reposolite</td>
<td>3.4.10</td>
</tr>
<tr>
<td>Makedocs</td>
<td>1.5.3</td>
</tr>
<tr>
<td>SonarQube</td>
<td>9-community</td>
</tr>
<tr>
<td>helm</td>
<td>v3.14.2</td>
</tr>
<tr>
<td>owasp-depscan</td>
<td>ghcr.io/owasp-dep-scan/dep-scan</td>
</tr>
</tbody>
</table>
<h1 id="run-build-server-setup">Setup<a class="headerlink" href="#run-build-server-setup" title="Permanent link">#</a></h1>
<h2 id="run-build-server-gitlab-runner">Gitlab-Runner<a class="headerlink" href="#run-build-server-gitlab-runner" title="Permanent link">#</a></h2>
<h3 id="run-build-server-install">Install<a class="headerlink" href="#run-build-server-install" title="Permanent link">#</a></h3>
<p>Download</p>
<div class="highlight"><pre><span></span><code>sudo curl -L --output /usr/local/bin/gitlab-runner &quot;https://s3.dualstack.us-east-1.amazonaws.com/gitlab-runner-downloads/latest/binaries/gitlab-runner-linux-amd64&quot;
</code></pre></div>
<p>Give it permissions to execute:</p>
<div class="highlight"><pre><span></span><code>sudo chmod +x /usr/local/bin/gitlab-runner
</code></pre></div>
<p>Create a GitLab CI user:</p>
<div class="highlight"><pre><span></span><code>sudo useradd --comment &#39;gitlab-runner&#39; --create-home gitlab-runner --shell /bin/bash
</code></pre></div>
<p>Install and run as service:</p>
<p><div class="highlight"><pre><span></span><code>/usr/bin/gitlab-runner run --working-directory /home/gitlab-runner --config /etc/gitlab-runner/config.toml --service gitlab-runner --user gitlab-runner

sudo gitlab-runner start
</code></pre></div>
Advanced configuration:</p>
<p>To change the behavior of GitLab Runner and individual registered runners, modify the config.toml file.</p>
<p>We can find the config.toml file in:</p>
<ul>
<li>/etc/gitlab-runner/ on *nix systems when GitLab Runner is executed as root. This directory is also the path for service configuration.</li>
<li>~/.gitlab-runner/ on *nix systems when GitLab Runner is executed as non-root.</li>
<li>./ on other systems.</li>
</ul>
<p>GitLab Runner does not require a restart when you change most options. This includes parameters in the [[runners]] section and most parameters in the global section, except for listen_address. If a runner was already registered, you donâ€™t need to register it again.</p>
<p>GitLab Runner checks for configuration modifications every 3 seconds and reloads if necessary. GitLab Runner also reloads the configuration in response to the SIGHUP signal.</p>
<h3 id="run-build-server-register-runner">Register Runner<a class="headerlink" href="#run-build-server-register-runner" title="Permanent link">#</a></h3>
<p>Prerequisites:</p>
<p>Obtain a runner authentication token. You can either:</p>
<ul>
<li>Create a shared, group, or project runner.</li>
<li>Locate the runner authentication token in the config.toml file. Runner authentication tokens have the prefix, glrt-.</li>
</ul>
<p>After registering the runner, the configuration is saved to the config.toml.</p>
<p>To register the runner with a runner authentication token:</p>
<p>Run the register command:
<div class="highlight"><pre><span></span><code>sudo gitlab-runner register
</code></pre></div>
Enter your GitLab URL</p>
<ul>
<li>For runners on GitLab self-managed, use the URL for your GitLab instance. For example, if your project is hosted on gitlab.example.com/yourname/yourproject, your GitLab instance URL is https://gitlab.example.com.</li>
<li>For runners on GitLab.com, the gitlab-ci coordinator URL is https://gitlab.com. </li>
</ul>
<p>Our gitlab-ci coordinator URL is https://gitlabnew.techwave.net</p>
<p>Enter the runner authentication token.</p>
<p>Enter a name for the runner.</p>
<p>Enter the type of executor.</p>
<p>To register multiple runners on the same host machine, each with a different configuration, repeat the register command.</p>
<h3 id="run-build-server-update-the-gitlab-runner">Update the Gitlab-runner<a class="headerlink" href="#run-build-server-update-the-gitlab-runner" title="Permanent link">#</a></h3>
<p>1.Stop the service (we need elevated command prompt as before):
<div class="highlight"><pre><span></span><code>sudo gitlab-runner stop
</code></pre></div>
2.Download the binary to replace the GitLab Runner executable. For example:
<div class="highlight"><pre><span></span><code>sudo curl -L --output /usr/local/bin/gitlab-runner &quot;https://s3.dualstack.us-east-1.amazonaws.com/gitlab-runner-downloads/latest/binaries/gitlab-runner-linux-amd64&quot;
</code></pre></div>
3.Give it permissions to execute:
<div class="highlight"><pre><span></span><code>sudo chmod +x /usr/local/bin/gitlab-runner
</code></pre></div>
4.Start the service:
<div class="highlight"><pre><span></span><code>sudo gitlab-runner start
</code></pre></div></p>
<h2 id="run-build-server-aws-cli">aws-cli<a class="headerlink" href="#run-build-server-aws-cli" title="Permanent link">#</a></h2>
<p>The latest AWS CLI version is 2. So download the AWS CLI.
<div class="highlight"><pre><span></span><code>curl &quot;https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip&quot; -o &quot;awscliv2.zip&quot;
</code></pre></div></p>
<p>Unzip the file using the following command.
<div class="highlight"><pre><span></span><code>unzip awscliv2.zip
</code></pre></div></p>
<p>Install the AWS CLI using the following command.
<div class="highlight"><pre><span></span><code>sudo ./aws/install
</code></pre></div>
We can get the AWS CLI version using the below command.
<div class="highlight"><pre><span></span><code>aws --version
</code></pre></div></p>
<h2 id="run-build-server-docker">Docker<a class="headerlink" href="#run-build-server-docker" title="Permanent link">#</a></h2>
<p>The Docker installation package available in the official Ubuntu repository may not be the latest version. To ensure we get the latest version, weâ€™ll install Docker from the official Docker repository. To do that, weâ€™ll add a new package source, add the GPG key from Docker to ensure the downloads are valid, and then install the package.</p>
<p>First, update your existing list of packages:
<div class="highlight"><pre><span></span><code>sudo apt update
</code></pre></div>
Next, install a few prerequisite packages which let apt use packages over HTTPS:
<div class="highlight"><pre><span></span><code>sudo apt install apt-transport-https ca-certificates curl software-properties-common
</code></pre></div>
Then add the GPG key for the official Docker repository to your system:
<div class="highlight"><pre><span></span><code>curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
</code></pre></div>
Add the Docker repository to APT sources:
<div class="highlight"><pre><span></span><code>sudo add-apt-repository &quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu focal stable&quot;
</code></pre></div>
This will also update our package database with the Docker packages from the newly added repo.</p>
<p>Make sure to install from the Docker repo instead of the default Ubuntu repo:
<div class="highlight"><pre><span></span><code>apt-cache policy docker-ce
</code></pre></div>
Finally, install Docker:
<div class="highlight"><pre><span></span><code>sudo apt install docker-ce
</code></pre></div>
Docker should now be installed, the daemon started, and the process enabled to start on boot. Check that itâ€™s running:
<div class="highlight"><pre><span></span><code>sudo systemctl status docker
</code></pre></div></p>
<h2 id="run-build-server-docker-compose">docker-compose<a class="headerlink" href="#run-build-server-docker-compose" title="Permanent link">#</a></h2>
<p>Prerequisites</p>
<ul>
<li>Make sure Docker installed on server</li>
</ul>
<p>Download the executable
<div class="highlight"><pre><span></span><code>sudo curl -L &quot;https://github.com/docker/compose/releases/download/1.29.2/docker-compose-$(uname -s)-$(uname -m)&quot; -o /usr/local/bin/docker-compose
</code></pre></div>
Next, set the correct permissions so that the docker-compose command is executable:
<div class="highlight"><pre><span></span><code>sudo chmod +x /usr/local/bin/docker-compose
</code></pre></div>
To verify that the installation was successful, run:
<div class="highlight"><pre><span></span><code>docker-compose --version
</code></pre></div></p>
<h2 id="run-build-server-helm">helm<a class="headerlink" href="#run-build-server-helm" title="Permanent link">#</a></h2>
<p>Use wget to download the latest version of Helm. The download links for all supported architectures are available on the official website.
<div class="highlight"><pre><span></span><code>wget https://get.helm.sh/helm-v3.9.3-linux-amd64.tar.gz
</code></pre></div>
Next, unpack the Helm file using the Linux tar command:
<div class="highlight"><pre><span></span><code>tar xvf helm-v3.9.3-linux-amd64.tar.gz
</code></pre></div>
Move the linux-amd64/helm file to the /usr/local/bin directory
<div class="highlight"><pre><span></span><code>sudo mv linux-amd64/helm /usr/local/bin
</code></pre></div>
Remove the downloaded file using the following command:
<div class="highlight"><pre><span></span><code>rm helm-v3.4.1-linux-amd64.tar.gz   
</code></pre></div>
Remove the linux-amd64 directory to clean up space by running:
<div class="highlight"><pre><span></span><code>rm -rf linux-amd64
</code></pre></div>
Finally, verify you have successfully installed Helm by checking the version of the software:
<div class="highlight"><pre><span></span><code>helm version
</code></pre></div></p>
<h2 id="run-build-server-sonarqube">SonarQube<a class="headerlink" href="#run-build-server-sonarqube" title="Permanent link">#</a></h2>
<p>In order to quickly configure and manage the SonarQube server we will be using the docker-compose file which will set up a sonar instance along with the postgres database.</p>
<p>The docker-compose.yml file is located at the below directory.</p>
<p>/home/build/Fintrust/sonarqube-docker</p>
<p>To set up the sonar server along with postgres just run the below command which will pull in all the specified images for sonar and Postgres and will start up the containers using which we can access our server.
<div class="highlight"><pre><span></span><code>docker-compose up -d 
</code></pre></div>
Post running the above command, verify if images are downloaded and containers are up and running using the below commands.
<div class="highlight"><pre><span></span><code>docker images
</code></pre></div>
<div class="highlight"><pre><span></span><code>docker ps
</code></pre></div>
Connect to our Sonar server using the instance public-ip address along with the port which we had specified: 9000</p>
<p>In our case it is http://172.16.8.234:9090</p>
<p>In order to tear down the complete infra, we can run the below command which will remove all the containers and our server will no longer be accessible.
<div class="highlight"><pre><span></span><code>docker-compose down
</code></pre></div></p>
<h2 id="run-build-server-reposilite">Reposilite<a class="headerlink" href="#run-build-server-reposilite" title="Permanent link">#</a></h2>
<p>Reposilite (formerly NanoMaven) is lightweight repository manager for Maven artifacts. It is a simple solution to replace managers like Nexus, Archiva or Artifactory.</p>
<p>Prerequisites"</p>
<ul>
<li>
<p>Java 8+</p>
</li>
<li>
<p>RAM 12MB+</p>
</li>
</ul>
<p>Download the Reposilite from GitHub release page</p>
<p><a href="https://github.com/dzikoysk/reposilite/releases">reposilite</a></p>
<p>Reposilite stores data in current working directory, by default it is a place where we've launched it , below is the path.</p>
<p>/home/build/Fintrust/reposilite</p>
<p>We have a script to start the reposilte which is located at the below path</p>
<p>/home/build/Fintrust/reposilite/start-reposilite.sh</p>
<p>Access it using the below address</p>
<p>http://172.16.8.234:80</p>
<h3 id="run-build-server-add-reposilite-to-the-init-service-and-let-it-run-under-non-root-context-using-supervisor">Add reposilite to the init service and let it run under non-root context using Supervisor<a class="headerlink" href="#run-build-server-add-reposilite-to-the-init-service-and-let-it-run-under-non-root-context-using-supervisor" title="Permanent link">#</a></h3>
<p>Begin by updating package sources and installing Supervisor:
<div class="highlight"><pre><span></span><code>sudo apt update &amp;&amp; sudo apt install supervisor
</code></pre></div>
The supervisor service runs automatically after installation. You can check its status:
<div class="highlight"><pre><span></span><code>sudo systemctl status supervisor
</code></pre></div>
A best practice for working with Supervisor is to write a configuration file for every program it will handle.</p>
<p>The per-program configuration files for Supervisor programs are located in the /etc/supervisor/conf.d directory, typically running one program per file and ending in .conf. Weâ€™ll create a configuration file for this script, as /etc/supervisor/conf.d/repo.conf:</p>
<p>Make the script executable
<div class="highlight"><pre><span></span><code>chmod +x /etc/supervisor/conf.d/repo.conf
</code></pre></div>
Once our configuration file is created and saved, we can inform Supervisor of our new program through the supervisorctl command. First we tell Supervisor to look for any new or changed program configurations in the /etc/supervisor/conf.d directory with:
<div class="highlight"><pre><span></span><code>sudo supervisorctl reread
</code></pre></div>
Followed by telling it to enact any changes with:
<div class="highlight"><pre><span></span><code>sudo supervisorctl update
</code></pre></div>
Any time we make a change to any program configuration file, running the two previous commands will bring the changes into effect.</p>
<h2 id="run-build-server-mkdocs">Mkdocs<a class="headerlink" href="#run-build-server-mkdocs" title="Permanent link">#</a></h2>
<p>Makesure pip is installed in system</p>
<p>We have wiki repository available which contains the Dockerfile and makedocs.yml to install and configure the Makedocs.</p>
<pre><code>Repository URL : https://gitlabnew.techwave.net/fintrust/wiki
</code></pre>
<p>Check the below documentation for more information</p>
<pre><code>https://www.mkdocs.org/getting-started/#getting-started-with-mkdocs
</code></pre>
<h2 id="run-build-server-depscan">Depscan<a class="headerlink" href="#run-build-server-depscan" title="Permanent link">#</a></h2>
<p>OWASP dep-scan is a next-generation security and risk audit tool based on known vulnerabilities, advisories, and license limitations for project dependencies. 
Both local repositories and container images are supported as the input, and the tool is ideal for integration with ASPM/VM platforms and in CI environments.</p>
<h3 id="run-build-server-features">Features<a class="headerlink" href="#run-build-server-features" title="Permanent link">#</a></h3>
<ul>
<li>Scan most application code - local repos, Linux container images, Kubernetes manifests, and OS - to identify known CVEs with prioritization</li>
<li>Perform advanced reachability analysis for multiple languages</li>
<li>Package vulnerability scanning is performed locally and is quite fast. No server is used!</li>
<li>Generate Software Bill-of-Materials (SBOM) with Vulnerability Disclosure Report (VDR) information</li>
<li>Generate a Common Security Advisory Framework (CSAF) 2.0 VEX document </li>
<li>Perform deep packages risk audit for dependency confusion attacks and maintenance risks </li>
</ul>
<h3 id="run-build-server-vulnerability-datasources">Vulnerability DataSources<a class="headerlink" href="#run-build-server-vulnerability-datasources" title="Permanent link">#</a></h3>
<ul>
<li>OSV</li>
<li>NVD</li>
<li>GitHub</li>
<li>NPM</li>
<li>Linux vuln-list</li>
</ul>
<p>Application vulnerabilities would be reported for all Linux distros and Windows. </p>
<p>To download the full vulnerability database suitable for scanning OS, invoke dep-scan with `` for the first time. </p>
<p>dep-scan would also download the appropriate database based on project type automatically.</p>
<h3 id="run-build-server-usage">*Usage<a class="headerlink" href="#run-build-server-usage" title="Permanent link">#</a></h3>
<p>dep-scan is ideal for use during continuous integration (CI) and as a local development tool.</p>
<h3 id="run-build-server-scanning-projects-locally-python-version">Scanning projects locally (Python version)<a class="headerlink" href="#run-build-server-scanning-projects-locally-python-version" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code>sudo npm install -g @cyclonedx/cdxgen
pip install owasp-depscan
</code></pre></div>
<p>This would install two commands called cdxgen and depscan.</p>
<p>We can invoke the scan command directly with the various options.
<div class="highlight"><pre><span></span><code>cd &lt;project to scan&gt;
depscan --src $PWD --reports-dir $PWD/reports
</code></pre></div></p>
<h3 id="run-build-server-scanning-projects-locally-docker-container">Scanning projects locally (Docker container)<a class="headerlink" href="#run-build-server-scanning-projects-locally-docker-container" title="Permanent link">#</a></h3>
<ul>
<li>ghcr.io/owasp-dep-scan/dep-scan container image can be used to perform the scan. </li>
</ul>
<p>To scan with default settings
<div class="highlight"><pre><span></span><code>docker run --rm -v $PWD:/app ghcr.io/owasp-dep-scan/dep-scan --src /app --reports-dir /app/reports
</code></pre></div></p>
<h3 id="run-build-server-integration-in-fintrust-gitlab-cicd">Integration in Fintrust GitLab CI/CD<a class="headerlink" href="#run-build-server-integration-in-fintrust-gitlab-cicd" title="Permanent link">#</a></h3>
<p>We integrated the docker setup of depscan in code scan stage of CI/CD using the below command
<div class="highlight"><pre><span></span><code>docker run --rm -v $PWD:/app ghcr.io/owasp-dep-scan/dep-scan --src /app --reports-dir /app/reports
</code></pre></div>
But with the above setup, the depscan reports are generated with 'root' user, which are unable to clear by the gitlab-runner user for the subsequent build</p>
<p>Able to fix the issue using by passing the user and group while running the docker command
<div class="highlight"><pre><span></span><code>docker run --rm -v $PWD:/app --user $(id -u):$(id -g) ghcr.io/owasp-dep-scan/dep-scan --src /app --reports-dir /app/reports 
</code></pre></div>
But the above command throws an error, because process inside the container is trying to create a  file at the root level (/.local), but it doesn't have the necessary permissions.</p>
<p>Able to fix the issue by setting up an HOME directory, so that the file will be created in /tmp directory.
<div class="highlight"><pre><span></span><code>docker run --rm -v $PWD:/app --user $(id -u):$(id -g) -e HOME=/tmp ghcr.io/owasp-dep-scan/dep-scan --src /app --reports-dir /app/reports 
</code></pre></div>
To download the depscan reports as an artifacts, written the stage as below.</p>
<pre><code> artifacts:
    when: always
    name: depscan-reports
    paths:
    - reports
</code></pre>
<p>For reference, please visit <a href="https://github.com/owasp-dep-scan/dep-scan?tab=readme-ov-file#scanning-projects-locally-docker-container">depscan</a></p></section>
                        <h2 class='nav-section-title' id='section-environments'>
                            Environments <a class='headerlink' href='#section-environments' title='Permanent link'>â†µ</a>
                        </h2>
                        
                        <h3 class='nav-section-title' id='section-development'>
                            Development <a class='headerlink' href='#section-development' title='Permanent link'>â†µ</a>
                        </h3>
                        <section class="print-page" id="run-environments-development-overview"><h1 id="run-environments-development-overview-overview">Overview<a class="headerlink" href="#run-environments-development-overview-overview" title="Permanent link">#</a></h1>
<p>This page presents an overview of our development environment.</p>
<h2 id="run-environments-development-overview-infrastructure">Infrastructure<a class="headerlink" href="#run-environments-development-overview-infrastructure" title="Permanent link">#</a></h2>
<p>Following on-premise infrastructure is available in DEV environment</p>
<h2 id="run-environments-development-overview-build-server">Build Server<a class="headerlink" href="#run-environments-development-overview-build-server" title="Permanent link">#</a></h2>
<p>The build server is responsible for executing CI/CD pipelines and also housing development tools such as Reposilite, SonarQube etc.</p>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Remarks</th>
</tr>
</thead>
<tbody>
<tr>
<td>hostname</td>
<td>TWDSDL-0973</td>
</tr>
<tr>
<td>OS</td>
<td>Ubuntu 22.04.2 LTS</td>
</tr>
<tr>
<td>IPAddress</td>
<td>172.16.8.234</td>
</tr>
<tr>
<td>CPU</td>
<td>12 CPU</td>
</tr>
<tr>
<td>RAM</td>
<td>32 GB</td>
</tr>
</tbody>
</table>
<h2 id="run-environments-development-overview-compute-server">Compute Server<a class="headerlink" href="#run-environments-development-overview-compute-server" title="Permanent link">#</a></h2>
<p>The compute server hosts all our application components</p>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Remarks</th>
</tr>
</thead>
<tbody>
<tr>
<td>hostname</td>
<td>TWDSDL-1002</td>
</tr>
<tr>
<td>OS</td>
<td>Ubuntu 20.04.2 LTS</td>
</tr>
<tr>
<td>IPAddress</td>
<td>172.16.22.22</td>
</tr>
<tr>
<td>CPU</td>
<td>12 CPU</td>
</tr>
<tr>
<td>RAM</td>
<td>32 GB</td>
</tr>
</tbody>
</table>
<h2 id="run-environments-development-overview-data-server">Data Server<a class="headerlink" href="#run-environments-development-overview-data-server" title="Permanent link">#</a></h2>
<p>The data server hosts all our data</p>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Remarks</th>
</tr>
</thead>
<tbody>
<tr>
<td>hostname</td>
<td>twinh-des-0977</td>
</tr>
<tr>
<td>OS</td>
<td>Ubuntu 20.04.6 LTS</td>
</tr>
<tr>
<td>IPAddress</td>
<td>172.16.22.16</td>
</tr>
<tr>
<td>CPU</td>
<td>12 CPU</td>
</tr>
<tr>
<td>RAM</td>
<td>16 GB</td>
</tr>
</tbody>
</table>
<h2 id="run-environments-development-overview-topology">Topology<a class="headerlink" href="#run-environments-development-overview-topology" title="Permanent link">#</a></h2>
<p>This section describes the topology of the Compute,Data and Build Servers.</p>
<p><img alt="Fintrust Developmnent Enviroment" src="../Run/Environments/Development/fintrust-development-enviornments.jpg" /></p>
<p>We are storing the source code, configuration files, deployment manifests along with helm chart in techwave hosted gitlab (https://gitlabnew.techwave.net)</p>
<p>Developers/Devops engineers commits the code/configuration into the gitlab source code repositories.</p>
<p>After code commit, the pipelines triggers the series of actions describe in .gitlab-ci.yml which is stoed in every module repository.</p>
<p>Gitlab-runner (Agent for Gitlab) which is running in the build server take care of CI/CD pipelines.</p>
<p>Below is the entire topology (inlcudes CI/CD, testing, deployment, and logging) of the development environment.</p>
<ul>
<li>
<p>Code fetch from respective repository to the gitlab-runner workspace.</p>
</li>
<li>
<p>Builds the code using the maven and pushes the executable (.jar file) into the reposilite which is hosted on the same server.</p>
</li>
<li>
<p>Code analysis and reports generation using SonarQube which is runing on the same server on port 9000.</p>
</li>
<li>
<p>Developers can check the generate reports from SonarQube for further analysis.</p>
</li>
<li>
<p>Next, depscan (hosted in docker container) scans the code for the vulnerabilities and generates a detailed report about the severity of 
vulnerabilities and actions need to be performed to mitigate.</p>
</li>
<li>
<p>Developers/Devops can download the depscan report from Gitlab CI/CD pipleine artifacts.</p>
</li>
<li>
<p>Docker images are built using the Dockerfile stored in the respective repository.</p>
</li>
<li>
<p>Then docker image is pushed into the Gitlab Container Registry</p>
</li>
<li>
<p>To perform the automation testing, an automation environment is provisioned on-demand, and after the tessting, it will be destroyed.</p>
</li>
<li>
<p>Testers/Devops can view the summary of automation testcases report via CI/CD pipeline artifacts</p>
</li>
<li>
<p>A deployment repository (af-devops) takes care of automation testing, deployments in development &amp; staging environment respectively. The pipeline will take care of the following things.</p>
<ul>
<li>
<p>Packages the application helm charts and pushes to Gitlab package registry.</p>
</li>
<li>
<p>Installs the automation environment in minikube using the application helm charts.</p>
</li>
<li>
<p>Runs the testcases on automation environment, and generates the summary of testcases.</p>
</li>
<li>
<p>Destroys the automation environment, after automation testing.</p>
</li>
<li>
<p>Deploys application in compute server (development environment) on minikube.</p>
</li>
<li>
<p>Runs smoke tests in compute server (development environment).</p>
</li>
<li>
<p>Deploys the application in staging environment in EKS cluster which is in AWS cloud.</p>
</li>
</ul>
</li>
<li>
<p>Databases like Postgres, Mongo and message broker RabbitMQ are hosted in Data server as docker containers.</p>
</li>
<li>
<p>Application running on the compute server (development environment) connects to the databases, message broker running on data server. Docker volumes are on the same dataserver for these data &amp; message broker containers.</p>
</li>
<li>
<p>Application is divided into parts:</p>
<p>1.Allfunds</p>
<p>2.Accounting</p>
</li>
<li>
<p>Nginx-ingress-controller is in place to route the traffic to application ( Allfunds )</p>
</li>
<li>
<p>When request comes from the internet to the application url "https://fintrust-dev.techwave.net", it resolves to 182.156.74.101 which is the public IP of NAT Gateway.</p>
</li>
<li>
<p>NAT GW then nats the address to 172.16.22.22 which is IP address of the compute server.</p>
</li>
<li>
<p>SSL termination happens at Caddy which have built in feature called letsencrypt, which takes care of certificates and their auto renewal.</p>
</li>
<li>
<p>From caddy, it goes to ingress which has path based routing to the modules running on minikube.</p>
</li>
<li>
<p>Accounting modules aren't exposed outside, allfunds modules communicates with accounting modules using the k8s service names whenever necessary.</p>
</li>
<li>
<p>Accounting modules are exposed via Kubernetes Nodeport service.</p>
</li>
<li>
<p>HAPROXY routes are configured on these nodeports of accounting modules in haproxy configuration file.</p>
</li>
<li>
<p>Developers/QA are using these tunnels to access/test the accounting APIs whenever necessary.</p>
</li>
<li>
<p>For application logging, Openobserve tool is configured on compute server.</p>
</li>
<li>
<p>Light-weight logging agent, fluent-bit collects the logs from application pods and redirects those to openobserve which we can view in UI. </p>
</li>
</ul></section><section class="print-page" id="run-environments-development-setup"><h1 id="run-environments-development-setup-setup">Setup<a class="headerlink" href="#run-environments-development-setup-setup" title="Permanent link">#</a></h1>
<h2 id="run-environments-development-setup-setup-of-dev-server"><strong>Setup of Dev Server</strong><a class="headerlink" href="#run-environments-development-setup-setup-of-dev-server" title="Permanent link">#</a></h2>
<p>Following are the softwares along with their versions running in the DEV </p>
<table>
<thead>
<tr>
<th>Software</th>
<th>Version</th>
</tr>
</thead>
<tbody>
<tr>
<td>Docker</td>
<td>24.0.4</td>
</tr>
<tr>
<td>minikube</td>
<td>v1.30.1</td>
</tr>
<tr>
<td>kubectl</td>
<td>v1.27.3</td>
</tr>
<tr>
<td>haproxy</td>
<td>2.0.31-0ubuntu0.3</td>
</tr>
<tr>
<td>caddy</td>
<td>v2.6.4</td>
</tr>
<tr>
<td>kestra</td>
<td>kestra/kestra:latest-full</td>
</tr>
<tr>
<td>openobserve</td>
<td>v0.7.0</td>
</tr>
</tbody>
</table>
<h3 id="run-environments-development-setup-docker">Docker<a class="headerlink" href="#run-environments-development-setup-docker" title="Permanent link">#</a></h3>
<p>The Docker installation package available in the official Ubuntu repository may not be the latest version. To ensure we get the latest version, weâ€™ll install Docker from the official Docker repository. To do that, weâ€™ll add a new package source, add the GPG key from Docker to ensure the downloads are valid, and then install the package.</p>
<p>First, update your existing list of packages:
<div class="highlight"><pre><span></span><code> sudo apt update
</code></pre></div>
Next, install a few prerequisite packages which let apt use packages over HTTPS:
<div class="highlight"><pre><span></span><code>sudo apt install apt-transport-https ca-certificates curl software-properties-common
</code></pre></div>
Then add the GPG key for the official Docker repository to your system:
<div class="highlight"><pre><span></span><code>curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
</code></pre></div>
Add the Docker repository to APT sources:
<div class="highlight"><pre><span></span><code>sudo add-apt-repository &quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu focal stable&quot;
</code></pre></div>
This will also update our package database with the Docker packages from the newly added repo.</p>
<p>Make sure to install from the Docker repo instead of the default Ubuntu repo:
<div class="highlight"><pre><span></span><code>apt-cache policy docker-ce
</code></pre></div>
Finally, install Docker:
<div class="highlight"><pre><span></span><code>sudo apt install docker-ce
</code></pre></div>
Docker should now be installed, the daemon started, and the process enabled to start on boot. Check that itâ€™s running:
<div class="highlight"><pre><span></span><code>sudo systemctl status docker
</code></pre></div></p>
<h3 id="run-environments-development-setup-minikube">Minikube<a class="headerlink" href="#run-environments-development-setup-minikube" title="Permanent link">#</a></h3>
<p>Minikube is an open source tool that allows you to set up a single-node Kubernetes cluster on our local machine. The cluster is run inside a virtual machine and includes Docker, allowing us to run containers inside the node.</p>
<p>This is an excellent way to test in a Kubernetes environment locally, without using up too much resources</p>
<p>Prereuisites:</p>
<ul>
<li>2 CPUs or more</li>
<li>2GB of free memory</li>
<li>20GB of free disk space</li>
<li>Internet connection</li>
<li>Container or virtual machine manager, such as: Docker, QEMU, Hyperkit, Hyper-V, KVM, Parallels, Podman, VirtualBox, or VMware Fusion/Workstation</li>
</ul>
<p>1.Installation</p>
<p>To install the latest minikube stable release on x86-64 Linux using binary download:
<div class="highlight"><pre><span></span><code>curl -LO https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64
sudo install minikube-linux-amd64 /usr/local/bin/minikube
</code></pre></div>
Next, give the file executive permission using the chmod command:
<div class="highlight"><pre><span></span><code>sudo chmod 755 /usr/local/bin/minikube
</code></pre></div>
2.Start minikube cluster</p>
<p>From a terminal with administrator access (but not logged in as root), run:
<div class="highlight"><pre><span></span><code>minikube start
</code></pre></div>
3.Manage minikube cluster</p>
<p>Pause Kubernetes without impacting deployed applications:
<div class="highlight"><pre><span></span><code>minikube pause
</code></pre></div>
Unpause a paused instance:
<div class="highlight"><pre><span></span><code>minikube unpause
</code></pre></div>
Halt the cluster:
<div class="highlight"><pre><span></span><code>minikube stop
</code></pre></div>
Browse the catalog of easily installed Kubernetes services
<div class="highlight"><pre><span></span><code>minikube addons list
</code></pre></div>
The below list of addons are enabled on our DEV minikube</p>
<ul>
<li>
<p>default-storageclass</p>
</li>
<li>
<p>ingress</p>
</li>
<li>
<p>ingress-dns</p>
</li>
<li>
<p>metrics-server</p>
</li>
<li>
<p>storage-provisioner</p>
</li>
</ul>
<p>To login into the minikube:
<div class="highlight"><pre><span></span><code>minikube ssh
</code></pre></div>
To get the IP of minikube:
<div class="highlight"><pre><span></span><code>minikube ip
</code></pre></div></p>
<h3 id="run-environments-development-setup-kubectl">Kubectl<a class="headerlink" href="#run-environments-development-setup-kubectl" title="Permanent link">#</a></h3>
<p>To deploy and manage clusters, we need to install kubectl, the official command line tool for Kubernetes.</p>
<p>1.Download kubectl with the following command
<div class="highlight"><pre><span></span><code>$ curl -LO https://storage.googleapis.com/kubernetes-release/release/`curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt`/bin/linux/amd64/kubectl
</code></pre></div>
2.Make the binary executable by typing
<div class="highlight"><pre><span></span><code>chmod +x ./kubectl
</code></pre></div>
3.Then, move the binary into your path with the command:
<div class="highlight"><pre><span></span><code>sudo mv ./kubectl /usr/local/bin/kubectl
</code></pre></div>
4.Verify the installation by checking the version of your kubectl instance:
<div class="highlight"><pre><span></span><code>kubectl version --short
</code></pre></div></p>
<h3 id="run-environments-development-setup-haproxy">HAPROXY<a class="headerlink" href="#run-environments-development-setup-haproxy" title="Permanent link">#</a></h3>
<p>HAProxy, which stands for High Availability Proxy, is a popular open source software TCP/HTTP Load Balancer and proxying solution which can be run on Linux, macOS, and FreeBSD.</p>
<p>Its most common use is to improve the performance and reliability of a server environment by distributing the workload across multiple servers (e.g. web, application, database).</p>
<p>Installation
<div class="highlight"><pre><span></span><code>sudo apt install --no-install-recommends software-properties-common

sudo add-apt-repository ppa:vbernat/haproxy-2.4 -y
</code></pre></div>
The first command installs the software-properties-common package which helps you manage any PPAs you install. Itâ€™s probably already installed, but running it again ensures that itâ€™s available. </p>
<p>The second command puts the PPA into the list of software sources.</p>
<p>Weâ€™re now ready to install the very latest HAProxy:
<div class="highlight"><pre><span></span><code>sudo apt install haproxy=2.3.\*
</code></pre></div>
To check the haproxy version 
<div class="highlight"><pre><span></span><code>haproxy -v
</code></pre></div>
acc-api, acc-bo, acc-analytics, mfusessionprovider modules are exposed publicly via HAProxy</p>
<p>We can find the routes configuration at /etc/haproxy/haproxy.cfg
<div class="highlight"><pre><span></span><code>frontend apiproxy
  mode tcp
  bind :18080
  default_backend k8s_api
backend k8s_api
  mode tcp
  balance leastconn
  server s4 192.168.49.2:30007
frontend boproxy
  mode tcp
  bind :18081
  default_backend k8s_bo
backend k8s_bo
  mode tcp
  balance leastconn
  server s5 192.168.49.2:30008
</code></pre></div></p>
<p>To check the status of haproxy, run 
<div class="highlight"><pre><span></span><code>systemctl status haproxy
</code></pre></div>
After the routes configuration in /etc/haproxy/haproxy.cfg , run the below command so that new routes will be available to access.
<div class="highlight"><pre><span></span><code>systemctl reload haproxy 
</code></pre></div></p>
<h3 id="run-environments-development-setup-caddy">Caddy<a class="headerlink" href="#run-environments-development-setup-caddy" title="Permanent link">#</a></h3>
<p>Caddy is a powerful, extensible platform to serve your sites, services, and apps</p>
<p>Most people use Caddy as a web server or proxy, but at its core, Caddy is a server of servers. With the requisite modules, it can take on the role of any long-running process.</p>
<p>Configuration is both dynamic and exportable with Caddy's API. Although no config files required, you can still use them; most people's favorite way of configuring Caddy is using the Caddyfile. The format of the config document takes many forms with config adapters, but Caddy's native config language is JSON.</p>
<p>Caddy compiles for all major platforms and has no runtime dependencies.</p>
<p>1.Installation</p>
<p>Download Caddy from the following releases pages , choose the version and system compatible one.</p>
<p><a href="https://github.com/caddyserver/caddy/releases">caddy</a></p>
<p>2.The Caddyfile</p>
<p>The Caddyfile is a convenient Caddy configuration format for humans. </p>
<p>It is most people's favorite way to use Caddy because it is easy to write, easy to understand, and expressive enough for most use cases.</p>
<p>We have Caddyfile available at below path in DEV environment
/home/laxma/software </p>
<p>3.Caddy has a standard unix-like command line interface. Basic usage is:
<div class="highlight"><pre><span></span><code>caddy start - Starts the Caddy process in the background

caddy run - Starts the Caddy process in the foreground

caddy stop - Stops the running Caddy process

caddy upgrade - Upgrades Caddy to the latest release

caddy file-server - A simple but production-ready file server

caddy reload - Changes the config of the running Caddy process
</code></pre></div></p>
<p>For more information, please check the below documentation</p>
<p><a href="https://caddyserver.com/docs/command-line">Caddy documentation</a></p>
<h3 id="run-environments-development-setup-kestra">Kestra<a class="headerlink" href="#run-environments-development-setup-kestra" title="Permanent link">#</a></h3>
<p>The chart repository is available under helm.kestra.io.</p>
<p>The source code of the charts can be found in the kestra-io/helm-charts repository.</p>
<p>1.Install the Chart
<div class="highlight"><pre><span></span><code>helm repo add kestra https://helm.kestra.io/
</code></pre></div>
By default, the chart will only deploy one Kestra standalone service with only one replica. This means that all Kestra server components will be deployed within a single pod.</p>
<p>2.Modify the kestra configuration to use the local storage
<div class="highlight"><pre><span></span><code>     configuration:
       kestra:
         storage:
           type: local
           local:
             base-path: /tmp/kestra/storage/
</code></pre></div>
3.Disable the default postgres deployment available in helm chart, and add our own datasource.
<div class="highlight"><pre><span></span><code>    configuration:
      datasources:
        postgres:
          url: jdbc:postgresql://172.16.22.16:5432/accounting?currentSchema=kestra
          driverClassName: org.postgresql.Driver
          username: ****
          password: ****

    #### Postgresql
    postgresql:
      enabled: false
      auth:
        database: kestra
        username: kestra
        password: kestra
      primary:
        persistence:
          enabled: false
          size: 8Gi
</code></pre></div></p>
<p>4.Disable all other deployments and enable only standalone deployment.
<div class="highlight"><pre><span></span><code>    deployments:
      webserver:
        enabled: false
        kind: Deployment
      executor:
        enabled: false
        kind: Deployment
        command: &quot;server executor&quot;
      indexer:
        enabled: false
        kind: Deployment
        command: &quot;server indexer&quot;
      scheduler:
        enabled: false
        kind: Deployment
        command: &quot;server scheduler&quot;
      worker:
        enabled: false
        kind: Deployment
        command: &quot;server worker --thread={{ .Values.deployments.worker.workerThreads }}&quot;
        terminationGracePeriodSeconds: 60
        workerThreads: 128
      standalone:
        enabled: true
        kind: Deployment
        command: &quot;server standalone --worker-thread={{ .Values.deployments.standalone.workerThreads }}&quot;
        terminationGracePeriodSeconds: 60
        workerThreads: 128
</code></pre></div>
5.Install the helm chart using the below command.
<div class="highlight"><pre><span></span><code>helm install kestra . -n kestra -f values.yaml
</code></pre></div>
6.Check the deployment, service and configmap using the below command.
<div class="highlight"><pre><span></span><code>kubectl get deployment -n kestra
kubectl get svc -n kestra
kubectl get cm -n kestra
</code></pre></div>
7.Create a temporary tunnel by port-forwarding the kestra-service.
<div class="highlight"><pre><span></span><code>kubectl -n kestra port-forward --address 0.0.0.0 svc/kestra-service 8080:8080
</code></pre></div>
8.Access the kestra at the below address</p>
<pre><code>http://172.16.22.22:8080/
</code></pre>
<h3 id="run-environments-development-setup-openobserve">Openobserve<a class="headerlink" href="#run-environments-development-setup-openobserve" title="Permanent link">#</a></h3>
<p>OpenObserve is a cloud native observability platform (Logs, Metrics, Traces) for real life log data, significantly lower operational cost and ease of use. </p>
<p>It can scale to petabytes of data, is highly performant and allows you to sleep better at night ðŸ˜€. </p>
<p>Check the more information at <a href="https://openobserve.ai/docs/">Openobserve documentation</a></p>
<p>Binaries can be downloaded from releases page for appropriate platform. <a href="https://github.com/openobserve/openobserve/releases">Openobserve</a></p>
<p>Created a script to run the "openobserve" executable which is available at below path</p>
<pre><code>/home/laxma/openobserve/openobserve_start.sh
</code></pre>
<p>Now point your browser to http://172.16.22.22:5080 and login</p>
<h4 id="run-environments-development-setup-configure-the-fluent-bit-for-the-logs-aggregation">Configure the fluent-bit for the logs aggregation<a class="headerlink" href="#run-environments-development-setup-configure-the-fluent-bit-for-the-logs-aggregation" title="Permanent link">#</a></h4>
<p>Fluentbit is a lightweight and open-source log forwarder for Kubernetes. It is designed to be fast and efficient.</p>
<p>It is also a part of the Fluentd ecosystem, which is a popular open-source log collector.</p>
<p>It works by tailing the files that contain the logs you want to forward. It then parses the logs and sends them to the destination you specify. </p>
<p>It can also enrich your logs with additional metadata, such as the Kubernetes pod name, pod ID, and container name</p>
<p>1.Install Fluentbit
<div class="highlight"><pre><span></span><code>helm repo add fluent https://fluent.github.io/helm-charts

helm repo update

helm upgrade --install fluent-bit fluent/fluent-bit --namespace fluent-bit --create-namespace
</code></pre></div></p>
<p>This will install FluentBit as a daemonset(A daemonset ensures that one and only one pod runs on every node of the cluster.) and create the necessary service accounts, roles, and configuration needed to run FluentBit on cluster. </p>
<p>Default values in the chart will enrich the logs with additional metadata, such as the Kubernetes pod name, pod ID, and container name.</p>
<p>2.Configure FluentBit to Forward Logs to OpenObserve</p>
<p>Once FluentBit is installed and running on your Kubernetes cluster, the next step is to configure FluentBit to send logs to OpenObserve</p>
<p>OpenObserve supports an HTTP endpoint, and FluentBit has an HTTP output plugin which we can use for this purpose.</p>
<p>To do this, we'll need to modify the FluentBit ConfigMap, specifically the OUTPUT section, to include the HTTP output plugin and the OpenObserve endpoint details.</p>
<p>Head over to OpenObserve UI &gt; Ingestion &gt; Logs &gt; Fluentbit and copy the configuration from there.</p>
<p>Get the default configmap for fluentbit that is part of the installation.
<div class="highlight"><pre><span></span><code>kubectl -n fluent-bit get configmap fluent-bit -o yaml &gt; fluent-bit.yaml
</code></pre></div>
This will create a file called fluent-bit.yaml in current directory. Open this file in editor and we will find two sections, for OUTPUT. </p>
<p>Paste the configuration that we got from OpenObserve UI in the fluent-bit.yaml file replacing 2 existing OUTPUT sections.</p>
<p>Check the manifest of fluentbit configmap at /home/laxma/openobserve/fluent-bit.yaml</p>
<p>3.Apply Changes and Start Forwarding Logs</p>
<p>Once ave updated the FluentBit ConfigMap, can apply the changes by running:
<div class="highlight"><pre><span></span><code>kubectl apply -f fluent-bit.yaml
</code></pre></div></p>
<p>One last step is to restart the FluentBit pods so that they pick up the new configuration
<div class="highlight"><pre><span></span><code>kubectl delete pods -n fluent-bit -l app.kubernetes.io/name=fluent-bit
</code></pre></div>
FluentBit should now begin to forward logs from cluster to the OpenObserve endpoint specified. We can then use OpenObserve UI to view and analyze the logs.</p>
<p>Reference doc:<a href="https://openobserve.ai/blog/how-to-send-kubernetes-logs-using-fluent-bit/">fluent-bit</a></p>
<h3 id="run-environments-development-setup-shell-auto-completion-for-kubectl">Shell Auto-Completion for Kubectl<a class="headerlink" href="#run-environments-development-setup-shell-auto-completion-for-kubectl" title="Permanent link">#</a></h3>
<p>kubectl provides autocompletion support for Bash, Zsh, Fish, and PowerShell, which can saves a lot of typing.</p>
<p>1.Install bash-completion
<div class="highlight"><pre><span></span><code>apt-get install bash-completion
</code></pre></div>
The above commands create /usr/share/bash-completion/bash_completion, which is the main script of bash-completion.</p>
<p>Depending on our package manager, we have to manually source this file in our ~/.bashrc file.
<div class="highlight"><pre><span></span><code>source /usr/share/bash-completion/bash_completion
</code></pre></div>
2.Enable kubectl autocompletion</p>
<p>Now we need to ensure that the kubectl completion script gets sourced in all our shell sessions.
<div class="highlight"><pre><span></span><code>echo &#39;source &lt;(kubectl completion bash)&#39; &gt;&gt;~/.bashrc
</code></pre></div>
After reloading our shell, kubectl autocompletion should be working. To enable bash autocompletion in current session of shell, source the bashrc file:
<div class="highlight"><pre><span></span><code>source ~/.bashrc
</code></pre></div></p>
<h2 id="run-environments-development-setup-setup-of-dev-replication-server"><strong>Setup of Dev Replication Server</strong><a class="headerlink" href="#run-environments-development-setup-setup-of-dev-replication-server" title="Permanent link">#</a></h2>
<p>Following are the softwares along with their versions running in Build environment</p>
<table>
<thead>
<tr>
<th>Software</th>
<th>Version</th>
</tr>
</thead>
<tbody>
<tr>
<td>Docker</td>
<td>24.0.7</td>
</tr>
<tr>
<td>docker-compose</td>
<td>1.29.2</td>
</tr>
</tbody>
</table>
<h3 id="run-environments-development-setup-docker_1">Docker<a class="headerlink" href="#run-environments-development-setup-docker_1" title="Permanent link">#</a></h3>
<p>The Docker installation package available in the official Ubuntu repository may not be the latest version. To ensure we get the latest version, weâ€™ll install Docker from the official Docker repository. To do that, weâ€™ll add a new package source, add the GPG key from Docker to ensure the downloads are valid, and then install the package.</p>
<p>First, update your existing list of packages:
<div class="highlight"><pre><span></span><code>sudo apt update
</code></pre></div>
Next, install a few prerequisite packages which let apt use packages over HTTPS:
<div class="highlight"><pre><span></span><code>sudo apt install apt-transport-https ca-certificates curl software-properties-common
</code></pre></div>
Then add the GPG key for the official Docker repository to your system:
<div class="highlight"><pre><span></span><code>curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
</code></pre></div>
Add the Docker repository to APT sources:
<div class="highlight"><pre><span></span><code>sudo add-apt-repository &quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu focal stable&quot;
</code></pre></div>
This will also update our package database with the Docker packages from the newly added repo.</p>
<p>Make sure to install from the Docker repo instead of the default Ubuntu repo:
<div class="highlight"><pre><span></span><code>apt-cache policy docker-ce
</code></pre></div>
Finally, install Docker:
<div class="highlight"><pre><span></span><code>sudo apt install docker-ce
</code></pre></div>
Docker should now be installed, the daemon started, and the process enabled to start on boot. Check that itâ€™s running:
<div class="highlight"><pre><span></span><code>sudo systemctl status docker
</code></pre></div></p>
<h3 id="run-environments-development-setup-docker-compose">docker-compose<a class="headerlink" href="#run-environments-development-setup-docker-compose" title="Permanent link">#</a></h3>
<p>Prerequisites:</p>
<ul>
<li>Make sure Docker installed on server</li>
</ul>
<p>Download the executable
<div class="highlight"><pre><span></span><code>sudo curl -L &quot;https://github.com/docker/compose/releases/download/1.29.2/docker-compose-$(uname -s)-$(uname -m)&quot; -o /usr/local/bin/docker-compose
</code></pre></div>
Next, set the correct permissions so that the docker-compose command is executable:
<div class="highlight"><pre><span></span><code>sudo chmod +x /usr/local/bin/docker-compose
</code></pre></div>
To verify that the installation was successful, run:
<div class="highlight"><pre><span></span><code>docker-compose --version
</code></pre></div></p>
<p>We are running 3 docker containers along with data volumes in this machine. Check them using below command.
<div class="highlight"><pre><span></span><code>docker ps
</code></pre></div>
We are running PostgresDB, MongoDB and RabbitMQ.</p>
<p>Respective docker-compose files for these DBs and message brokers are available at:</p>
<pre><code>/home/devreplica/Fintrust/Postgress
  /home/devreplica/Fintrust/Mongo
  /home/devreplica/Fintrust/RabbitMQ
</code></pre></section><h1 class='nav-section-title-end'>Ended: Development</h1>
                        <h3 class='nav-section-title' id='section-staging'>
                            Staging <a class='headerlink' href='#section-staging' title='Permanent link'>â†µ</a>
                        </h3>
                        <section class="print-page" id="run-environments-staging-overview"><h1 id="run-environments-staging-overview-overview">Overview<a class="headerlink" href="#run-environments-staging-overview-overview" title="Permanent link">#</a></h1>
<p>This page presents an overview of our staging environment.</p>
<h2 id="run-environments-staging-overview-infrastructure">Infrastructure<a class="headerlink" href="#run-environments-staging-overview-infrastructure" title="Permanent link">#</a></h2>
<p>Following infrastructure is available in staging environment.</p>
<h2 id="run-environments-staging-overview-services-used">Services Used<a class="headerlink" href="#run-environments-staging-overview-services-used" title="Permanent link">#</a></h2>
<ul>
<li>
<p>VPC</p>
</li>
<li>
<p>Internet GateWay</p>
</li>
<li>
<p>NAT GateWay</p>
</li>
<li>
<p>Elastic Kubernetes Service</p>
</li>
<li>
<p>Elastic Compute cloud</p>
</li>
<li>
<p>Application Load Balancer</p>
</li>
<li>
<p>Simple Storage Service</p>
</li>
<li>
<p>Cloud Watch</p>
</li>
<li>
<p>Route53</p>
</li>
<li>
<p>Secrets Manager</p>
</li>
</ul>
<h2 id="run-environments-staging-overview-architecture-diagram">Architecture Diagram<a class="headerlink" href="#run-environments-staging-overview-architecture-diagram" title="Permanent link">#</a></h2>
<p><img alt="Fintrust Staging ENvironment" src="../Run/Environments/Staging/fintrust-staging-environment.jpg" /></p>
<p>We are hosting the staging environment in Mumbai (ap-sout-1) region.</p>
<p>VPC CIDR Range : 10.0.0.0/16</p>
<p>2 Public Subnets: </p>
<pre><code>- 10.0.1.0/24  ( Hosted in ap-south-1a Availability Zone )

- 10.0.2.0/24  ( Hosted in ap-south-1b Availability Zone )
</code></pre>
<p>2 Private Subnets:</p>
<pre><code>- 10.0.3.0/24   ( Hosted in ap-south-1a Availability Zone )

- 10.0.4.0/24   ( Hosted in ap-south-1b Availability Zone )
</code></pre>
<ul>
<li>
<p>An Internet Gateway is attached to VPC to enable the internet connectivity for the infrastructure hosted in 2 public subnets</p>
</li>
<li>
<p>A NAT Gateway is placed in public subnet to enable the internet connectivity for the infrastructure hosted in private subnets</p>
</li>
<li>
<p>An EKS Cluster is provisioned with node group ( group of EC2 Servers ) to deploy the application in containerized form.</p>
</li>
<li>
<p>The Application Load balancer is in place to route the traffic to the application ( path based routing)</p>
</li>
<li>
<p>Databases (Postgres, MongoDB)  and Message Broker ( RabbitMQ) are hosted as containers on a server in a private subnet.</p>
</li>
<li>
<p>Application is hosted at domain ( https://staging-allfundscloud.in), a record is created with CNAME type in Route53</p>
</li>
<li>
<p>For storage, Simple Storage Service buckets are being used.</p>
</li>
<li>
<p>For Monitoring purpose, CloudWatch is in place.</p>
</li>
</ul></section><section class="print-page" id="run-environments-staging-secretsmanager%20implementation"><h1 id="run-environments-staging-secretsmanager%20implementation-aws-secrets-manager-implementation"><strong>AWS Secrets Manager Implementation</strong><a class="headerlink" href="#run-environments-staging-secretsmanager%20implementation-aws-secrets-manager-implementation" title="Permanent link">#</a></h1>
<h2 id="run-environments-staging-secretsmanager%20implementation-manage-kubernetes-secrets-using-aws-secrets-manager"><strong>Manage Kubernetes Secrets using AWS Secrets Manager</strong><a class="headerlink" href="#run-environments-staging-secretsmanager%20implementation-manage-kubernetes-secrets-using-aws-secrets-manager" title="Permanent link">#</a></h2>
<p>Kubernetes has a built-in feature for secrets management called a Secret. The Secret object is convenient to use, but does not support storing or retrieving secret data from external secret management systems such as AWS Secrets Manager. 
It's often beneficial to use Kubernetes with an external secrets service that handles secret management. 
Due to this limitation, GoDaddy came up with an open source solution called External Secrets Operator. </p>
<h2 id="run-environments-staging-secretsmanager%20implementation-external-secrets-operator-eso"><strong>External Secrets Operator (ESO)</strong><a class="headerlink" href="#run-environments-staging-secretsmanager%20implementation-external-secrets-operator-eso" title="Permanent link">#</a></h2>
<p>ESO provides the same ease of use as native Secret object and provides access to secrets stored externally. 
It does this by extending Kubernetes with Custom Resources, which defines where secrets live and how to synchronize them.</p>
<p>In simple terms, ESO makes API calls to retrieve secret data from the external secrets service like AWS Secrets Manager and injects the secret data as Kubernetes Secrets object.</p>
<p><img alt="Kubernetes Cluster  External Secrets Service" src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xm-EDmrqawSQaGzhCNGRUA.png" /></p>
<h3 id="run-environments-staging-secretsmanager%20implementation-key-concepts"><strong>Key Concepts</strong><a class="headerlink" href="#run-environments-staging-secretsmanager%20implementation-key-concepts" title="Permanent link">#</a></h3>
<p><strong>External Secrets Controller</strong> â€” A Kubernetes controller that fetches secrets from an external API and creates Kubernetes secrets. If the secret from the external API changes, the controller reconciles the state in the cluster and updates the secrets.</p>
<p><strong>ExternalSecret</strong> -  A custom resource definition that specifies what secret data to fetch. It references SecretStore which knows how to access that data. The controller uses the ExternalSecret as a blueprint to create secrets.</p>
<p><strong>SecretStore</strong> - A custom resource definition that specifies the access needed to fetch the secret from the external API. SecretStore takes care of authentication and access.</p>
<p>And there are two kinds of SecretStore resources:</p>
<p><strong>ClusterSecretStore</strong> - A global, cluster-wide SecretStore that can be referenced from all namespaces. You can use it to provide a central gateway to your secret provider.</p>
<p><strong>SecretStore</strong> - A namespaced SecretStore that can only be referenced from a single namespace.</p>
<h3 id="run-environments-staging-secretsmanager%20implementation-integrating-aws-secrets-manager-with-kubernetes"><strong>Integrating AWS Secrets Manager with Kubernetes</strong><a class="headerlink" href="#run-environments-staging-secretsmanager%20implementation-integrating-aws-secrets-manager-with-kubernetes" title="Permanent link">#</a></h3>
<h4 id="run-environments-staging-secretsmanager%20implementation-install-external-secrets-operator-using-helm"><strong>Install External Secrets Operator using Helm</strong><a class="headerlink" href="#run-environments-staging-secretsmanager%20implementation-install-external-secrets-operator-using-helm" title="Permanent link">#</a></h4>
<pre><code>helm repo add external-secrets https://charts.external-secrets.io
helm repo update
</code></pre>
<h4 id="run-environments-staging-secretsmanager%20implementation-install-eso-in-external-secrets-namespace"><strong>Install ESO in external-secrets namespace</strong><a class="headerlink" href="#run-environments-staging-secretsmanager%20implementation-install-eso-in-external-secrets-namespace" title="Permanent link">#</a></h4>
<pre><code>helm upgrade --namespace external-secrets --create-namespace --install --wait external-secrets external-secrets/external-secrets
</code></pre>
<h4 id="run-environments-staging-secretsmanager%20implementation-verify-eso-installation"><strong>Verify ESO installation</strong><a class="headerlink" href="#run-environments-staging-secretsmanager%20implementation-verify-eso-installation" title="Permanent link">#</a></h4>
<pre><code>kubectl -n external-secrets get all
</code></pre>
<h4 id="run-environments-staging-secretsmanager%20implementation-create-an-iam-user-and-attach-the-managed-policy"><strong>Create an IAM user and attach the managed policy</strong><a class="headerlink" href="#run-environments-staging-secretsmanager%20implementation-create-an-iam-user-and-attach-the-managed-policy" title="Permanent link">#</a></h4>
<p>Now, that we have ESO successfully deployed in the cluster. Letâ€™s create a dedicated AWS IAM user, which will be used to authenticate to AWS and access the secret data from the AWS Secrets Manager.</p>
<pre><code>aws iam create-user --user-name external-secrets
</code></pre>
<p>And assign the SecretsManagerReadWrite managed policy to grant the IAM user access to the secrets manager.</p>
<p>For good security hygiene, use the principle of least privilege on production, limiting the permissions for the external-secrets IAM user to only access the needed secrets path and KMS key.</p>
<pre><code>aws iam attach-user-policy --user-name external-secrets --policy-arn arn:aws:iam::aws:policy/SecretsManagerReadWrite
</code></pre>
<p>Now, generate the AWS access and secret key.</p>
<pre><code>aws iam create-access-key --user-name external-secrets
</code></pre>
<p>Place the access key and secret key onto a file and create a secret in default namespace called awssm-secret from the file.</p>
<pre><code>echo -n "REPLACE_ME_WITH_YOUR_ACCESS_KEY" &gt; access-key
echo -n "REPLACE_ME_WITH_YOUR_SECRET_KEY" &gt; secret-access-key
kubectl -n default create secret generic awssm-secret --from-file=./access-key --from-file=./secret-access-key
</code></pre>
<h4 id="run-environments-staging-secretsmanager%20implementation-create-app-secret-in-aws-secret-manager"><strong>Create app secret in AWS Secret Manager</strong><a class="headerlink" href="#run-environments-staging-secretsmanager%20implementation-create-app-secret-in-aws-secret-manager" title="Permanent link">#</a></h4>
<p>Go ahead and create a demo app secret in ap-south-1 region of the AWS Secrets Manager via AWS CLI or Cosnole, which will be fetched later by External Secrets and exposed to the application Pod via environment variable</p>
<p>And verify the secret from the AWS Secrets Manager console.</p>
<h4 id="run-environments-staging-secretsmanager%20implementation-create-a-cluster-scoped-secret-store"><strong>Create a cluster-scoped secret store</strong><a class="headerlink" href="#run-environments-staging-secretsmanager%20implementation-create-a-cluster-scoped-secret-store" title="Permanent link">#</a></h4>
<p>As mentioned before, a cluster-scoped secret store allows referencing the secret store from any namespaces, which is convenient to use as a central gateway to the secret provider, rather than creating a secret store per namespace.</p>
<p>Refer the manifest file in bastion server at the path /home/ec2-user/externalsecretsperator/cluster-secret-store.yaml</p>
<p>And apply the manifest</p>
<pre><code>kubectl apply -f cluster-secret-store.yaml
</code></pre>
<p>And, verify the cluster secret store is created successfully and shows the message â€œstore validatedâ€.</p>
<pre><code>kubectl describe clustersecretstore global-secret-store
</code></pre>
<h4 id="run-environments-staging-secretsmanager%20implementation-create-externalsecret-to-fetch-the-secret-data"><strong>Create ExternalSecret to fetch the secret data</strong><a class="headerlink" href="#run-environments-staging-secretsmanager%20implementation-create-externalsecret-to-fetch-the-secret-data" title="Permanent link">#</a></h4>
<p>Weâ€™re now ready to create the ExternalSecret resource and fetch the app-secret demo secret data from AWS Secrets Manager by referencing the cluster-scoped secret store.</p>
<p>And save the following YAML as allfunds-secret.yaml where ExternalSecret object specification is structured as such:</p>
<pre><code>* spec.refreshInterval - is set to 1 minute, meaning reconciliation will take place every minute.
* spec.secretStoreRefis - set to ClusterSecretStore named global-secret-store which we created before.
* spec.target.name - specifies the name of the secret object that will be created in the same namespace, where ExternalSecret is created.
* spec.dataFrom - specifies the secret name in the AWS Secrets Manager as key and extracttells it to retrieve all key/value secrets.
</code></pre>
<p>Refer the manifest file in bastion server at the path /home/ec2-user/externalsecretsperator/allfunds-secret.yaml</p>
<p>Finally, go ahead and apply the manifest:</p>
<pre><code>kubectl -n allfunds apply -f allfunds-secret.yaml
</code></pre>
<p>If everything went as planned, we should get SecretSynced status for ExternalSecret resource and a new Kubernetes Secret resource called app-secret should be created.</p>
<pre><code>kubectl -n allfunds get externalsecret
kubectl -n allfunds get secret allfunds-secret
</code></pre>
<h4 id="run-environments-staging-secretsmanager%20implementation-what-just-happened"><strong>What just happened?</strong><a class="headerlink" href="#run-environments-staging-secretsmanager%20implementation-what-just-happened" title="Permanent link">#</a></h4>
<pre><code>* ExternalSecret was able to authenticate to AWS Secrets Manager using the cluster-scoped secret store.
* ExternalSecret was able to fetch the secret data and create the Kubernetes Secret object.
</code></pre>
<h4 id="run-environments-staging-secretsmanager%20implementation-consume-the-secret-from-pod"><strong>Consume the Secret from Pod</strong><a class="headerlink" href="#run-environments-staging-secretsmanager%20implementation-consume-the-secret-from-pod" title="Permanent link">#</a></h4>
<p>Now, that the ExternalSecret was able to retrieve the secrets from AWS Secrets Manager and on-the-fly create the Kubernetes Secret for us. 
We can reference this secret allfunds-secret as usual from the Pod, without any application modification.
Letâ€™s go ahead and apply the following Pod manifest and see if our container has the secret data in its environment variable.</p>
<p>Refer the manifest file in bastion server at the path /home/ec2-user/externalsecretsperator/deployment.yaml</p>
<p>And apply the manifest:</p>
<pre><code>kubectl -n allfunds apply -f deployment.yaml
</code></pre>
<p>Once, applied. The Pod will create a single container and runs env command and exits. 
We can check the Pod log to verify that our secret data was indeed available as an environment variable.</p>
<h3 id="run-environments-staging-secretsmanager%20implementation-conclusion"><strong>Conclusion</strong><a class="headerlink" href="#run-environments-staging-secretsmanager%20implementation-conclusion" title="Permanent link">#</a></h3>
<p>External Secrets Operator is a mature and popular open source project with great community engagement. 
It is well-tested and stable for production workloads with high-availability features for managing and synchronizing large-scale secrets and supports many popular external secrets providers like HashiCorp Vault, Google Secrets Manager, Azure Key Vault, and many more.
Since External Secrets provides the same ease of use as Kubernetes native Secret objects, it doesnâ€™t require any application modifications, and existing application leveraging Secret object works out of the box without any changes.</p>
<p>For more information, please visit <a href="https://www.giantswarm.io/blog/manage-kubernetes-secrets-using-aws-secrets-manager">Kubernetes Secrets using AWS Secrets Manager</a></p></section><section class="print-page" id="run-environments-staging-secretsmanager"><h1 id="run-environments-staging-secretsmanager-aws-secrets-manager"><strong>AWS Secrets Manager</strong><a class="headerlink" href="#run-environments-staging-secretsmanager-aws-secrets-manager" title="Permanent link">#</a></h1>
<h3 id="run-environments-staging-secretsmanager-below-are-the-securely-available-secret-keys-in-staging-environment-and-the-respective-keys-used-in-k8s-secret-manifest"><strong>Below are the securely available secret keys in staging environment and the respective keys used in k8s secret manifest</strong><a class="headerlink" href="#run-environments-staging-secretsmanager-below-are-the-securely-available-secret-keys-in-staging-environment-and-the-respective-keys-used-in-k8s-secret-manifest" title="Permanent link">#</a></h3>
<table>
<thead>
<tr>
<th>Secret Config Key</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>POSTGRES_USER</td>
<td>postgres username</td>
</tr>
<tr>
<td>POSTGRES_PASSWORD</td>
<td>postgres password</td>
</tr>
<tr>
<td>MONGO_URL</td>
<td>mongo url</td>
</tr>
<tr>
<td>MONGO_USER</td>
<td>mongo username</td>
</tr>
<tr>
<td>MONGO_PASSWORD</td>
<td>mongo password</td>
</tr>
<tr>
<td>RABBIT_USER</td>
<td>rabbitmq username</td>
</tr>
<tr>
<td>RABBIT_PASSWORD</td>
<td>rabbitmq password</td>
</tr>
<tr>
<td>MFU_USER_ID</td>
<td>mfu userid</td>
</tr>
<tr>
<td>MFU_PASSWORD</td>
<td>mfu password</td>
</tr>
<tr>
<td>MFU_SECRET_KEY</td>
<td>mfu secretkey</td>
</tr>
<tr>
<td>MFU_ENTITY_ID</td>
<td>mfu entityid</td>
</tr>
<tr>
<td>CAMS_PUBLIC_KEY/CAMS_PRIVATE_KEY</td>
<td>CAMS keys</td>
</tr>
</tbody>
</table>
<h3 id="run-environments-staging-secretsmanager-sample-kubernetes-secrets-creation-using-manifest"><strong>Sample kubernetes secrets creation using manifest</strong><a class="headerlink" href="#run-environments-staging-secretsmanager-sample-kubernetes-secrets-creation-using-manifest" title="Permanent link">#</a></h3>
<p>apiVersion: v1<br />
kind: Secret<br />
metadata:<br />
    name: sample-secret<br />
    namespace: sample<br />
type: Opaque<br />
data:<br />
   #Base64-encoded values<br />
    POSTGRES_USER: <strong><em>*</em></strong><em><br />
    POSTGRES_PASSWORD: </em><strong>*</strong>*  </p></section><section class="print-page" id="run-environments-staging-setup"><h1 id="run-environments-staging-setup-setup">Setup<a class="headerlink" href="#run-environments-staging-setup-setup" title="Permanent link">#</a></h1>
<p>Infrastructure in staging environment is provisioned using OpenTofu scripts</p>
<h2 id="run-environments-staging-setup-opentofu">OpenTofu<a class="headerlink" href="#run-environments-staging-setup-opentofu" title="Permanent link">#</a></h2>
<p>Installing tooling</p>
<p><div class="highlight"><pre><span></span><code>sudo apt-get update

sudo apt-get install -y apt-transport-https ca-certificates curl gnupg
</code></pre></div>
Set up the OpenTofu repository</p>
<p>Firstly, we need to make sure that we have a copy of the OpenTofu GPG key. This verifies that our packages have indeed been created using the official pipeline and have not been tampered with.</p>
<div class="highlight"><pre><span></span><code>sudo install -m 0755 -d /etc/apt/keyrings

curl -fsSL https://get.opentofu.org/opentofu.gpg | sudo tee /etc/apt/keyrings/opentofu.gpg &gt;/dev/null

curl -fsSL https://packages.opentofu.org/opentofu/tofu/gpgkey | sudo gpg --no-tty --batch --dearmor -o /etc/apt/keyrings/opentofu-repo.gpg &gt;/dev/null

sudo chmod a+r /etc/apt/keyrings/opentofu.gpg /etc/apt/keyrings/opentofu-repo.gpg
</code></pre></div>
<p>Now create the OpenTofu source list</p>
<div class="highlight"><pre><span></span><code>echo \
  &quot;deb [signed-by=/etc/apt/keyrings/opentofu.gpg,/etc/apt/keyrings/opentofu-repo.gpg] https://packages.opentofu.org/opentofu/tofu/any/ any main
deb-src [signed-by=/etc/apt/keyrings/opentofu.gpg,/etc/apt/keyrings/opentofu-repo.gpg] https://packages.opentofu.org/opentofu/tofu/any/ any main&quot; | \  sudo tee /etc/apt/sources.list.d/opentofu.list &gt; /dev/null

sudo chmod a+r /etc/apt/sources.list.d/opentofu.list
</code></pre></div>
<p>Installing OpenTofu
<div class="highlight"><pre><span></span><code>sudo apt-get update

sudo apt-get install -y tofu
</code></pre></div></p>
<h2 id="run-environments-staging-setup-infrastructure-provisioning-using-opentofu">Infrastructure Provisioning using OpenTofu<a class="headerlink" href="#run-environments-staging-setup-infrastructure-provisioning-using-opentofu" title="Permanent link">#</a></h2>
<p>We have a repository called "iac-aws-tofu" to store the tofu scripts.</p>
<p>Prerequisites:</p>
<ul>
<li>Make sure to install the OpenTofu before running the scripts.</li>
</ul>
<p>Below are the instructions to run the infra provisioning scripts</p>
<div class="highlight"><pre><span></span><code>tofu workspace select &lt;workspace-name&gt;   ( workspace refers to an environment, which might be dev/staging/prod )

tofu plan

tofu apply --auto-approve
</code></pre></div>
<h2 id="run-environments-staging-setup-infrastructure-setup-by-opentofu">Infrastructure Setup by OpenTofu<a class="headerlink" href="#run-environments-staging-setup-infrastructure-setup-by-opentofu" title="Permanent link">#</a></h2>
<p>Below are the AWS services setup by Opentofu after running the scripts</p>
<table>
<thead>
<tr>
<th>Script</th>
<th>Service</th>
<th>Configuration</th>
</tr>
</thead>
<tbody>
<tr>
<td>VPC</td>
<td>VPC</td>
<td>10.0.0.0/16</td>
</tr>
<tr>
<td></td>
<td>2 Public Subnets</td>
<td>10.0.1.0/24</td>
</tr>
<tr>
<td></td>
<td></td>
<td>10.0.2.0/24</td>
</tr>
<tr>
<td></td>
<td>2 Private Subnets</td>
<td>10.0.3.0/24</td>
</tr>
<tr>
<td></td>
<td></td>
<td>10.0.4.0/24</td>
</tr>
<tr>
<td></td>
<td>Internet GateWay</td>
<td></td>
</tr>
<tr>
<td></td>
<td>NAT GateWay</td>
<td></td>
</tr>
<tr>
<td></td>
<td>Public Route Table</td>
<td></td>
</tr>
<tr>
<td></td>
<td>Private Route Table</td>
<td></td>
</tr>
<tr>
<td>eks_cluster</td>
<td>Elastic Kubernetes Service</td>
<td>Version 1.28</td>
</tr>
<tr>
<td></td>
<td>Launch template for Node Group</td>
<td></td>
</tr>
<tr>
<td></td>
<td>Nodegroup (EC2)</td>
<td>Instance family - t3a.medium</td>
</tr>
<tr>
<td></td>
<td>EBS Volumes for nodes</td>
<td>Volume type     - gp2</td>
</tr>
<tr>
<td></td>
<td>Cluster Autoscaler</td>
<td></td>
</tr>
<tr>
<td></td>
<td>Application load balancer controller</td>
<td></td>
</tr>
<tr>
<td>Bation</td>
<td>Bastion server to operate the EKS</td>
<td>Instance family - t2.micro</td>
</tr>
<tr>
<td></td>
<td>Elastic IP for Bastion Server</td>
<td></td>
</tr>
<tr>
<td></td>
<td>Default EBS volume</td>
<td>Volume type     - gp2</td>
</tr>
<tr>
<td>PtInstance</td>
<td>Performance testing Server</td>
<td>Instance family - m5a.xlarge</td>
</tr>
<tr>
<td></td>
<td>Elastic IP for the same server</td>
<td></td>
</tr>
<tr>
<td>BuildInstance</td>
<td>Build Server</td>
<td>Instance family - t3a.large</td>
</tr>
<tr>
<td></td>
<td>Elastic IP for the same server</td>
<td></td>
</tr>
<tr>
<td></td>
<td>Default EBS Volume</td>
<td>Volime type     - gp2</td>
</tr>
<tr>
<td>DBInstance</td>
<td>Server to setup Databases, Message Broker</td>
<td>Instance family - m5a.large</td>
</tr>
<tr>
<td></td>
<td>EBS Volume</td>
<td>Volume type     - gp3</td>
</tr>
<tr>
<td>rds</td>
<td>Postgres Database</td>
<td>Version         - 14.11</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Instance Class  - db.t4g.micro</td>
</tr>
</tbody>
</table></section><h1 class='nav-section-title-end'>Ended: Staging</h1><h1 class='nav-section-title-end'>Ended: Environments</h1><h1 class='nav-section-title-end'>Ended: Run</h1>
                        <h1 class='nav-section-title' id='section-playground'>
                            Playground <a class='headerlink' href='#section-playground' title='Permanent link'>â†µ</a>
                        </h1>
                        <section class="print-page" id="playground-staging%20database"><h1 id="playground-staging%20database-metabase"><strong>Metabase</strong><a class="headerlink" href="#playground-staging%20database-metabase" title="Permanent link">#</a></h1>
<h3 id="playground-staging%20database-metabase-access"><strong>Metabase Access</strong><a class="headerlink" href="#playground-staging%20database-metabase-access" title="Permanent link">#</a></h3>
<ol>
<li>
<p>Below is the access URL of metabase</p>
</li>
<li>
<p>URL: https://analytics.allfundscloud.in</p>
</li>
<li>
<p>Please use the credentials that are shared to login to metabase</p>
</li>
</ol>
<p>Note: We already added the datastore in metabase.And Data is available in "public" schema</p>
<h3 id="playground-staging%20database-staging-db-connectivity"><strong>Staging DB connectivity</strong><a class="headerlink" href="#playground-staging%20database-staging-db-connectivity" title="Permanent link">#</a></h3>
<h3 id="playground-staging%20database-steps-to-access-the-staging-db"><strong>Steps to access the Staging DB</strong><a class="headerlink" href="#playground-staging%20database-steps-to-access-the-staging-db" title="Permanent link">#</a></h3>
<ol>
<li>
<p>Please keep the security keys handy that have shared</p>
</li>
<li>
<p>Use the below tunneling command</p>
</li>
<li>
<p>ssh -nNT -i namra-extern  devuser@13.235.199.118 -L 5432:10.0.3.234:5432</p>
</li>
<li>
<p>Install the DBeaver</p>
</li>
<li>
<p>Add the new connection and enter the below details</p>
</li>
<li>
<p>host: localhost </p>
</li>
<li>
<p>port: 5432</p>
</li>
<li>
<p>Enter the DB credentials ( Username and Password ) which are shared and test the connection.</p>
</li>
</ol></section><section class="print-page" id="playground-howto-diagrams"><h1 id="playground-howto-diagrams-playground-to-try-out-various-diagrams">Playground to try out various diagrams<a class="headerlink" href="#playground-howto-diagrams-playground-to-try-out-various-diagrams" title="Permanent link">#</a></h1>
<h2 id="playground-howto-diagrams-state-machine">State Machine<a class="headerlink" href="#playground-howto-diagrams-state-machine" title="Permanent link">#</a></h2>
<p><img alt="Kroki" src="https://kroki.io/plantuml/png/eNpzKC5JLCopzc3hitaKVdDVtVNwLkpNLMnMS-eCMRRggqkpXFAaJBQM0ggUgtIQofyCAmRVQDGgsQglcD5YHZzvkJqXAnICALF4LIo=?">
<div class="highlight"><pre><span></span><code>@startuml
[*] --&gt; Creating
Creating -&gt; Created
Created -&gt; Started
Started -&gt; Stopped
Created --&gt; [*]
Started --&gt; [*]
Stopped --&gt; [*]
@enduml
</code></pre></div></p>
<h2 id="playground-howto-diagrams-pie-chart">Pie Chart<a class="headerlink" href="#playground-howto-diagrams-pie-chart" title="Permanent link">#</a></h2>
<p><div class="highlight"><pre><span></span><code>pie title Pets adopted by volunteers
    &quot;Dogs&quot; : 386
    &quot;Cats&quot; : 85
    &quot;Rats&quot; : 15
</code></pre></div>
<div class="highlight"><pre><span></span><code>pie title Pets adopted by volunteers
    &quot;Dogs&quot; : 386
    &quot;Cats&quot; : 85
    &quot;Rats&quot; : 15
</code></pre></div></p>
<h2 id="playground-howto-diagrams-mindmap">Mindmap<a class="headerlink" href="#playground-howto-diagrams-mindmap" title="Permanent link">#</a></h2>
<p><div class="highlight"><pre><span></span><code>mindmap
  root((mindmap))
    Origins
      Long history
      ::icon(fa fa-book)
      Popularisation
        British popular psychology author Tony Buzan
    Research
      On effectiveness&lt;br/&gt;and features
      On Automatic creation
        Uses
            Creative techniques
            Strategic planning
            Argument mapping
    Tools
      Pen and paper
      Mermaid
</code></pre></div>
<div class="highlight"><pre><span></span><code>mindmap
  root((mindmap))
    Origins
      Long history
      ::icon(fa fa-book)
      Popularisation
        British popular psychology author Tony Buzan
    Research
      On effectiveness&lt;br/&gt;and features
      On Automatic creation
        Uses
            Creative techniques
            Strategic planning
            Argument mapping
    Tools
      Pen and paper
      Mermaid
</code></pre></div></p>
<h1 id="playground-howto-diagrams-sequence-diagram">Sequence Diagram<a class="headerlink" href="#playground-howto-diagrams-sequence-diagram" title="Permanent link">#</a></h1>
<div class="highlight"><pre><span></span><code>@startuml
autonumber
skin rose
skinparam svgDimensionStyle false

title &quot;Portfolio - Payment Flow&quot;

/&#39;
This highlights the flow of a payment flow.
&#39;/

actor User as user
boundary App as app
boundary WebView as webview
control &quot;Portfolio Service&quot; as pfo
boundary &quot;MFU Service&quot; as mfu
control &quot;PaymentStatusCallback&quot; as psb
control &quot;Android DeepLinker&quot; as deeplink

== purchase initialization ==

user -&gt; app : Click on purchase
app -&gt; pfo : Purchase request sent
pfo -&gt; mfu : Purchase request forwarded
mfu -&gt; pfo : purchase response with payment link returned
pfo -&gt; app : return payment link

== User proceeds with payment ==

app -&gt; webview : Launch and navigate to Payment Link
webview -&gt; webview : user finishes payment steps using rendered payment pages
webview -&gt; mfu : submits payment
mfu -&gt; webview : responds with 302 Redirect to preconfigured Payment Callback URL ( https://fintrust-dev.techwave.net/api/execution/mfu/payment-callback )

== App handled payment status ==

webview -&gt; psb : redirect
psb -&gt; webview : responds with 302 Redirect to preconfigured App Supported Callback URL (app://allfunds?...)
webview -&gt; deeplink : Handle redirect
deeplink -&gt; app : Transfers control to app with context
app -&gt; user : displays payment status and next steps.

@enduml
</code></pre></div>
<h1 id="playground-howto-diagrams-block-diagram">Block Diagram<a class="headerlink" href="#playground-howto-diagrams-block-diagram" title="Permanent link">#</a></h1>
<p><img alt="Kroki" src="https://kroki.io/blockdiag/png/eNp1zkEKwkAMBdB9TxFn3xMUvYi4SGs6DI1JyVRlEO9eoiJjweXnPz6_Zx2mc8IIjwag_6b2AJGEDBfKHsKrar0zvOTQbXV6sxtZAcJcdn8JclYYrwKLqqsfdhyU1WAPIRqRFGLWezj51vZCZeck0wdVByqghhLJybNZAdCvTGE=?no-transparency=false"></p>
<div class="highlight"><pre><span></span><code>xkroki-blockdiag no-transparency=false
blockdiag {
  blockdiag -&gt; generates -&gt; &quot;block-diagrams&quot;;
  blockdiag -&gt; is -&gt; &quot;very easy!&quot;;
  blockdiag -&gt; is -&gt; &quot;also fun too!&quot;;

  blockdiag [color = &quot;greenyellow&quot;];
  &quot;block-diagrams&quot; [color = &quot;pink&quot;];
  &quot;very easy!&quot; [color = &quot;orange&quot;];
}
</code></pre></div></section><h1 class='nav-section-title-end'>Ended: Playground</h1></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "/wiki/", "features": [], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
        <script src="../js/print-site.js"></script>
      
    
  </body>
</html>